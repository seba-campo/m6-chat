function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var e,n,r,i,o,s,a,u,c,h,l,f,d,p,v,g,m,y,_,b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function w(t){return Array.isArray(t=t||[])?t:[t]}function I(t){return`[Vaadin.Router] ${t}`}const T="module",E="nomodule",S=[T,E];function C(t){if(!t.match(/.+\.[m]?js$/))throw Error(I(`Unsupported type for bundle "${t}": .js or .mjs expected.`))}function k(t){if(!t||!D(t.path))throw Error(I('Expected route config to be an object with a "path" string property, or an array of such objects'));let e=t.bundle,n=["component","redirect","bundle"];if(!P(t.action)&&!Array.isArray(t.children)&&!P(t.children)&&!x(e)&&!n.some(e=>D(t[e])))throw Error(I(`Expected route config "${t.path}" to include either "${n.join('", "')}" or "action" function but none found.`));if(e){if(D(e))C(e);else if(S.some(t=>t in e))S.forEach(t=>t in e&&C(e[t]));else throw Error(I('Expected route bundle to include either "'+E+'" or "'+T+'" keys, or both'))}t.redirect&&["bundle","component"].forEach(e=>{e in t&&console.warn(I(`Route config "${t.path}" has both "redirect" and "${e}" properties, and "redirect" will always override the latter. Did you mean to only use "${e}"?`))})}function N(t){w(t).forEach(t=>k(t))}function A(t,e){let n=document.head.querySelector('script[src="'+t+'"][async]');return n||((n=document.createElement("script")).setAttribute("src",t),e===T?n.setAttribute("type",T):e===E&&n.setAttribute(E,""),n.async=!0),new Promise((t,e)=>{n.onreadystatechange=n.onload=e=>{n.__dynamicImportLoaded=!0,t(e)},n.onerror=t=>{n.parentNode&&n.parentNode.removeChild(n),e(t)},null===n.parentNode?document.head.appendChild(n):n.__dynamicImportLoaded&&t()})}function R(t,e){return!window.dispatchEvent(new CustomEvent(`vaadin-router-${t}`,{cancelable:"go"===t,detail:e}))}function x(t){return"object"==typeof t&&!!t}function P(t){return"function"==typeof t}function D(t){return"string"==typeof t}function O(t){let e=Error(I(`Page not found (${t.pathname})`));return e.context=t,e.code=404,e}const L=new class{};function M(t){if(t.defaultPrevented||0!==t.button||t.shiftKey||t.ctrlKey||t.altKey||t.metaKey)return;let e=t.target,n=t.composedPath?t.composedPath():t.path||[];for(let t=0;t<n.length;t++){let r=n[t];if(r.nodeName&&"a"===r.nodeName.toLowerCase()){e=r;break}}for(;e&&"a"!==e.nodeName.toLowerCase();)e=e.parentNode;if(!e||"a"!==e.nodeName.toLowerCase()||e.target&&"_self"!==e.target.toLowerCase()||e.hasAttribute("download")||e.hasAttribute("router-ignore")||e.pathname===window.location.pathname&&""!==e.hash)return;let r=e.origin||function(t){let e=t.port,n=t.protocol,r="http:"===n&&"80"===e||"https:"===n&&"443"===e?t.hostname:t.host;return`${n}//${r}`}(e);if(r!==window.location.origin)return;let{pathname:i,search:o,hash:s}=e;R("go",{pathname:i,search:o,hash:s})&&(t.preventDefault(),t&&"click"===t.type&&window.scrollTo(0,0))}const F=/Trident/.test(navigator.userAgent);function U(t){if("vaadin-router-ignore"===t.state)return;let{pathname:e,search:n,hash:r}=window.location;R("go",{pathname:e,search:n,hash:r})}F&&!P(window.PopStateEvent)&&(window.PopStateEvent=function(t,e){e=e||{};var n=document.createEvent("Event");return n.initEvent(t,!!e.bubbles,!!e.cancelable),n.state=e.state||null,n},window.PopStateEvent.prototype=window.Event.prototype);var j=function t(e,n,r){return e instanceof RegExp?function(t,e){if(!e)return t;var n=t.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return t}(e,n):Array.isArray(e)?function(e,n,r){for(var i=[],o=0;o<e.length;o++)i.push(t(e[o],n,r).source);return RegExp("(?:"+i.join("|")+")",W(r))}(e,n,r):H(V(e,r),n,r)},q=RegExp("(\\\\.)|(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?","g");function V(t,e){for(var n,r=[],i=0,o=0,s="",a=e&&e.delimiter||"/",u=e&&e.delimiters||"./",c=!1;null!==(n=q.exec(t));){var h=n[0],l=n[1],f=n.index;if(s+=t.slice(o,f),o=f+h.length,l){s+=l[1],c=!0;continue}var d="",p=t[o],v=n[2],g=n[3],m=n[4],y=n[5];if(!c&&s.length){var _=s.length-1;u.indexOf(s[_])>-1&&(d=s[_],s=s.slice(0,_))}s&&(r.push(s),s="",c=!1);var b=""!==d&&void 0!==p&&p!==d,w="+"===y||"*"===y,I="?"===y||"*"===y,T=d||a,E=g||m;r.push({name:v||i++,prefix:d,delimiter:T,optional:I,repeat:w,partial:b,pattern:E?E.replace(/([=!:$/()])/g,"\\$1"):"[^"+K(T)+"]+?"})}return(s||o<t.length)&&r.push(s+t.substr(o)),r}function B(t){for(var e=Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=RegExp("^(?:"+t[n].pattern+")$"));return function(n,r){for(var i="",o=r&&r.encode||encodeURIComponent,s=0;s<t.length;s++){var a,u=t[s];if("string"==typeof u){i+=u;continue}var c=n?n[u.name]:void 0;if(Array.isArray(c)){if(!u.repeat)throw TypeError('Expected "'+u.name+'" to not repeat, but got array');if(0===c.length){if(u.optional)continue;throw TypeError('Expected "'+u.name+'" to not be empty')}for(var h=0;h<c.length;h++){if(a=o(c[h],u),!e[s].test(a))throw TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'"');i+=(0===h?u.prefix:u.delimiter)+a}continue}if("string"==typeof c||"number"==typeof c||"boolean"==typeof c){if(a=o(String(c),u),!e[s].test(a))throw TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but got "'+a+'"');i+=u.prefix+a;continue}if(u.optional){u.partial&&(i+=u.prefix);continue}throw TypeError('Expected "'+u.name+'" to be '+(u.repeat?"an array":"a string"))}return i}}function K(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function W(t){return t&&t.sensitive?"":"i"}function H(t,e,n){for(var r=(n=n||{}).strict,i=!1!==n.start,o=!1!==n.end,s=K(n.delimiter||"/"),a=n.delimiters||"./",u=[].concat(n.endsWith||[]).map(K).concat("$").join("|"),c=i?"^":"",h=0===t.length,l=0;l<t.length;l++){var f=t[l];if("string"==typeof f)c+=K(f),h=l===t.length-1&&a.indexOf(f[f.length-1])>-1;else{var d=f.repeat?"(?:"+f.pattern+")(?:"+K(f.delimiter)+"(?:"+f.pattern+"))*":f.pattern;e&&e.push(f),f.optional?f.partial?c+=K(f.prefix)+"("+d+")?":c+="(?:"+K(f.prefix)+"("+d+"))?":c+=K(f.prefix)+"("+d+")"}}return o?(r||(c+="(?:"+s+")?"),c+="$"===u?"$":"(?="+u+")"):(r||(c+="(?:"+s+"(?="+u+"))?"),h||(c+="(?="+s+"|"+u+")")),new RegExp(c,W(n))}j.parse=V,j.compile=function(t,e){return B(V(t,e))},j.tokensToFunction=B,j.tokensToRegExp=H;const{hasOwnProperty:z}=Object.prototype,G=new Map;function Q(t){try{return decodeURIComponent(t)}catch(e){return t}}function Y(t){if(P(t.route.action))return t.route.action(t)}G.set("|false",{keys:[],pattern:/(?:)/});class ${constructor(t,e={}){if(Object(t)!==t)throw TypeError("Invalid routes");this.baseUrl=e.baseUrl||"",this.errorHandler=e.errorHandler,this.resolveRoute=e.resolveRoute||Y,this.context=Object.assign({resolver:this},e.context),this.root=Array.isArray(t)?{path:"",__children:t,parent:null,__synthetic:!0}:t,this.root.parent=null}getRoutes(){return[...this.root.__children]}setRoutes(t){N(t);let e=[...w(t)];this.root.__children=e}addRoutes(t){return N(t),this.root.__children.push(...w(t)),this.getRoutes()}removeRoutes(){this.setRoutes([])}resolve(t){let e=Object.assign({},this.context,D(t)?{pathname:t}:t),n=function t(e,n,r,i,o){let s,a;let u=0,c=e.path||"";return"/"===c.charAt(0)&&(r&&(c=c.substr(1)),r=!0),{next(h){if(e===h)return{done:!0};let l=e.__children=e.__children||e.children;if(!s&&(s=function(t,e,n,r,i){n=!!n;let o=`${t}|${n}`,s=G.get(o);if(!s){let e=[];s={keys:e,pattern:j(t,e,{end:n,strict:""===t})},G.set(o,s)}let a=s.pattern.exec(e);if(!a)return null;let u=Object.assign({},i);for(let t=1;t<a.length;t++){let e=s.keys[t-1],n=e.name,r=a[t];void 0===r&&z.call(u,n)||(e.repeat?u[n]=r?r.split(e.delimiter).map(Q):[]:u[n]=r?Q(r):r)}return{path:a[0],keys:(r||[]).concat(s.keys),params:u}}(c,n,!l,i,o)))return{done:!1,value:{route:e,keys:s.keys,params:s.params,path:s.path}};if(s&&l)for(;u<l.length;){if(!a){let i=l[u];i.parent=e;let o=s.path.length;o>0&&"/"===n.charAt(o)&&(o+=1),a=t(i,n.substr(o),r,s.keys,s.params)}let i=a.next(h);if(!i.done)return{done:!1,value:i.value};a=null,u++}return{done:!0}}}}(this.root,this.__normalizePathname(e.pathname),this.baseUrl),r=this.resolveRoute,i=null,o=null,s=e;function a(t,u=i.value.route,c){let h=null===c&&i.value.route;return(i=o||n.next(h),o=null,!t&&(i.done||!function(t,e){let n=e;for(;n;)if((n=n.parent)===t)return!0;return!1}(u,i.value.route)))?(o=i,Promise.resolve(L)):i.done?Promise.reject(O(e)):(!function(t,e){let{route:n,path:r}=e;if(n&&!n.__synthetic){if(t.chain){if(n.parent){let e=t.chain.length;for(;e--&&t.chain[e].route&&t.chain[e].route!==n.parent;)t.chain.pop()}}else t.chain=[];t.chain.push({path:r,route:n})}}(s=Object.assign(s?{chain:s.chain?s.chain.slice(0):[]}:{},e,i.value),i.value),Promise.resolve(r(s)).then(e=>null!=e&&e!==L?(s.result=e.result||e,s):a(t,u,e)))}return e.next=a,Promise.resolve().then(()=>a(!0,this.root)).catch(t=>{let e=function(t){let e=`Path '${t.pathname}' is not properly resolved due to an error.`,n=(t.route||{}).path;return n&&(e+=` Resolution had failed on route: '${n}'`),e}(s);if(t?console.warn(e):t=Error(e),t.context=t.context||s,t instanceof DOMException||(t.code=t.code||500),this.errorHandler)return s.result=this.errorHandler(t),s;throw t})}static __createUrl(t,e){return new URL(t,e)}get __effectiveBaseUrl(){return this.baseUrl?this.constructor.__createUrl(this.baseUrl,document.baseURI||document.URL).href.replace(/[^\/]*$/,""):""}__normalizePathname(t){if(!this.baseUrl)return t;let e=this.__effectiveBaseUrl,n=this.constructor.__createUrl(t,e).href;if(n.slice(0,e.length)===e)return n.slice(e.length)}}$.pathToRegexp=j;const{pathToRegexp:X}=$,J=new Map;function Z(t,e){let n=t.get(e);if(n&&n.length>1)throw Error(`Duplicate route with name "${e}". Try seting unique 'name' route properties.`);return n&&n[0]}function tt(t){let e=t.path;return void 0!==(e=Array.isArray(e)?e[0]:e)?e:""}let te=[];const tn=t=>{let e=getComputedStyle(t).getPropertyValue("animation-name");return e&&"none"!==e},tr=(t,e)=>{let n=()=>{t.removeEventListener("animationend",n),e()};t.addEventListener("animationend",n)};function ti(t,e){return t.classList.add(e),new Promise(n=>{if(tn(t)){let r=t.getBoundingClientRect(),i=`height: ${r.bottom-r.top}px; width: ${r.right-r.left}px`;t.setAttribute("style",`position: absolute; ${i}`),tr(t,()=>{t.classList.remove(e),t.removeAttribute("style"),n()})}else t.classList.remove(e),n()})}function to({pathname:t="",search:e="",hash:n="",chain:r=[],params:i={},redirectFrom:o,resolver:s},a){let u=r.map(t=>t.route);return{baseUrl:s&&s.baseUrl||"",pathname:t,search:e,hash:n,routes:u,route:a||u.length&&u[u.length-1]||null,params:i,redirectFrom:o,getUrl:(t={})=>th(tf.pathToRegexp.compile(tl(u))(Object.assign({},i,t)),s)}}function ts(t,e){let n=Object.assign({},t.params);return{redirect:{pathname:e,from:t.pathname,params:n}}}function ta(t,e,n){if(P(t))return t.apply(n,e)}function tu(t,e,n){return r=>r&&(r.cancel||r.redirect)?r:n?ta(n[t],e,n):void 0}function tc(t){if(t&&t.length){let e=t[0].parentNode;for(let n=0;n<t.length;n++)e.removeChild(t[n])}}function th(t,e){let n=e.__effectiveBaseUrl;return n?e.constructor.__createUrl(t.replace(/^\//,""),n).pathname:t}function tl(t){return t.map(t=>t.path).reduce((t,e)=>e.length?t.replace(/\/$/,"")+"/"+e.replace(/^\//,""):t,"")}class tf extends ${constructor(t,e){let n=document.head.querySelector("base"),r=n&&n.getAttribute("href");super([],Object.assign({baseUrl:r&&$.__createUrl(r,document.URL).pathname.replace(/[^\/]*$/,"")},e)),this.resolveRoute=t=>this.__resolveRoute(t);let i=tf.NavigationTrigger;tf.setTriggers.apply(tf,Object.keys(i).map(t=>i[t])),this.baseUrl,this.ready,this.ready=Promise.resolve(t),this.location,this.location=to({resolver:this}),this.__lastStartedRenderId=0,this.__navigationEventHandler=this.__onNavigationEvent.bind(this),this.setOutlet(t),this.subscribe(),this.__createdByRouter=new WeakMap,this.__addedByRouter=new WeakMap}__resolveRoute(t){let e=t.route,n=Promise.resolve();P(e.children)&&(n=n.then(()=>e.children(function(t){let e=Object.assign({},t);return delete e.next,e}(t))).then(t=>{null!=t||P(e.children)||(t=e.children),function(t,e){if(!Array.isArray(t)&&!x(t))throw Error(I(`Incorrect "children" value for the route ${e.path}: expected array or object, but got ${t}`));e.__children=[];let n=w(t);for(let t=0;t<n.length;t++)k(n[t]),e.__children.push(n[t])}(t,e)}));let r={redirect:e=>ts(t,e),component:t=>{let e=document.createElement(t);return this.__createdByRouter.set(e,!0),e}};return n.then(()=>{if(this.__isLatestRender(t))return ta(e.action,[t,r],e)}).then(t=>{var n;return null!=t&&(t instanceof HTMLElement||t.redirect||t===L)?t:D(e.redirect)?r.redirect(e.redirect):e.bundle?(D(n=e.bundle)?A(n):Promise.race(S.filter(t=>t in n).map(t=>A(n[t],t)))).then(()=>{},()=>{throw Error(I(`Bundle not found: ${e.bundle}. Check if the file name is correct`))}):void 0}).then(t=>null!=t?t:D(e.component)?r.component(e.component):void 0)}setOutlet(t){t&&this.__ensureOutlet(t),this.__outlet=t}getOutlet(){return this.__outlet}setRoutes(t,e=!1){return this.__previousContext=void 0,this.__urlForName=void 0,super.setRoutes(t),e||this.__onNavigationEvent(),this.ready}render(t,e){let n=++this.__lastStartedRenderId,r=Object.assign({search:"",hash:""},D(t)?{pathname:t}:t,{__renderId:n});return this.ready=this.resolve(r).then(t=>this.__fullyResolveChain(t)).then(t=>{if(this.__isLatestRender(t)){let r=this.__previousContext;if(t===r)return this.__updateBrowserHistory(r,!0),this.location;if(this.location=to(t),e&&this.__updateBrowserHistory(t,1===n),R("location-changed",{router:this,location:this.location}),t.__skipAttach)return this.__copyUnchangedElements(t,r),this.__previousContext=t,this.location;this.__addAppearingContent(t,r);let i=this.__animateIfNeeded(t);return this.__runOnAfterEnterCallbacks(t),this.__runOnAfterLeaveCallbacks(t,r),i.then(()=>{if(this.__isLatestRender(t))return this.__removeDisappearingContent(),this.__previousContext=t,this.location})}}).catch(t=>{if(n===this.__lastStartedRenderId)throw e&&this.__updateBrowserHistory(r),tc(this.__outlet&&this.__outlet.children),this.location=to(Object.assign(r,{resolver:this})),R("error",Object.assign({router:this,error:t},r)),t}),this.ready}__fullyResolveChain(t,e=t){return this.__findComponentContextAfterAllRedirects(e).then(n=>{let r=n!==e,i=r?n:t,o=th(tl(n.chain),n.resolver),s=o===n.pathname,a=(t,e=t.route,n)=>t.next(void 0,e,n).then(n=>{if(null===n||n===L){if(s)return t;if(null!==e.parent)return a(t,e.parent,n)}return n});return a(n).then(t=>{if(null===t||t===L)throw O(i);return t&&t!==L&&t!==n?this.__fullyResolveChain(i,t):this.__amendWithOnBeforeCallbacks(n)})})}__findComponentContextAfterAllRedirects(t){let e=t.result;return e instanceof HTMLElement?(!function(t,e){e.location=to(t);let n=t.chain.map(t=>t.route).indexOf(t.route);t.chain[n].element=e}(t,e),Promise.resolve(t)):e.redirect?this.__redirect(e.redirect,t.__redirectCount,t.__renderId).then(t=>this.__findComponentContextAfterAllRedirects(t)):e instanceof Error?Promise.reject(e):Promise.reject(Error(I(`Invalid route resolution result for path "${t.pathname}". Expected redirect object or HTML element, but got: "${function(t){if("object"!=typeof t)return String(t);let e=Object.prototype.toString.call(t).match(/ (.*)\]$/)[1];return"Object"===e||"Array"===e?`${e} ${JSON.stringify(t)}`:e}(e)}". Double check the action return value for the route.`)))}__amendWithOnBeforeCallbacks(t){return this.__runOnBeforeCallbacks(t).then(e=>e===this.__previousContext||e===t?e:this.__fullyResolveChain(e))}__runOnBeforeCallbacks(t){let e=this.__previousContext||{},n=e.chain||[],r=t.chain,i=Promise.resolve(),o=()=>({cancel:!0}),s=e=>ts(t,e);if(t.__divergedChainIndex=0,t.__skipAttach=!1,n.length){for(let e=0;e<Math.min(n.length,r.length)&&n[e].route===r[e].route&&(n[e].path===r[e].path||n[e].element===r[e].element)&&this.__isReusableElement(n[e].element,r[e].element);e=++t.__divergedChainIndex);if(t.__skipAttach=r.length===n.length&&t.__divergedChainIndex==r.length&&this.__isReusableElement(t.result,e.result),t.__skipAttach){for(let e=r.length-1;e>=0;e--)i=this.__runOnBeforeLeaveCallbacks(i,t,{prevent:o},n[e]);for(let e=0;e<r.length;e++)i=this.__runOnBeforeEnterCallbacks(i,t,{prevent:o,redirect:s},r[e]),n[e].element.location=to(t,n[e].route)}else for(let e=n.length-1;e>=t.__divergedChainIndex;e--)i=this.__runOnBeforeLeaveCallbacks(i,t,{prevent:o},n[e])}if(!t.__skipAttach)for(let e=0;e<r.length;e++)e<t.__divergedChainIndex?e<n.length&&n[e].element&&(n[e].element.location=to(t,n[e].route)):(i=this.__runOnBeforeEnterCallbacks(i,t,{prevent:o,redirect:s},r[e]),r[e].element&&(r[e].element.location=to(t,r[e].route)));return i.then(e=>{if(e){if(e.cancel)return this.__previousContext.__renderId=t.__renderId,this.__previousContext;if(e.redirect)return this.__redirect(e.redirect,t.__redirectCount,t.__renderId)}return t})}__runOnBeforeLeaveCallbacks(t,e,n,r){let i=to(e);return t.then(t=>{if(this.__isLatestRender(e)){let e=tu("onBeforeLeave",[i,n,this],r.element);return e(t)}}).then(t=>{if(!(t||{}).redirect)return t})}__runOnBeforeEnterCallbacks(t,e,n,r){let i=to(e,r.route);return t.then(t=>{if(this.__isLatestRender(e)){let e=tu("onBeforeEnter",[i,n,this],r.element);return e(t)}})}__isReusableElement(t,e){return!!t&&!!e&&(this.__createdByRouter.get(t)&&this.__createdByRouter.get(e)?t.localName===e.localName:t===e)}__isLatestRender(t){return t.__renderId===this.__lastStartedRenderId}__redirect(t,e,n){if(e>256)throw Error(I(`Too many redirects when rendering ${t.from}`));return this.resolve({pathname:this.urlForPath(t.pathname,t.params),redirectFrom:t.from,__redirectCount:(e||0)+1,__renderId:n})}__ensureOutlet(t=this.__outlet){if(!(t instanceof Node))throw TypeError(I(`Expected router outlet to be a valid DOM Node (but got ${t})`))}__updateBrowserHistory({pathname:t,search:e="",hash:n=""},r){(window.location.pathname!==t||window.location.search!==e||window.location.hash!==n)&&(window.history[r?"replaceState":"pushState"](null,document.title,t+e+n),window.dispatchEvent(new PopStateEvent("popstate",{state:"vaadin-router-ignore"})))}__copyUnchangedElements(t,e){let n=this.__outlet;for(let r=0;r<t.__divergedChainIndex;r++){let i=e&&e.chain[r].element;if(i){if(i.parentNode===n)t.chain[r].element=i,n=i;else break}}return n}__addAppearingContent(t,e){this.__ensureOutlet(),this.__removeAppearingContent();let n=this.__copyUnchangedElements(t,e);this.__appearingContent=[],this.__disappearingContent=Array.from(n.children).filter(e=>this.__addedByRouter.get(e)&&e!==t.result);let r=n;for(let e=t.__divergedChainIndex;e<t.chain.length;e++){let i=t.chain[e].element;i&&(r.appendChild(i),this.__addedByRouter.set(i,!0),r===n&&this.__appearingContent.push(i),r=i)}}__removeDisappearingContent(){this.__disappearingContent&&tc(this.__disappearingContent),this.__disappearingContent=null,this.__appearingContent=null}__removeAppearingContent(){this.__disappearingContent&&this.__appearingContent&&(tc(this.__appearingContent),this.__disappearingContent=null,this.__appearingContent=null)}__runOnAfterLeaveCallbacks(t,e){if(e)for(let n=e.chain.length-1;n>=t.__divergedChainIndex&&this.__isLatestRender(t);n--){let r=e.chain[n].element;if(r)try{let n=to(t);ta(r.onAfterLeave,[n,{},e.resolver],r)}finally{this.__disappearingContent.indexOf(r)>-1&&tc(r.children)}}}__runOnAfterEnterCallbacks(t){for(let e=t.__divergedChainIndex;e<t.chain.length&&this.__isLatestRender(t);e++){let n=t.chain[e].element||{},r=to(t,t.chain[e].route);ta(n.onAfterEnter,[r,{},t.resolver],n)}}__animateIfNeeded(t){let e;let n=(this.__disappearingContent||[])[0],r=(this.__appearingContent||[])[0],i=[],o=t.chain;for(let t=o.length;t>0;t--)if(o[t-1].route.animate){e=o[t-1].route.animate;break}if(n&&r&&e){let t=x(e)&&e.leave||"leaving",o=x(e)&&e.enter||"entering";i.push(ti(n,t)),i.push(ti(r,o))}return Promise.all(i).then(()=>t)}subscribe(){window.addEventListener("vaadin-router-go",this.__navigationEventHandler)}unsubscribe(){window.removeEventListener("vaadin-router-go",this.__navigationEventHandler)}__onNavigationEvent(t){let{pathname:e,search:n,hash:r}=t?t.detail:window.location;D(this.__normalizePathname(e))&&(t&&t.preventDefault&&t.preventDefault(),this.render({pathname:e,search:n,hash:r},!0))}static setTriggers(...t){te.forEach(t=>t.inactivate()),t.forEach(t=>t.activate()),te=t}urlForName(t,e){return this.__urlForName||(this.__urlForName=function(t,e={}){if(!(t instanceof $))throw TypeError("An instance of Resolver is expected");let n=new Map;return(r,i)=>{let o=Z(n,r);if(!o&&(n.clear(),function t(e,n,r){let i=n.name||n.component;if(i&&(e.has(i)?e.get(i).push(n):e.set(i,[n])),Array.isArray(r))for(let i=0;i<r.length;i++){let o=r[i];o.parent=n,t(e,o,o.__children||o.children)}}(n,t.root,t.root.__children),!(o=Z(n,r))))throw Error(`Route "${r}" not found`);let s=J.get(o.fullPath);if(!s){let t=tt(o),e=o.parent;for(;e;){let n=tt(e);n&&(t=n.replace(/\/$/,"")+"/"+t.replace(/^\//,"")),e=e.parent}let n=X.parse(t),r=X.tokensToFunction(n),i=Object.create(null);for(let t=0;t<n.length;t++)D(n[t])||(i[n[t].name]=!0);s={toPath:r,keys:i},J.set(t,s),o.fullPath=t}let a=s.toPath(i,e)||"/";if(e.stringifyQueryParams&&i){let t={},n=Object.keys(i);for(let e=0;e<n.length;e++){let r=n[e];s.keys[r]||(t[r]=i[r])}let r=e.stringifyQueryParams(t);r&&(a+="?"===r.charAt(0)?r:`?${r}`)}return a}}(this)),th(this.__urlForName(t,e),this)}urlForPath(t,e){return th(tf.pathToRegexp.compile(t)(e),this)}static go(t){let{pathname:e,search:n,hash:r}=D(t)?this.__createUrl(t,"http://a"):t;return R("go",{pathname:e,search:n,hash:r})}}const td=/\/\*[\*!]\s+vaadin-dev-mode:start([\s\S]*)vaadin-dev-mode:end\s+\*\*\//i,tp=window.Vaadin&&window.Vaadin.Flow&&window.Vaadin.Flow.clients;function tv(t,e){if("function"!=typeof t)return;let n=td.exec(t.toString());if(n)try{t=Function(n[1])}catch(t){console.log("vaadin-development-mode-detector: uncommentAndRun() failed",t)}return t(e)}window.Vaadin=window.Vaadin||{};const tg=function(t,e){if(window.Vaadin.developmentMode)return tv(t,e)};void 0===window.Vaadin.developmentMode&&(window.Vaadin.developmentMode=function(){try{if(localStorage.getItem("vaadin.developmentmode.force"))return!0;if(!(["localhost","127.0.0.1"].indexOf(window.location.hostname)>=0))return!1;if(tp)return!function(){if(tp){let t=Object.keys(tp).map(t=>tp[t]).filter(t=>t.productionMode);if(t.length>0)return!0}return!1}();return!tv(function(){return!0})}catch(t){return!1}}()),window.Vaadin=window.Vaadin||{},window.Vaadin.registrations=window.Vaadin.registrations||[],window.Vaadin.registrations.push({is:"@vaadin/router",version:"1.7.4"}),tg(function(){}),tf.NavigationTrigger={POPSTATE:{activate(){window.addEventListener("popstate",U)},inactivate(){window.removeEventListener("popstate",U)}},CLICK:{activate(){window.document.addEventListener("click",M)},inactivate(){window.document.removeEventListener("click",M)}}};var tm={};Object.defineProperty(tm,"__esModule",{value:!0,configurable:!0}),t(tm,"firebase",()=>eA),t(tm,"default",()=>eR);var ty=function(t,e){return(ty=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function t_(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}ty(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var tb=function(){return(tb=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function tw(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})}function tI(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function tT(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tE(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function tS(t,e,n){if(n||2==arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var tC={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},tk=function(t,e){if(!t)throw tN(e)},tN=function(t){return Error("Firebase Database ("+tC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},tA=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):(64512&i)==55296&&r+1<t.length&&(64512&t.charCodeAt(r+1))==56320?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},tR=function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var o=t[n++],s=t[n++],a=((7&i)<<18|(63&o)<<12|(63&s)<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{var o=t[n++],s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")},tx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,d=63&c;u||(d=64,s||(f=64)),r.push(n[h],n[l],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(tA(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):tR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},tP=function(t){var e=tA(t);return tx.encodeByteArray(e,!0)},tD=function(t){try{return tx.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function tO(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=tO(t[n],e[n]));return t}var tL=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();function tM(t,e){if(t.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=tb({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[tx.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),tx.encodeString(JSON.stringify(o),!1),""].join(".")}function tF(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function tU(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tF())}function tj(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function tq(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function tV(){return!0===tC.NODE_CLIENT||!0===tC.NODE_ADMIN}function tB(){return"indexedDB"in self&&null!=indexedDB}function tK(){return new Promise(function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})}function tW(){return!!navigator&&!!navigator.cookieEnabled}var tH=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,tz.prototype.create),o}return t_(e,t),e}(Error),tz=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?o.replace(tG,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"}):"Error",a=this.serviceName+": "+s+" ("+i+").";return new tH(i,a,r)},t}(),tG=/\{\$([^}]+)}/g;function tQ(t){return JSON.parse(t)}function tY(t){return JSON.stringify(t)}var t$=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=tQ(tD(o[0])||""),n=tQ(tD(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},tX=function(t){var e=t$(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},tJ=function(t){var e=t$(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},tZ=function(t){var e=t$(t).claims;return"object"==typeof e&&!0===e.admin};function t0(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function t1(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function t2(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function t4(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}var t3=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n,r,i=this.W_;if("string"==typeof t)for(var o=0;o<16;o++)i[o]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(var o=0;o<16;o++)i[o]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(var o=16;o<80;o++){var s=i[o-3]^i[o-8]^i[o-14]^i[o-16];i[o]=(s<<1|s>>>31)&4294967295}for(var a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4],o=0;o<80;o++){o<40?o<20?(n=h^u&(c^h),r=1518500249):(n=u^c^h,r=1859775393):o<60?(n=u&c|h&(u|c),r=2400959708):(n=u^c^h,r=3395469782);var s=(a<<5|a>>>27)+n+l+r+i[o]&4294967295;l=h,h=c,c=(u<<30|u>>>2)&4294967295,u=a,a=s}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function t6(t,e){var n=new t5(t,e);return n.subscribe.bind(n)}var t5=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw Error("Missing Observer.");void 0===(r=!function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0;n<e.length;n++){var r=e[n];if(r in t&&"function"==typeof t[r])return!0}return!1}(t,["next","error","complete"])?{next:t,error:e,complete:n}:t).next&&(r.next=t8),void 0===r.error&&(r.error=t8),void 0===r.complete&&(r.complete=t8);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function t8(){}var t7=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function t9(t,e){return t+" failed: "+e+" argument "}function et(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw Error(t9(t,e)+"must be a valid function.")}function ee(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw Error(t9(t,e)+"must be a valid context object.")}var en=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;tk(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},er=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};function ei(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t);return Math.min(144e5,r+Math.round(.5*r*(Math.random()-.5)*2))}function eo(t){return t&&t._delegate?t._delegate:t}var es=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),ea="[DEFAULT]",eu=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new tL;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}else{if(r)return null;throw Error("Service "+this.name+" is not available")}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if("EAGER"===t.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:ea})}catch(t){}try{for(var r=tT(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=tE(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=ea),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){switch(e.label){case 0:return[4,Promise.all(tS(tS([],tE((t=Array.from(this.instances.values())).filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))),tE(t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()}))))];case 1:return e.sent(),[2]}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=ea),this.instances.has(t)},t.prototype.initialize=function(t){void 0===t&&(t={});var e,n,r=t.options,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(this.name+"("+i+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var o=this.getOrInitializeService({instanceIdentifier:i,options:void 0===r?{}:r});try{for(var s=tT(this.instancesDeferred.entries()),a=s.next();!a.done;a=s.next()){var u=tE(a.value,2),c=u[0],h=u[1],l=this.normalizeInstanceIdentifier(c);i===l&&h.resolve(o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return o},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=tT(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e=t.instanceIdentifier,n=t.options,r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:e===ea?void 0:e,options:void 0===n?{}:n}),this.instances.set(e,r),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(t){}return r||null},t.prototype.normalizeInstanceIdentifier=function(t){return(void 0===t&&(t=ea),this.component)?this.component.multipleInstances?t:ea:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),ec=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new eu(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();function eh(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var el=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(sU||(sU={}));var ef={debug:sU.DEBUG,verbose:sU.VERBOSE,info:sU.INFO,warn:sU.WARN,error:sU.ERROR,silent:sU.SILENT},ed=sU.INFO,ep=((sF={})[sU.DEBUG]="log",sF[sU.VERBOSE]="log",sF[sU.INFO]="info",sF[sU.WARN]="warn",sF[sU.ERROR]="error",sF),ev=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=new Date().toISOString(),o=ep[e];if(o)console[o].apply(console,eh(["["+i+"]  "+t.name+":"],n));else throw Error("Attempted to log a message with an invalid logType (value: "+e+")")}},eg=function(){function t(t){this.name=t,this._logLevel=ed,this._logHandler=ev,this._userLogHandler=null,el.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in sU))throw TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?ef[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,eh([this,sU.DEBUG],t)),this._logHandler.apply(this,eh([this,sU.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,eh([this,sU.VERBOSE],t)),this._logHandler.apply(this,eh([this,sU.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,eh([this,sU.INFO],t)),this._logHandler.apply(this,eh([this,sU.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,eh([this,sU.WARN],t)),this._logHandler.apply(this,eh([this,sU.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,eh([this,sU.ERROR],t)),this._logHandler.apply(this,eh([this,sU.ERROR],t))},t}();function em(t){el.forEach(function(e){e.setLogLevel(t)})}var ey=((sj={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",sj["bad-app-name"]="Illegal App name: '{$appName}",sj["duplicate-app"]="Firebase App named '{$appName}' already exists",sj["app-deleted"]="Firebase App named '{$appName}' already deleted",sj["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",sj["invalid-log-argument"]="First argument to `onLog` must be null or a function.",sj),e_=new tz("app","Firebase",ey),eb="@firebase/app",ew="[DEFAULT]",eI=((sq={})[eb]="fire-core",sq["@firebase/analytics"]="fire-analytics",sq["@firebase/app-check"]="fire-app-check",sq["@firebase/auth"]="fire-auth",sq["@firebase/database"]="fire-rtdb",sq["@firebase/functions"]="fire-fn",sq["@firebase/installations"]="fire-iid",sq["@firebase/messaging"]="fire-fcm",sq["@firebase/performance"]="fire-perf",sq["@firebase/remote-config"]="fire-rc",sq["@firebase/storage"]="fire-gcs",sq["@firebase/firestore"]="fire-fst",sq["fire-js"]="fire-js",sq["firebase-wrapper"]="fire-js-all",sq),eT=new eg("@firebase/app"),eE=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=tO(void 0,t),this.container=new ec(e.name),this._addComponent(new es("app",function(){return r},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(t){return r._addComponent(t)})}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(t){return t.delete()}))}).then(function(){t.isDeleted_=!0})},t.prototype._getService=function(t,e){void 0===e&&(e=ew),this.checkDestroyed_();var n,r=this.container.getProvider(t);return r.isInitialized()||(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)!=="EXPLICIT"||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=ew),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){eT.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw e_.create("app-deleted",{appName:this.name_})},t}();eE.prototype.name&&eE.prototype.options||eE.prototype.delete||console.log("dc");var eS=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),("object"!=typeof i||null===i)&&(i={name:i});var o=i;void 0===o.name&&(o.name=ew);var s=o.name;if("string"!=typeof s||!s)throw e_.create("bad-app-name",{appName:String(s)});if(t0(e,s))throw e_.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=eI[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),eT.warn(u.join(" "));return}o(new es(i+"-version",function(){return{library:i,version:e}},"VERSION"))},setLogLevel:em,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw e_.create("invalid-log-argument");!function(t,e){for(var n=0;n<el.length;n++)!function(n){var r=null;e&&e.level&&(r=ef[e.level]),null===t?n.userLogHandler=null:n.userLogHandler=function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map(function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}}).filter(function(t){return t}).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:sU[n].toLowerCase(),message:s,args:i,type:e.name})}}(el[n])}(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(!t0(e,t=t||ew))throw e_.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return eT.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw e_.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&tO(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++)e[c[u]]._addComponent(o);return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map(function(t){return e[t]})}}),i.App=t,r}(eE);return e.INTERNAL=tb(tb({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){tO(e,t)},createSubscribe:t6,ErrorFactory:tz,deepExtend:tO}),e}(),eC=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if((null==(e=t.getComponent())?void 0:e.type)!=="VERSION")return null;var e,n=t.getImmediate();return n.library+"/"+n.version}).filter(function(t){return t}).join(" ")},t}();if("object"==typeof self&&self.self===self&&void 0!==self.firebase){eT.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var ek=self.firebase.SDK_VERSION;ek&&ek.indexOf("LITE")>=0&&eT.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var eN=eS.initializeApp;eS.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){try{return"[object process]"===Object.prototype.toString.call(b.process)}catch(t){return!1}}()&&eT.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),eN.apply(void 0,t)};var eA=eS;!function(t,e){t.INTERNAL.registerComponent(new es("platform-logger",function(t){return new eC(t)},"PRIVATE")),t.registerVersion(eb,"0.6.28",void 0),t.registerVersion("fire-js","")}(eA);var eR=eA;(function(){var t,e,n,r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function o(t){var e,n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return n?n.call(t):{next:(e=0,function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}})}}!function(t,e){if(e){var n=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var s=t[o];s in n||(n[s]={}),n=n[s]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r(n,t,{configurable:!0,writable:!0,value:e})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var s=i.setTimeout;n.prototype.c=function(t){s(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){this.g(t);return}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)a.b(this.a[t]);this.a=null}};var a=new n;return e.prototype.s=function(t){var e=this.f();t.Ra(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,s=new e(function(t,e){i=t,o=e});return this.Ra(r(t,i),r(n,o)),s},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ra=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=o(t),s=i.next();!s.done;s=i.next())r(s.value).Ra(e,n)})},e.all=function(t){var n=o(t),i=n.next();return i.done?r([]):new e(function(t,e){var o=[],s=0;do o.push(void 0),s++,r(i.value).Ra(function(e){return function(n){o[e]=n,0==--s&&t(o)}}(o.length-1),e),i=n.next();while(!i.done)})},e});var s=s||{},a=this||self,u=/^[\w+/_-]+[=]{0,2}$/,c=null;function h(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&u.test(t)?t:""}function l(){}function f(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function d(t){var e=f(t);return"array"==e||"object"==e&&"number"==typeof t.length}function p(t){return"function"==f(t)}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function g(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++y)}var m="closure_uid_"+(1e9*Math.random()>>>0),y=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function I(t,e,n){return(I=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:w).apply(null,arguments)}function T(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now;function S(t,e){function n(){}n.prototype=e.prototype,t.bb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t){return t}function k(t,e,n){this.code=A+t,this.message=e||R[t]||"",this.a=n||null}function N(t){var e=t&&t.code;return e?new k(e.substring(A.length),t.message,t.serverResponse):null}S(k,Error),k.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},k.prototype.toJSON=function(){return this.w()};var A="auth/",R={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},x={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function P(t){for(var e in x)if(x[e].id===t)return{firebaseEndpoint:(t=x[e]).Ua,secureTokenEndpoint:t.$a,identityPlatformEndpoint:t.Xa};return null}function D(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function O(t){if(Error.captureStackTrace)Error.captureStackTrace(this,O);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function L(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");O.call(this,n+t[r])}function M(t,e){throw new L("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function F(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function U(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function j(){this.b=this.a=null}oH=P("__EID__")?"__EID__":void 0,S(O,Error),O.prototype.name="CustomError",S(L,O),L.prototype.name="AssertionError",F.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var q=new F(function(){return new V},function(t){t.reset()});function V(){this.next=this.b=this.a=null}j.prototype.add=function(t,e){var n=q.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},V.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},V.prototype.reset=function(){this.next=this.b=this.a=null};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return -1},K=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},W=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,s=0;s<n;s++)if(s in o){var a=o[s];e.call(void 0,a,s,t)&&(r[i++]=a)}return r},H=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},z=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function G(t,e){return 0<=B(t,e)}function Q(t,e){var n;return(n=0<=(e=B(t,e)))&&Array.prototype.splice.call(t,e,1),n}function Y(t,e){var n=0;!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,function(r,i){e.call(void 0,r,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&n++})}function $(t){return Array.prototype.concat.apply([],arguments)}function X(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Z=/&/g,tt=/</g,te=/>/g,tn=/"/g,tr=/'/g,ti=/\x00/g,to=/[\x00&<>"']/;function ts(t,e){return -1!=t.indexOf(e)}function ta(t,e){return t<e?-1:t>e?1:0}t:{var tu=a.navigator;if(tu){var tc=tu.userAgent;if(tc){oz=tc;break t}}oz=""}function th(t){return ts(oz,t)}function tl(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function tf(t){for(var e in t)return!1;return!0}function td(t){var e,n={};for(e in t)n[e]=t[e];return n}var tp="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tv(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tp.length;o++)n=tp[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function tg(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||a).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(v(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;M("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function tm(t,e){this.a=t===tb&&e||"",this.b=t_}function ty(t){return t instanceof tm&&t.constructor===tm&&t.b===t_?t.a:(M("expected object of type Const, got '"+t+"'"),"type_error:Const")}tm.prototype.ta=!0,tm.prototype.sa=function(){return this.a},tm.prototype.toString=function(){return"Const{"+this.a+"}"};var t_={},tb={};function tw(){if(void 0===oG){var t=null,e=a.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:C,createScript:C,createScriptURL:C})}catch(t){a.console&&a.console.error(t.message)}oG=t}else oG=t}return oG}function tI(t,e){this.a=e===tk?t:""}function tT(t){return t instanceof tI&&t.constructor===tI?t.a:(M("expected object of type TrustedResourceUrl, got '"+t+"' of type "+f(t)),"type_error:TrustedResourceUrl")}function tE(t,e){var n,r,i=ty(t);if(!tC.test(i))throw Error("Invalid TrustedResourceUrl format: "+i);return n=t=i.replace(tS,function(t,n){if(!Object.prototype.hasOwnProperty.call(e,n))throw Error('Found marker, "'+n+'", in format string, "'+i+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[n])instanceof tm?ty(t):encodeURIComponent(String(t))}),n=(r=tw())?r.createScriptURL(n):n,new tI(n,tk)}tI.prototype.ta=!0,tI.prototype.sa=function(){return this.a.toString()},tI.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var tS=/%{(\w+)}/g,tC=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,tk={};function tN(t,e){this.a=e===tL?t:""}function tA(t){return t instanceof tN&&t.constructor===tN?t.a:(M("expected object of type SafeUrl, got '"+t+"' of type "+f(t)),"type_error:SafeUrl")}tN.prototype.ta=!0,tN.prototype.sa=function(){return this.a.toString()},tN.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var tR=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,tx=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,tP=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function tD(t){if(t instanceof tN)return t;if(t="object"==typeof t&&t.ta?t.sa():String(t),tP.test(t))t=new tN(t,tL);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(tx);t=e&&tR.test(e[1])?new tN(t,tL):null}return t}function tO(t){return t instanceof tN?t:(t="object"==typeof t&&t.ta?t.sa():String(t),tP.test(t)||(t="about:invalid#zClosurez"),new tN(t,tL))}var tL={},tM=new tN("about:invalid#zClosurez",tL);function tF(t,e,n){this.a=n===tU?t:""}tF.prototype.ta=!0,tF.prototype.sa=function(){return this.a.toString()},tF.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var tU={};function tj(t,e,n,r){return t=t instanceof tN?t:tO(t),e=e||a,n=n instanceof tm?ty(n):n||"",e.open(tA(t),n,r,void 0)}function tq(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function tV(t){return to.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(Z,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(tt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(te,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(tn,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(tr,"&#39;")),-1!=t.indexOf("\x00")&&(t=t.replace(ti,"&#0;"))),t}function tB(t){return tB[" "](t),t}tB[" "]=l;var tK=th("Opera"),tW=th("Trident")||th("MSIE"),tH=th("Edge"),tz=tH||tW,tG=th("Gecko")&&!(ts(oz.toLowerCase(),"webkit")&&!th("Edge"))&&!(th("Trident")||th("MSIE"))&&!th("Edge"),tQ=ts(oz.toLowerCase(),"webkit")&&!th("Edge");function tY(){var t=a.document;return t?t.documentMode:void 0}t:{var t$,tX="",tJ=(t$=oz,tG?/rv:([^\);]+)(\)|;)/.exec(t$):tH?/Edge\/([\d\.]+)/.exec(t$):tW?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t$):tQ?/WebKit\/(\S+)/.exec(t$):tK?/(?:Version)[ \/]?(\S+)/.exec(t$):void 0);if(tJ&&(tX=tJ?tJ[1]:""),tW){var tZ=tY();if(null!=tZ&&tZ>parseFloat(tX)){oQ=String(tZ);break t}}oQ=tX}var t0={};function t1(t){return Object.prototype.hasOwnProperty.call(t0,t)?t0[t]:t0[t]=function(){for(var e=0,n=J(String(oQ)).split("."),r=J(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=ta(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||ta(0==s[2].length,0==a[2].length)||ta(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}(t)}var t2=a.document&&tW&&(tY()||parseInt(oQ,10))||void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(t){}var t4=!tW||9<=Number(t2);function t3(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function t6(t,e){tl(e,function(e,n){e&&"object"==typeof e&&e.ta&&(e=e.sa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:t5.hasOwnProperty(n)?t.setAttribute(t5[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}var t5={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function t8(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function t7(t){a.setTimeout(function(){throw t},0)}function t9(t,e){oX||function(){if(a.Promise&&a.Promise.resolve){var t=a.Promise.resolve(void 0);oX=function(){t.then(en)}}else oX=function(){!p(a.setImmediate)||a.Window&&a.Window.prototype&&!th("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(o$||(o$=function(){var t=a.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!th("Presto")&&(t=function(){var t=t8(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=I(function(t){("*"==r||t.origin==r)&&t.data==n&&this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!th("Trident")&&!th("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Hb;n.Hb=null,t()}},function(t){r.next={Hb:t},r=r.next,e.port2.postMessage(0)}}return function(t){a.setTimeout(t,0)}}()),o$(en)):a.setImmediate(en)}}(),et||(oX(),et=!0),ee.add(t,e)}var et=!1,ee=new j;function en(){for(var t,e;t=null,ee.a&&(t=ee.a,ee.a=ee.a.next,ee.a||(ee.b=null),t.next=null),e=t;){try{e.a.call(e.b)}catch(t){t7(t)}U(q,e)}et=!1}function er(t,e){if(this.a=ei,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=l)try{var n=this;t.call(e,function(t){eg(n,eo,t)},function(t){if(!(t instanceof eT))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}eg(n,es,t)})}catch(t){eg(this,es,t)}}var ei=0,eo=2,es=3;function ea(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}ea.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var eu=new F(function(){return new ea},function(t){t.reset()});function ec(t,e,n){var r=eu.get();return r.g=t,r.b=e,r.f=n,r}function eh(t){if(t instanceof er)return t;var e=new er(l);return eg(e,eo,t),e}function el(t){return new er(function(e,n){n(t)})}function ef(t,e,n){em(t,e,n,null)||t9(T(e,t))}function ed(t){return new er(function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)ef(t[o],T(i,o,!0),T(i,o,!1));else e(r)})}function ep(t,e){t.b||t.a!=eo&&t.a!=es||ey(t),t.f?t.f.next=e:t.b=e,t.f=e}function ev(t,e,n,r){var i=ec(null,null,null);return i.a=new er(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof eT?o(e):t(i)}catch(t){o(t)}}:o}),i.a.c=t,ep(t,i),i.a}function eg(t,e,n){var r;t.a==ei&&(t===n&&(e=es,n=TypeError("Promise cannot resolve to itself")),t.a=1,em(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,ey(t),e!=es||n instanceof eT||(r=n,t.g=!0,t9(function(){t.g&&eI.call(null,r)}))))}function em(t,e,n,r){if(t instanceof er)return ep(t,ec(e||l,n||null,r)),!0;if(D(t))return t.then(e,n,r),!0;if(v(t))try{var i=t.then;if(p(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}var s=!1;try{e.call(t,function(t){s||(s=!0,n.call(i,t))},o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function ey(t){t.h||(t.h=!0,t9(t.gc,t))}function e_(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function eb(t,e,n,r){if(n==es&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,ew(e,n,r);else try{e.c?e.g.call(e.f):ew(e,n,r)}catch(t){eI.call(null,t)}U(eu,e)}function ew(t,e,n){e==eo?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}er.prototype.then=function(t,e,n){return ev(this,p(t)?t:null,p(e)?e:null,n)},er.prototype.$goog_Thenable=!0,(n=er.prototype).oa=function(t,e){return(t=ec(t,t,e)).c=!0,ep(this,t),this},n.o=function(t,e){return ev(this,null,t,e)},n.cancel=function(t){if(this.a==ei){var e=new eT(t);t9(function(){(function t(e,n){if(e.a==ei){if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,s=null,a=r.b;a&&(a.c||(i++,a.a==e&&(o=a),!(o&&1<i)));a=a.next)o||(s=a);o&&(r.a==ei&&1==i?t(r,n):(s?((i=s).next==r.f&&(r.f=i),i.next=i.next.next):e_(r),eb(r,o,es,n)))}e.c=null}else eg(e,es,n)}})(this,e)},this)}},n.$c=function(t){this.a=ei,eg(this,eo,t)},n.ad=function(t){this.a=ei,eg(this,es,t)},n.gc=function(){for(var t;t=e_(this);)eb(this,t,this.a,this.i);this.h=!1};var eI=t7;function eT(t){O.call(this,t)}function eE(){0!=eS&&(eC[g(this)]=this),this.ya=this.ya,this.pa=this.pa}S(eT,O),eT.prototype.name="cancel";var eS=0,eC={};function ek(t){if(!t.ya&&(t.ya=!0,t.Da(),0!=eS)){var e=g(t);if(0!=eS&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete eC[e]}}eE.prototype.ya=!1,eE.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var eN=Object.freeze||function(t){return t},eA=!tW||9<=Number(t2),ex=tW&&!t1("9"),eP=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",l,e),a.removeEventListener("test",l,e)}catch(t){}return t}();function eD(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function eO(t,e){if(eD.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(tG){t:{try{tB(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:eL[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}eD.prototype.preventDefault=function(){this.defaultPrevented=!0},S(eO,eD);var eL=eN({2:"touch",3:"pen",4:"mouse"});eO.prototype.preventDefault=function(){eO.bb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ex)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},eO.prototype.g=function(){return this.a};var eM="closure_listenable_"+(1e6*Math.random()|0),eF=0;function eU(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Wa=i,this.key=++eF,this.wa=this.Qa=!1}function ej(t){t.wa=!0,t.listener=null,t.proxy=null,t.src=null,t.Wa=null}function eq(t){this.src=t,this.a={},this.b=0}function eV(t,e){var n=e.type;n in t.a&&Q(t.a[n],e)&&(ej(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function eB(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.wa&&o.listener==e&&!!n==o.capture&&o.Wa==r)return i}return -1}eq.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=eB(t,e,r,i);return -1<s?(e=t[s],n||(e.Qa=!1)):((e=new eU(e,this.src,o,!!r,i)).Qa=n,t.push(e)),e};var eK="closure_lm_"+(1e6*Math.random()|0),eW={},eH=0;function ez(t,e,n,r,i){if(r&&r.once)eQ(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)ez(t,e[o],n,r,i);else n=e4(n),t&&t[eM]?e6(t,e,n,v(r)?!!r.capture:!!r,i):eG(t,e,n,!1,r,i)}function eG(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s,a=v(i)?!!i.capture:!!i,u=e1(t);if(u||(t[eK]=u=new eq(t)),!(n=u.add(e,n,r,a,o)).proxy){if(r=s=eA?function(t){return e0.call(s.src,s.listener,t)}:function(t){if(!(t=e0.call(s.src,s.listener,t)))return t},n.proxy=r,r.src=t,r.listener=n,t.addEventListener)eP||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(eX(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");eH++}}function eQ(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)eQ(t,e[o],n,r,i);else n=e4(n),t&&t[eM]?e5(t,e,n,v(r)?!!r.capture:!!r,i):eG(t,e,n,!0,r,i)}function eY(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)eY(t,e[o],n,r,i);else(r=v(r)?!!r.capture:!!r,n=e4(n),t&&t[eM])?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=eB(o=t.a[e],n,r,i))&&(ej(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=e1(t))&&(e=t.a[e.toString()],t=-1,e&&(t=eB(e,n,r,i)),(n=-1<t?e[t]:null)&&e$(n))}function e$(t){if("number"!=typeof t&&t&&!t.wa){var e=t.src;if(e&&e[eM])eV(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(eX(n),r):e.addListener&&e.removeListener&&e.removeListener(r),eH--,(n=e1(e))?(eV(n,t),0==n.b&&(n.src=null,e[eK]=null)):ej(t)}}}function eX(t){return t in eW?eW[t]:eW[t]="on"+t}function eJ(t,e,n,r){var i=!0;if((t=e1(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.wa&&(o=eZ(o,r),i=i&&!1!==o)}return i}function eZ(t,e){var n=t.listener,r=t.Wa||t.src;return t.Qa&&e$(t),n.call(r,e)}function e0(t,e){if(t.wa)return!0;if(!eA){if(!e)t:{e=["window","event"];for(var n=a,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(r=e,e=new eO(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=eJ(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=eJ(r[i],t,!1,e),n=n&&o}return n}return eZ(t,new eO(e,this))}function e1(t){return(t=t[eK])instanceof eq?t:null}var e2="__closure_events_fn_"+(1e9*Math.random()>>>0);function e4(t){return p(t)?t:(t[e2]||(t[e2]=function(e){return t.handleEvent(e)}),t[e2])}function e3(){eE.call(this),this.v=new eq(this),this.bc=this,this.hb=null}function e6(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function e5(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function e8(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.wa&&s.capture==n){var a=s.listener,u=s.Wa||s.src;s.Qa&&eV(t.v,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}function e7(t,e,n){if(p(t))n&&(t=I(t,n));else if(t&&"function"==typeof t.handleEvent)t=I(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function e9(t){var e=null;return new er(function(n,r){-1==(e=e7(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).o(function(t){throw a.clearTimeout(e),t})}function nt(t){if(t.X&&"function"==typeof t.X)return t.X();if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function ne(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.X||"function"!=typeof t.X){if(d(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function nn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t){if(t instanceof nn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}}function nr(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ni(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)ni(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function ni(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(e3,eE),e3.prototype[eM]=!0,e3.prototype.addEventListener=function(t,e,n,r){ez(this,t,e,n,r)},e3.prototype.removeEventListener=function(t,e,n,r){eY(this,t,e,n,r)},e3.prototype.dispatchEvent=function(t){var e,n=this.hb;if(n)for(e=[];n;n=n.hb)e.push(n);n=this.bc;var r=t.type||t;if("string"==typeof t)t=new eD(t,n);else if(t instanceof eD)t.target=t.target||n;else{var i=t;tv(t=new eD(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=e8(s,r,!0,t)&&i}if(i=e8(s=t.b=n,r,!0,t)&&i,i=e8(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=e8(s=t.b=e[o],r,!1,t)&&i;return i},e3.prototype.Da=function(){if(e3.bb.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ej(n[r]);delete e.a[t],e.b--}}this.hb=null},(n=nn.prototype).X=function(){nr(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},n.Y=function(){return nr(this),this.a.concat()},n.clear=function(){this.b={},this.c=this.a.length=0},n.get=function(t,e){return ni(this.b,t)?this.b[t]:e},n.set=function(t,e){ni(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},n.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var no=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ns(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof ns?(this.i=void 0!==e?e:t.i,na(this,t.c),this.l=t.l,this.a=t.a,nu(this,t.g),this.f=t.f,nc(this,nN(t.b)),this.h=t.h):t&&(n=String(t).match(no))?(this.i=!!e,na(this,n[1]||"",!0),this.l=np(n[2]||""),this.a=np(n[3]||"",!0),nu(this,n[4]),this.f=np(n[5]||"",!0),nc(this,n[6]||"",!0),this.h=np(n[7]||"")):(this.i=!!e,this.b=new nI(null,this.i))}function na(t,e,n){t.c=n?np(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function nu(t,e){if(e){if(isNaN(e=Number(e))||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function nc(t,e,n){var r,i;e instanceof nI?(t.b=e,r=t.b,(i=t.i)&&!r.f&&(nT(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(nS(this,e),nk(this,n,t))},r)),r.f=i):(n||(e=nv(e,nb)),t.b=new nI(e,t.i))}function nh(t,e,n){t.b.set(e,n)}function nl(t,e){return t.b.get(e)}function nf(t){return t instanceof ns?new ns(t):new ns(t,void 0)}function nd(t,e,n,r){var i=new ns(null,void 0);return t&&na(i,t),e&&(i.a=e),n&&nu(i,n),r&&(i.f=r),i}function np(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nv(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ng),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ng(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ns.prototype.toString=function(){var t=[],e=this.c;e&&t.push(nv(e,nm,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(nv(e,nm,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(nv(n,"/"==n.charAt(0)?n_:ny,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",nv(n,nw)),t.join("")},ns.prototype.resolve=function(t){var e=new ns(this),n=!!t.c;n?na(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)nu(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0)){if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}}if(".."==(i=r)||"."==i)r="";else if(ts(i,"./")||ts(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?nc(e,nN(t.b)):n=!!t.h,n&&(e.h=t.h),e};var nm=/[#\/\?@]/g,ny=/[#\?:]/g,n_=/[#\?]/g,nb=/[#\?@]/g,nw=/#/g;function nI(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function nT(t){t.a||(t.a=new nn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function nE(t){var e=ne(t);if(void 0===e)throw Error("Keys are undefined");var n=new nI(null,void 0);t=nt(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?nk(n,i,o):n.add(i,o)}return n}function nS(t,e){nT(t),e=nA(t,e),ni(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ni((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&nr(t)))}function nC(t,e){return nT(t),e=nA(t,e),ni(t.a.b,e)}function nk(t,e,n){nS(t,e),0<n.length&&(t.c=null,t.a.set(nA(t,e),X(n)),t.b+=n.length)}function nN(t){var e=new nI;return e.c=t.c,t.a&&(e.a=new nn(t.a),e.b=t.b),e}function nA(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function nR(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var o="",s=0;s<n;s++)r.push(o),t(e,i[s],r),o=",";r.push("]");return}if(n instanceof String||n instanceof Number||n instanceof Boolean)n=n.valueOf();else{for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(s=n[i])&&(r.push(o),nO(i,r),r.push(":"),t(e,s,r),o=",");r.push("}");return}}switch(typeof n){case"string":nO(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new nx,t,e),e.join("")}function nx(){}(n=nI.prototype).add=function(t,e){nT(this),this.c=null,t=nA(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},n.clear=function(){this.a=this.c=null,this.b=0},n.forEach=function(t,e){nT(this),this.a.forEach(function(n,r){K(n,function(n){t.call(e,n,r,this)},this)},this)},n.Y=function(){nT(this);for(var t=this.a.X(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},n.X=function(t){nT(this);var e=[];if("string"==typeof t)nC(this,t)&&(e=$(e,this.a.get(nA(this,t))));else{t=this.a.X();for(var n=0;n<t.length;n++)e=$(e,t[n])}return e},n.set=function(t,e){return nT(this),this.c=null,nC(this,t=nA(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},n.get=function(t,e){return t&&0<(t=this.X(t)).length?String(t[0]):e},n.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var nP={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\u000b"},nD=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function nO(t,e){e.push('"',t.replace(nD,function(t){var e=nP[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),nP[t]=e),e}),'"')}function nL(){var t=n0();return tW&&!!t2&&11==t2||/Edge\/\d+/.test(t)}function nM(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function nF(t,e){e=e||a.window;var n="about:blank";t&&(n=tA(tD(t)||tM)),e.location.href=n}function nU(t){return!!((t=(t||n0()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function nj(t){t=t||a.window;try{t.close()}catch(t){}}function nq(t,e,n){var r,i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var o=(window.screen.availHeight-n)/2,s=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<o?o:0,left:0<s?s:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=n0().toLowerCase(),i&&(e.target=i,ts(n,"crios/")&&(e.target="_blank")),nX(n0())==nY&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof tN?n:tD(void 0!==n.href?n.href:String(n))||tM,n=t.target||n.target,o=[],t)switch(a){case"width":case"height":case"top":case"left":o.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:o.push(a+"="+(t[a]?1:0))}var a=o.join(",");if((th("iPhone")&&!th("iPod")&&!th("iPad")||th("iPad")||th("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(tg(a=t8(document,"A"),"HTMLAnchorElement"),e=e instanceof tN?e:tO(e),a.href=tA(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=tj("",i,n,a),t=tA(e),a&&(tz&&ts(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+tV(t)+'">',t=(i=tw())?i.createHTML(t):t,t=new tF(t,null,tU),i=a.document)&&(i.write((r=t)instanceof tF&&r.constructor===tF?r.a:(M("expected object of type SafeHtml, got '"+r+"' of type "+f(r)),"type_error:SafeHtml")),i.close())):(a=tj(e,i,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var nV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nB=/^[^@]+@[^@]+$/;function nK(){var t=null;return new er(function(e){"complete"==a.document.readyState?e():(t=function(){e()},eQ(window,"load",t))}).o(function(e){throw eY(window,"load",t),e})}function nW(t){return t=t||n0(),!("file:"!==n6()&&"ionic:"!==n6()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function nH(){var t=a.window;try{return!(!t||t==t.top)}catch(t){return!1}}function nz(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function nG(){return eR.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":eR.INTERNAL.hasOwnProperty("node")?"Node":nz()?"Worker":"Browser"}function nQ(){var t=nG();return"ReactNative"===t||"Node"===t}var nY="Firefox",n$="Chrome";function nX(t){var e=t.toLowerCase();return ts(e,"opera/")||ts(e,"opr/")||ts(e,"opios/")?"Opera":ts(e,"iemobile")?"IEMobile":ts(e,"msie")||ts(e,"trident/")?"IE":ts(e,"edge/")?"Edge":ts(e,"firefox/")?nY:ts(e,"silk/")?"Silk":ts(e,"blackberry")?"Blackberry":ts(e,"webos")?"Webos":!ts(e,"safari/")||ts(e,"chrome/")||ts(e,"crios/")||ts(e,"android")?!ts(e,"chrome/")&&!ts(e,"crios/")||ts(e,"edge/")?ts(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":n$:"Safari"}var nJ={md:"FirebaseCore-web",od:"FirebaseUI-web"};function nZ(t,e){e=e||[];var n,r=[],i={};for(n in nJ)i[nJ[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=nG())?r=nX(i=n0()):"Worker"===r&&(r=nX(i=n0())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function n0(){return a.navigator&&a.navigator.userAgent||""}function n1(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function n2(){try{var t=a.localStorage,e=rt();if(t)return t.setItem(e,"1"),t.removeItem(e),!nL()||!!a.indexedDB}catch(t){return nz()&&!!a.indexedDB}return!1}function n4(){return(n3()||"chrome-extension:"===n6()||nW())&&!nQ()&&n2()&&!nz()}function n3(){return"http:"===n6()||"https:"===n6()}function n6(){return a.location&&a.location.protocol||null}function n5(t){return!nU(t=t||n0())&&nX(t)!=nY}function n8(t){return void 0===t?null:nR(t)}function n7(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function n9(t){if(null!==t)return JSON.parse(t)}function rt(t){return t||Math.floor(1e9*Math.random()).toString()}function re(t){return!("Safari"==nX(t=t||n0())||t.toLowerCase().match(/iphone|ipad|ipod/))}function rn(){var t=a.___jsl;if(t&&t.H){for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}}function rr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=n0(),e=nG(),this.b=nU(t)||"ReactNative"===e}function ri(){var t=a.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function ro(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function rs(){return!(!n1("fireauth.oauthhelper",a)&&!n1("fireauth.iframe",a))}rr.prototype.get=function(){var t=a.navigator;return(t&&"boolean"==typeof t.onLine&&(n3()||"chrome-extension:"===n6()||void 0!==t.connection)?t.onLine:1)?this.b?this.c:this.a:Math.min(5e3,this.a)};var ra={};function ru(t){ra[t]||(ra[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var rc={};Object.defineProperty(rc,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(rc,"abcd",{configurable:!0,enumerable:!0,value:2}),oJ=2==rc.abcd}catch(t){oJ=!1}function rh(t,e,n){oJ?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function rl(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&rh(t,n,e[n])}function rf(t){var e={};return rl(e,t),e}function rd(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)rh(e,n,rd(t[n]));return e}function rp(t){var e=t&&(t[r_]?"phone":null);if(e&&t&&t[ry]){rh(this,"uid",t[ry]),rh(this,"displayName",t[rg]||null);var n=null;t[rm]&&(n=new Date(t[rm]).toUTCString()),rh(this,"enrollmentTime",n),rh(this,"factorId",e)}else throw new k("internal-error","Internal assert: invalid MultiFactorInfo object")}function rv(t){try{var e=new rb(t)}catch(t){e=null}return e}rp.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var rg="displayName",rm="enrolledAt",ry="mfaEnrollmentId",r_="phoneInfo";function rb(t){rp.call(this,t),rh(this,"phoneNumber",t[r_])}function rw(t){var e={},n=t[rS],r=t[rk],i=t[rN];if(t=rv(t[rC]),!i||i!=rT&&i!=rE&&!n||i==rE&&!r||i==rI&&!t)throw Error("Invalid checkActionCode response!");i==rE?(e[rR]=n||null,e[rP]=n||null,e[rA]=r):(e[rR]=r||null,e[rP]=r||null,e[rA]=n||null),e[rx]=t||null,rh(this,rO,i),rh(this,rD,rd(e))}S(rb,rp),rb.prototype.w=function(){var t=rb.bb.w.call(this);return t.phoneNumber=this.phoneNumber,t};var rI="REVERT_SECOND_FACTOR_ADDITION",rT="EMAIL_SIGNIN",rE="VERIFY_AND_CHANGE_EMAIL",rS="email",rC="mfaInfo",rk="newEmail",rN="requestType",rA="email",rR="fromEmail",rx="multiFactorInfo",rP="previousEmail",rD="data",rO="operation";function rL(t){var e=nl(t=nf(t),rM)||null,n=nl(t,rF)||null,r=nl(t,rq)||null;if(r=r&&rB[r]||null,!e||!n||!r)throw new k("argument-error",rM+", "+rF+"and "+rq+" are required in a valid action code URL.");rl(this,{apiKey:e,operation:r,code:n,continueUrl:nl(t,rU)||null,languageCode:nl(t,rj)||null,tenantId:nl(t,rV)||null})}var rM="apiKey",rF="oobCode",rU="continueUrl",rj="languageCode",rq="mode",rV="tenantId",rB={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:rI,signIn:rT,verifyAndChangeEmail:rE,verifyEmail:"VERIFY_EMAIL"};function rK(t){try{return new rL(t)}catch(t){return null}}function rW(t){var e=t[rY];if(void 0===e)throw new k("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new k("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[rH];if(n&&"object"==typeof n){e=n[rJ];var r=n[r$];if(n=n[rX],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new k("argument-error",r$+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new k("argument-error",rX+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new k("argument-error",rJ+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new k("missing-android-pkg-name")}}else if(void 0!==n)throw new k("argument-error",rH+" property must be a non null object when specified.");if(this.f=null,(e=t[rQ])&&"object"==typeof e){if("string"==typeof(e=e[rZ])&&e.length)this.f=e;else if(void 0!==e)throw new k("argument-error",rZ+" property must be a non empty string when specified.")}else if(void 0!==e)throw new k("argument-error",rQ+" property must be a non null object when specified.");if(void 0!==(e=t[rG])&&"boolean"!=typeof e)throw new k("argument-error",rG+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[rz])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new k("argument-error",rz+" property must be a non empty string when specified.");this.i=t||null}var rH="android",rz="dynamicLinkDomain",rG="handleCodeInApp",rQ="iOS",rY="url",r$="installApp",rX="minimumVersion",rJ="packageName",rZ="bundleId";function r0(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var r1=null;function r2(t){var e=r3(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function r4(t){try{return new r2(t)}catch(t){return null}}function r3(t){if(!t||3!=(t=t.split(".")).length)return null;t=t[1];for(var e=(4-t.length%4)%4,n=0;n<e;n++)t+=".";try{var r,i,o=(r=t,i=[],function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=r1[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}(function(){if(!r1){r1={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===r1[o]&&(r1[o]=i)}}})();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;e(i<<2|o>>4),64!=s&&(e(o<<4&240|s>>2),64!=a&&e(s<<6&192|a))}}(r,function(t){i.push(t)}),i);for(t=[],n=e=0;e<o.length;){var s=o[e++];if(128>s)t[n++]=String.fromCharCode(s);else if(191<s&&224>s){var a=o[e++];t[n++]=String.fromCharCode((31&s)<<6|63&a)}else if(239<s&&365>s){a=o[e++];var u=o[e++],c=o[e++],h=((7&s)<<18|(63&a)<<12|(63&u)<<6|63&c)-65536;t[n++]=String.fromCharCode(55296+(h>>10)),t[n++]=String.fromCharCode(56320+(1023&h))}else a=o[e++],u=o[e++],t[n++]=String.fromCharCode((15&s)<<12|(63&a)<<6|63&u)}return JSON.parse(t.join(""))}catch(t){}return null}r2.prototype.T=function(){return this.f},r2.prototype.l=function(){return this.c},r2.prototype.toString=function(){return this.h};var r6="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),r5=["client_id","response_type","scope","redirect_uri","state"],r8={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:r5},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:r5},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:r5},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:r6},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function r7(t){for(var e in r8)if(r8[e].fa==t)return r8[e];return null}function r9(t){var e={};e["facebook.com"]=io,e["google.com"]=ia,e["github.com"]=is,e["twitter.com"]=iu;var n=t&&t[ie];try{if(n)return e[n]?new e[n](t):new ii(t);if(void 0!==t[it])return new ir(t)}catch(t){}return null}var it="idToken",ie="providerId";function ir(t){var e=t[ie];if(!e&&t[it]){var n=r4(t[it]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");("anonymous"==e||"custom"==e)&&(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),rh(this,"providerId",e),rh(this,"isNewUser",n)}function ii(t){ir.call(this,t),rh(this,"profile",rd((t=n9(t.rawUserInfo||"{}"))||{}))}function io(t){if(ii.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function is(t){if(ii.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");rh(this,"username",this.profile&&this.profile.login||null)}function ia(t){if(ii.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function iu(t){if(ii.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");rh(this,"username",t.screenName||null)}function ic(t){var e=nf(t),n=nl(e,"link"),r=nl(nf(n),"link");return e=nl(e,"deep_link_id"),nl(nf(e),"link")||e||r||n||t}function ih(t,e){if(!t&&!e)throw new k("internal-error","Internal assert: no raw session string available");if(t&&e)throw new k("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?il:id}S(ii,ir),S(io,ii),S(is,ii),S(ia,ii),S(iu,ii);var il="enroll",id="signin";function ip(){}function iv(t,e){return t.then(function(t){if(t[o1]){var n=r4(t[o1]);if(!n||e!=n.i)throw new k("user-mismatch");return t}throw new k("user-mismatch")}).o(function(t){throw t&&t.code&&t.code==A+"user-not-found"?new k("user-mismatch"):t})}function ig(t,e){if(e)this.a=e;else throw new k("internal-error","failed to construct a credential");rh(this,"providerId",t),rh(this,"signInMethod",t)}function im(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function iy(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new ig(t.providerId,t.pendingToken)}catch(t){}return null}function i_(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&rh(this,"idToken",e.idToken),e.accessToken&&rh(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&rh(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else if(e.oauthToken&&e.oauthTokenSecret)rh(this,"accessToken",e.oauthToken),rh(this,"secret",e.oauthTokenSecret);else throw new k("internal-error","failed to construct a credential");rh(this,"providerId",t),rh(this,"signInMethod",n)}function ib(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:nE(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function iw(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new i_(t.providerId,e,t.signInMethod)}catch(t){}}return null}function iI(t,e){this.Qc=e||[],rl(this,{providerId:t,isOAuthProvider:!0}),this.Jb={},this.qb=(r7(t)||{}).Ja||null,this.pb=null}function iT(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new k("argument-error",'SAML provider IDs must be prefixed with "saml."');iI.call(this,t,[])}function iE(t){iI.call(this,t,r5),this.a=[]}function iS(){iE.call(this,"facebook.com")}function iC(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new iS).credential({accessToken:e})}function ik(){iE.call(this,"github.com")}function iN(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new ik).credential({accessToken:e})}function iA(){iE.call(this,"google.com"),this.Ca("profile")}function iR(t,e){var n=t;return v(t)&&(n=t.idToken,e=t.accessToken),(new iA).credential({idToken:n,accessToken:e})}function ix(){iI.call(this,"twitter.com",r6)}function iP(t,e){var n=t;if(v(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new k("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new i_("twitter.com",n,"twitter.com")}function iD(t,e,n){this.a=t,this.f=e,rh(this,"providerId","password"),rh(this,"signInMethod",n===iL.EMAIL_LINK_SIGN_IN_METHOD?iL.EMAIL_LINK_SIGN_IN_METHOD:iL.EMAIL_PASSWORD_SIGN_IN_METHOD)}function iO(t){return t&&t.email&&t.password?new iD(t.email,t.password,t.signInMethod):null}function iL(){rl(this,{providerId:"password",isOAuthProvider:!1})}function iM(t,e){if(!(e=iF(e)))throw new k("argument-error","Invalid email link!");return new iD(t,e.code,iL.EMAIL_LINK_SIGN_IN_METHOD)}function iF(t){return(t=rK(t=ic(t)))&&t.operation===rT?t:null}function iU(t){if(!(t.fb&&t.eb||t.La&&t.ea))throw new k("internal-error");this.a=t,rh(this,"providerId","phone"),this.fa="phone",rh(this,"signInMethod","phone")}function ij(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return K(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new iU(e)}return null}function iq(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.fb,code:t.a.eb}}function iV(t){try{this.a=t||eR.auth()}catch(t){throw new k("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}rl(this,{providerId:"phone",isOAuthProvider:!1})}function iB(t,e){if(!t)throw new k("missing-verification-id");if(!e)throw new k("missing-verification-code");return new iU({fb:t,eb:e})}function iK(t){if(t.temporaryProof&&t.phoneNumber)return new iU({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,s=t&&t.pendingToken;try{switch(e){case"google.com":return iR(o,n);case"facebook.com":return iC(n);case"github.com":return iN(n);case"twitter.com":return iP(n,r);default:return n||r||o||s?s?0==e.indexOf("saml.")?new ig(e,s):new i_(e,{pendingToken:s,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new iE(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function iW(t){if(!t.isOAuthProvider)throw new k("invalid-oauth-provider")}function iH(t,e,n,r,i,o,s){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=s||null,this.a=i||null,this.g||this.a){if(this.g&&this.a||this.g&&!this.f)throw new k("invalid-auth-event")}else throw new k("invalid-auth-event")}function iz(t){return(t=t||{}).type?new iH(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&N(t.error),t.postBody,t.tenantId):null}function iG(){this.b=null,this.a=[]}ih.prototype.Ha=function(){return this.a?eh(this.a):eh(this.b)},ih.prototype.w=function(){return this.type==il?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},ip.prototype.ka=function(){},ip.prototype.b=function(){},ip.prototype.c=function(){},ip.prototype.w=function(){},ig.prototype.ka=function(t){return sd(t,im(this))},ig.prototype.b=function(t,e){var n=im(this);return n.idToken=e,sp(t,n)},ig.prototype.c=function(t,e){return iv(sv(t,im(this)),e)},ig.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},i_.prototype.ka=function(t){return sd(t,ib(this))},i_.prototype.b=function(t,e){var n=ib(this);return n.idToken=e,sp(t,n)},i_.prototype.c=function(t,e){return iv(sv(t,ib(this)),e)},i_.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},iI.prototype.Ka=function(t){return this.Jb=td(t),this},S(iT,iI),S(iE,iI),iE.prototype.Ca=function(t){return G(this.a,t)||this.a.push(t),this},iE.prototype.Rb=function(){return X(this.a)},iE.prototype.credential=function(t,e){var n;if(!(n=v(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new k("argument-error","credential failed: must provide the ID token and/or the access token.");return new i_(this.providerId,n,this.providerId)},S(iS,iE),rh(iS,"PROVIDER_ID","facebook.com"),rh(iS,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(ik,iE),rh(ik,"PROVIDER_ID","github.com"),rh(ik,"GITHUB_SIGN_IN_METHOD","github.com"),S(iA,iE),rh(iA,"PROVIDER_ID","google.com"),rh(iA,"GOOGLE_SIGN_IN_METHOD","google.com"),S(ix,iI),rh(ix,"PROVIDER_ID","twitter.com"),rh(ix,"TWITTER_SIGN_IN_METHOD","twitter.com"),iD.prototype.ka=function(t){return this.signInMethod==iL.EMAIL_LINK_SIGN_IN_METHOD?s$(t,sT,{email:this.a,oobCode:this.f}):s$(t,sH,{email:this.a,password:this.f})},iD.prototype.b=function(t,e){return this.signInMethod==iL.EMAIL_LINK_SIGN_IN_METHOD?s$(t,sE,{idToken:e,email:this.a,oobCode:this.f}):s$(t,sF,{idToken:e,email:this.a,password:this.f})},iD.prototype.c=function(t,e){return iv(this.ka(t),e)},iD.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},rl(iL,{PROVIDER_ID:"password"}),rl(iL,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),rl(iL,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),iU.prototype.ka=function(t){return t.gb(iq(this))},iU.prototype.b=function(t,e){var n=iq(this);return n.idToken=e,s$(t,sG,n)},iU.prototype.c=function(t,e){var n=iq(this);return n.operation="REAUTH",iv(t=s$(t,sQ,n),e)},iU.prototype.w=function(){var t={providerId:"phone"};return this.a.fb&&(t.verificationId=this.a.fb),this.a.eb&&(t.verificationCode=this.a.eb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},iV.prototype.gb=function(t,e){var n=this.a.a;return eh(e.verify()).then(function(r){if("string"!=typeof r)throw new k("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");if("recaptcha"===e.type){var i=v(t)?t.session:null,o=v(t)?t.phoneNumber:t;return(i&&i.type==il?i.Ha().then(function(t){return s$(n,sj,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}}).then(function(t){return t.phoneSessionInfo.sessionInfo})}):i&&i.type==id?i.Ha().then(function(e){return s$(n,sq,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}}).then(function(t){return t.phoneResponseInfo.sessionInfo})}):s$(n,sL,{phoneNumber:o,recaptchaToken:r})).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t})}throw new k("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')})},rl(iV,{PROVIDER_ID:"phone"}),rl(iV,{PHONE_SIGN_IN_METHOD:"phone"}),iH.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},iH.prototype.T=function(){return this.h},iH.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var iQ=null;function iY(t){var e="unauthorized-domain",n=void 0,r=nf(t);t=r.a,"chrome-extension"==(r=r.c)?n=tq("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=tq("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",k.call(this,e,n)}function i$(t,e,n){k.call(this,t,n),(t=e||{}).Kb&&rh(this,"email",t.Kb),t.ea&&rh(this,"phoneNumber",t.ea),t.credential&&rh(this,"credential",t.credential),t.$b&&rh(this,"tenantId",t.$b)}function iX(t){if(t.code){var e=t.code||"";0==e.indexOf(A)&&(e=e.substring(A.length));var n={credential:iK(t),$b:t.tenantId};if(t.email)n.Kb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new k(e,t.message||void 0);return new i$(e,n,t.message)}return null}function iJ(){}function iZ(t){return t.c||(t.c=t.b())}function i0(){}function i1(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function i2(){}function i4(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=I(this.qc,this),this.a.onerror=I(this.Tb,this),this.a.onprogress=I(this.rc,this),this.a.ontimeout=I(this.vc,this)}function i3(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function i6(t,e,n){this.reset(t,e,n,void 0,void 0)}S(iY,k),S(i$,k),i$.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&tv(t,e),t},i$.prototype.toJSON=function(){return this.w()},iJ.prototype.c=null,S(i0,iJ),i0.prototype.a=function(){var t=i1(this);return t?new ActiveXObject(t):new XMLHttpRequest},i0.prototype.b=function(){var t={};return i1(this)&&(t[0]=!0,t[1]=!0),t},oZ=new i0,S(i2,iJ),i2.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new i4;throw Error("Unsupported browser")},i2.prototype.b=function(){return{}},(n=i4.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},n.send=function(t){if(t){if("string"==typeof t)this.a.send(t);else throw Error("Only string data is supported")}else this.a.send()},n.abort=function(){this.a.abort()},n.setRequestHeader=function(){},n.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},n.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,i3(this,4)},n.Tb=function(){this.status=500,this.response=this.responseText="",i3(this,4)},n.vc=function(){this.Tb()},n.rc=function(){this.status=200,i3(this,1)},n.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},i6.prototype.a=null;var i5=0;function i8(t){this.f=t,this.b=this.c=this.a=null}function i7(t,e){this.name=t,this.value=e}i6.prototype.reset=function(t,e,n,r,i){"number"==typeof i||i5++,r||E(),delete this.a},i7.prototype.toString=function(){return this.name};var i9=new i7("SEVERE",1e3),ot=new i7("WARNING",900),oe=new i7("CONFIG",700),on=new i7("FINE",500);i8.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(M("Root logger has no level set."),null)}(this).value)for(p(e)&&(e=e()),t=new i6(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var or={},oi=null;function oo(t){if(oi||(oi=new i8(""),or[""]=oi,oi.c=oe),!(e=or[t])){e=new i8(t);var e,n=t.lastIndexOf("."),r=t.substr(n+1);(n=oo(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,or[t]=e}return e}function os(t,e){t&&t.log(on,e,void 0)}function oa(t){this.f=t}function ou(t){e3.call(this),this.u=t,this.h=void 0,this.readyState=oc,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=oo("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}S(oa,iJ),oa.prototype.a=function(){return new ou(this.f)},oa.prototype.b=(oW={},function(){return oW}),S(ou,e3);var oc=0;function oh(t){t.c.read().then(t.pc.bind(t)).catch(t.Va.bind(t))}function ol(t){t.readyState=4,t.g=null,t.c=null,t.m=null,of(t)}function of(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function od(t){e3.call(this),this.headers=new nn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=op,this.u=this.S=!1}(n=ou.prototype).open=function(t,e){if(this.readyState!=oc)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,of(this)},n.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Va.bind(this))},n.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ol(this)),this.readyState=oc},n.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,of(this)),this.a&&(this.readyState=3,of(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):void 0!==a.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,oh(this)):t.text().then(this.tc.bind(this),this.Va.bind(this)))))},n.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?ol(this):of(this),3==this.readyState&&oh(this)}},n.tc=function(t){this.a&&(this.response=this.responseText=t,ol(this))},n.sc=function(t){this.a&&(this.response=t,ol(this))},n.Va=function(t){var e=this.i;e&&e.log(ot,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&ol(this)},n.setRequestHeader=function(t,e){this.l.append(t,e)},n.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(ot,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},n.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(ot,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ou.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),S(od,e3);var op="";od.prototype.b=oo("goog.net.XhrIo");var ov=/^https?$/i,og=["POST","PUT"];function om(t){return"content-type"==t.toLowerCase()}function oy(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,o_(t),ow(t)}function o_(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ob(t){if(t.c&&void 0!==s){if(t.C[1]&&4==oT(t)&&2==oE(t))os(t.b,oS(t,"Local request error detected and ignored"));else if(t.i&&4==oT(t))e7(t.Wb,0,t);else if(t.dispatchEvent("readystatechange"),4==oT(t)){os(t.b,oS(t,"Request complete")),t.c=!1;try{var e,n,r=oE(t);t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){if(n=0===r){var o=String(t.l).match(no)[1]||null;if(!o&&a.self&&a.self.location){var u=a.self.location.protocol;o=u.substr(0,u.length-1)}n=!ov.test(o?o.toLowerCase():"")}e=n}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<oT(t)?t.a.statusText:""}catch(e){os(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+oE(t)+"]",o_(t)}}finally{ow(t)}}}}function ow(t,e){if(t.a){oI(t);var n=t.a,r=t.C[0]?l:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(i9,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function oI(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(a.clearTimeout(t.s),t.s=null)}function oT(t){return t.a?t.a.readyState:0}function oE(t){try{return 2<oT(t)?t.a.status:-1}catch(t){return -1}}function oS(t,e){return e+" ["+t.P+" "+t.l+" "+oE(t)+"]"}function oC(t){this.g=[],this.u=oF,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function ok(t,e,n){t.a=!0,t.c=n,t.f=!e,ox(t)}function oN(t){if(t.a){if(!t.v)throw new oP(t);t.v=!1}}function oA(t,e,n,r){t.g.push([e,n,r]),t.a&&ox(t)}function oR(t){return z(t.g,function(t){return p(t[1])})}function ox(t){if(t.h&&t.a&&oR(t)){var e=t.h,n=oL[e];n&&(a.clearTimeout(n.a),delete oL[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],s=i[1];if(i=i[2],o=t.f?s:o)try{var u=o.call(i||t.s,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(D(e)||"function"==typeof a.Promise&&e instanceof a.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,oR(t)||(n=!0)}}t.c=e,r&&(u=I(t.m,t,!0),r=I(t.m,t,!1),e instanceof oC?(oA(e,u,r),e.C=!0):e.then(u,r)),n&&(oL[(e=new oO(e)).a]=e,t.h=e.a)}function oP(){O.call(this)}function oD(){O.call(this)}function oO(t){this.a=a.setTimeout(I(this.c,this),0),this.b=t}(n=od.prototype).Ma=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",os(this.b,oS(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},n.abort=function(){this.a&&this.c&&(os(this.b,oS(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ow(this))},n.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ow(this,!0)),od.bb.Da.call(this)},n.Wb=function(){this.ya||(this.N||this.i||this.f?ob(this):this.Jc())},n.Jc=function(){ob(this)},n.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case op:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(i9,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return os(this.b,"Can not get response: "+t.message),null}},oC.prototype.cancel=function(t){if(this.a)this.c instanceof oC&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new oD(this),oN(this),ok(this,!1,t))}},oC.prototype.m=function(t,e){this.i=!1,ok(this,t,e)},oC.prototype.then=function(t,e,n){var r,i,o=new er(function(t,e){r=t,i=e});return oA(this,r,function(t){t instanceof oD?o.cancel():i(t)}),o.then(t,e,n)},oC.prototype.$goog_Thenable=!0,S(oP,O),oP.prototype.message="Deferred has already fired",oP.prototype.name="AlreadyCalledError",S(oD,O),oD.prototype.message="Deferred was canceled",oD.prototype.name="CanceledError",oO.prototype.c=function(){throw delete oL[this.a],this.b};var oL={};function oM(t){var e,n,r={},i=r.document||document,o=tT(t).toString(),s=t8(document,"SCRIPT"),u={Xb:s,Ma:void 0},l=new oC(u),f=null,d=null!=r.timeout?r.timeout:5e3;return 0<d&&(f=window.setTimeout(function(){oU(s,!0);var t=new oV(oq,"Timeout reached for loading script "+o);oN(l),ok(l,!1,t)},d),u.Ma=f),s.onload=s.onreadystatechange=function(){s.readyState&&"loaded"!=s.readyState&&"complete"!=s.readyState||(oU(s,r.xd||!1,f),oN(l),ok(l,!0,null))},s.onerror=function(){oU(s,!0,f);var t=new oV(oj,"Error while loading script "+o);oN(l),ok(l,!1,t)},tv(u=r.attributes||{},{type:"text/javascript",charset:"UTF-8"}),t6(s,u),n=t,tg(s,"HTMLScriptElement"),s.src=tT(n),(n=s.ownerDocument&&s.ownerDocument.defaultView)&&n!=a?n=h(n.document):(null===c&&(c=h(a.document)),n=c),n&&s.setAttribute("nonce",n),((e=(i||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:i.documentElement).appendChild(s),l}function oF(){if(this&&this.Xb){var t=this.Xb;t&&"SCRIPT"==t.tagName&&oU(t,!0,this.Ma)}}function oU(t,e,n){null!=n&&a.clearTimeout(n),t.onload=l,t.onerror=l,t.onreadystatechange=l,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var oj=0,oq=1;function oV(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),O.call(this,n),this.code=t}function oB(t){this.f=t}function oK(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||o2,this.g=td(t.secureTokenHeaders||o4),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||o3,this.a=td(t.firebaseHeaders||o6),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==nG(),!(n=a.XMLHttpRequest||n&&eR.INTERNAL.node&&eR.INTERNAL.node.XMLHttpRequest)&&!nz())throw new k("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,nz()?this.f=new oa(self):nQ()?this.f=new oB(n):this.f=new i2,this.b=null}S(oV,O),S(oB,iJ),oB.prototype.a=function(){return new this.f},oB.prototype.b=function(){return{}};var oW,oH,oz,oG,oQ,oY,o$,oX,oJ,oZ,o0,o1="idToken",o2=new rr(3e4,6e4),o4={"Content-Type":"application/x-www-form-urlencoded"},o3=new rr(3e4,6e4),o6={"Content-Type":"application/json"};function o5(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function o8(t,e){e&&(t.l=o7("https://securetoken.googleapis.com/v1/token",e),t.h=o7("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=o7("https://identitytoolkit.googleapis.com/v2/",e))}function o7(t,e){return t=nf(t),e=nf(e.url),t.f=t.a+t.f,na(t,e.c),t.a=e.a,nu(t,e.g),t.toString()}function o9(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function st(t,e,n,r,i,o,s){var u;(!(u=nX(u=n0())!=n$?null:(u=u.match(/\sChrome\/(\d+)/i))&&2==u.length?parseInt(u[1],10):null)||!(30>u))&&(!tW||!t2||9<t2)||nz()?t=I(t.u,t):(o0||(o0=new er(function(t,e){var n,r;n=t,r=e,((window.gapi||{}).client||{}).request?n():(a[sn]=function(){((window.gapi||{}).client||{}).request?n():r(Error("CORS_UNSUPPORTED"))},oA(oM(tE(se,{onload:sn})),null,function(){r(Error("CORS_UNSUPPORTED"))},void 0))})),t=I(t.s,t)),t(e,n,r,i,o,s)}oK.prototype.T=function(){return this.b},oK.prototype.u=function(t,e,n,r,i,o){if(nz()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new k("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new od(this.f);if(o){s.g=Math.max(0,o);var u=setTimeout(function(){s.dispatchEvent("timeout")},o)}e6(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return os(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)}),e5(s,"ready",function(){u&&clearTimeout(u),ek(this)}),e5(s,"timeout",function(){u&&clearTimeout(u),ek(this),e&&e(null)}),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():oZ.a(),t.C=t.D?iZ(t.D):iZ(oZ),t.a.onreadystatechange=I(t.Wb,t);try{os(t.b,oS(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(e){os(t.b,oS(t,"Error opening Xhr: "+e.message)),oy(t,e);return}e=r||"";var o,s=new nn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)K(t,e,void 0);else for(var n=ne(t),r=nt(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,function(t,e){s.set(e,t)}),i=function(t){t:{for(var e=om,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(s.Y()),r=a.FormData&&e instanceof a.FormData,!G(og,n)||i||r||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{oI(t),0<t.g&&(t.u=(o=t.a,tW&&t1(9)&&"number"==typeof o.timeout&&void 0!==o.ontimeout),os(t.b,oS(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=I(t.Ma,t)):t.s=e7(t.Ma,t.g,t)),os(t.b,oS(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){os(t.b,oS(t,"Send error: "+e.message)),oy(t,e)}}(s,t,n,r,i)};var se=new tm(tb,"https://apis.google.com/js/client.js?onload=%{onload}"),sn="__fcb"+Math.floor(1e6*Math.random()).toString();function sr(t,e,n,r,i,o,s){var a=nf(e+n);nh(a,"key",t.c),s&&nh(a,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&nh(a,c,i[c]);return new er(function(e,n){st(t,a.toString(),function(t){t?t.error?n(sJ(t,o||{})):e(t):n(new k("network-request-failed"))},r,u?void 0:nR(n7(i)),t.a,t.v.get())})}function si(t){if("string"!=typeof(t=t.email)||!nB.test(t))throw new k("invalid-email")}function so(t){"email"in t&&si(t)}function ss(t){if(!t[o1]){if(t.mfaPendingCredential)throw new k("multi-factor-auth-required",null,td(t));throw new k("internal-error")}}function sa(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new k("internal-error")}else{if(!t.sessionInfo)throw new k("missing-verification-id");if(!t.code)throw new k("missing-verification-code")}}oK.prototype.s=function(t,e,n,r,i){var o=this;o0.then(function(){window.gapi.client.setApiKey(o.c);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(s),e&&e(t)}})}).o(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},oK.prototype.Ab=function(){return s$(this,sU,{})},oK.prototype.Cb=function(t,e){return s$(this,sM,{idToken:t,email:e})},oK.prototype.Db=function(t,e){return s$(this,sF,{idToken:t,password:e})};var su={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function sc(t){if(!t.phoneVerificationInfo)throw new k("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new k("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new k("missing-verification-code")}function sh(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new k("internal-error")}function sl(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&nC(t=new nI(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function sf(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=iX(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=iX(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=iX(t)):t.errorMessage&&(e=sX(t.errorMessage)),e)throw e;ss(t)}function sd(t,e){return e.returnIdpCredential=!0,s$(t,sV,e)}function sp(t,e){return e.returnIdpCredential=!0,s$(t,sK,e)}function sv(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,s$(t,sB,e)}function sg(t){if(!t.oobCode)throw new k("invalid-action-code")}(n=oK.prototype).Eb=function(t,e){var n={idToken:t},r=[];return tl(su,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),s$(this,sM,n)},n.wb=function(t,e){return tv(t={requestType:"PASSWORD_RESET",email:t},e),s$(this,sx,t)},n.xb=function(t,e){return tv(t={requestType:"EMAIL_SIGNIN",email:t},e),s$(this,sN,t)},n.vb=function(t,e){return tv(t={requestType:"VERIFY_EMAIL",idToken:t},e),s$(this,sA,t)},n.Fb=function(t,e,n){return tv(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),s$(this,sR,t)},n.gb=function(t){return s$(this,sz,t)},n.ob=function(t,e){return s$(this,sO,{oobCode:t,newPassword:e})},n.Sa=function(t){return s$(this,sy,{oobCode:t})},n.kb=function(t){return s$(this,sm,{oobCode:t})};var sm={endpoint:"setAccountInfo",A:sg,Z:"email",B:!0},sy={endpoint:"resetPassword",A:sg,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new k("internal-error")},B:!0},s_={endpoint:"signupNewUser",A:function(t){if(si(t),!t.password)throw new k("weak-password")},G:ss,V:!0,B:!0},sb={endpoint:"createAuthUri",B:!0},sw={endpoint:"deleteAccount",O:["idToken"]},sI={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new k("internal-error")}},sT={endpoint:"emailLinkSignin",O:["email","oobCode"],A:si,G:ss,V:!0,B:!0},sE={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:si,G:ss,V:!0},sS={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:sc,G:ss,B:!0,Na:!0},sC={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:sc,G:ss,B:!0,Na:!0},sk={endpoint:"getAccountInfo"},sN={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new k("internal-error");si(t)},Z:"email",B:!0},sA={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},sR={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},sx={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new k("internal-error");si(t)},Z:"email",B:!0},sP={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},sD={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new k("internal-error")}},sO={endpoint:"resetPassword",A:sg,Z:"email",B:!0},sL={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},sM={endpoint:"setAccountInfo",O:["idToken"],A:so,V:!0},sF={endpoint:"setAccountInfo",O:["idToken"],A:function(t){if(so(t),!t.password)throw new k("weak-password")},G:ss,V:!0},sU={endpoint:"signupNewUser",G:ss,V:!0,B:!0},sj={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new k("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new k("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},sq={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},sV={endpoint:"verifyAssertion",A:sh,Za:sl,G:sf,V:!0,B:!0},sB={endpoint:"verifyAssertion",A:sh,Za:sl,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new k("user-not-found");if(t.errorMessage)throw sX(t.errorMessage);ss(t)},V:!0,B:!0},sK={endpoint:"verifyAssertion",A:function(t){if(sh(t),!t.idToken)throw new k("internal-error")},Za:sl,G:sf,V:!0},sW={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new k("invalid-custom-token")},G:ss,V:!0,B:!0},sH={endpoint:"verifyPassword",A:function(t){if(si(t),!t.password)throw new k("wrong-password")},G:ss,V:!0,B:!0},sz={endpoint:"verifyPhoneNumber",A:sa,G:ss,B:!0},sG={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new k("internal-error");sa(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",iX(t);ss(t)}},sQ={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:sa,G:ss,B:!0},sY={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[o1]^!!t.refreshToken)throw new k("internal-error")},B:!0,Na:!0};function s$(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.O))return el(new k("internal-error"));var r,i=!!e.Na,o=e.Vb||"POST";return eh(n).then(e.A).then(function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),i?sr(t,t.i,e.endpoint,o,n,e.Ib,e.mb||!1):sr(t,t.h,e.endpoint,o,n,e.Ib,e.mb||!1)}).then(function(t){return r=t,e.Za?e.Za(n,r):r}).then(e.G).then(function(){if(!e.Z)return r;if(!(e.Z in r))throw new k("internal-error");return r[e.Z]})}function sX(t){return sJ({error:{errors:[{message:t}],code:400,message:t}})}function sJ(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new k(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",tv(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new k(r[i],e);return!e&&t&&(e=n8(t)),new k("internal-error",e)}function sZ(t){var e;this.b=t,this.a=null,this.sb=(e=this,(s4||(s4=new er(function(t,e){function n(){rn(),n1("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){rn(),e(Error("Network Error"))},timeout:s1.get()})}if(n1("gapi.iframes.Iframe"))t();else if(n1("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[r]=function(){n1("gapi.load")?n():e(Error("Network Error"))},eh(oM(r=tE(s0,{onload:r}))).o(function(){e(Error("Network Error"))})}}).o(function(t){throw s4=null,t}))).then(function(){return new er(function(t,n){n1("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:n1("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},s2.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})}))}var s0=new tm(tb,"https://apis.google.com/js/api.js?onload=%{onload}"),s1=new rr(3e4,6e4),s2=new rr(5e3,15e3),s4=null;function s3(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?nd((t=nf(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):nd("https",this.l,null,"/__/auth/iframe"),this.a=t,nh(this.a,"apiKey",this.h),nh(this.a,"appName",this.i),this.b=null,this.c=[]}function s6(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function s5(t){try{return eR.app(t).auth().Ga()}catch(t){return[]}}function s8(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function s7(t){var e=nM();return s$(t,sP,{}).then(function(t){return t.authorizedDomains||[]}).then(function(t){t:{var n=nf(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],s=n;if(s=0==o.indexOf("chrome-extension://")?nf(o).a==s&&"chrome-extension"==r:("http"==r||"https"==r)&&(nV.test(o)?s==o:RegExp("^(.+\\."+(o=o.split(".").join("\\."))+"|"+o+")$","i").test(s))){t=!0;break t}}t=!1}if(!t)throw new iY(nM())})}function s9(t){return t.m||(t.m=nK().then(function(){if(!t.u){var e=t.c,n=t.i,r=s5(t.b),i=new s3(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=X(r||[]),t.u=i.toString()}t.v=new sZ(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.sb.then(function(){t.a.register("authEvent",e,n1("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.v,function(e){var n={};if(e&&e.authEvent){var r=!1;for(n=0,e=iz(e.authEvent);n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",eh(n)}return n.status="ERROR",eh(n)})}(t)})),t.m}function at(t){return t.l||(t.C=t.c?nZ(t.c,s5(t.b)):null,t.l=new oK(t.g,P(t.i),t.C),t.f&&o8(t.l,t.f)),t.l}function ae(t,e,n,r,i,o,s,a,u,c,h,l){return(t=new s6(t,e,n,r,i,l)).l=o,t.g=s,t.i=a,t.b=td(u||null),t.f=c,t.zb(h).toString()}function an(t){if(this.a=t||eR.INTERNAL.reactNative&&eR.INTERNAL.reactNative.AsyncStorage,!this.a)throw new k("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ar(t){this.b=t,this.a={},this.f=I(this.c,this)}s3.prototype.toString=function(){return this.f?nh(this.a,"v",this.f):nS(this.a.b,"v"),this.b?nh(this.a,"eid",this.b):nS(this.a.b,"eid"),this.c.length?nh(this.a,"fw",this.c.join(",")):nS(this.a.b,"fw"),this.a.toString()},s6.prototype.zb=function(t){return this.h=t,this},s6.prototype.toString=function(){if(this.v){var t=nf(this.v.url);t=nd(t.c,t.a,t.g,"/emulator/auth/handler")}else t=nd("https",this.u,null,"/__/auth/handler");if(nh(t,"apiKey",this.s),nh(t,"appName",this.c),nh(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=eR.app(this.c).auth().la()}catch(t){n=null}for(var r in e.pb=n,nh(t,"providerId",this.a.providerId),e=n7((n=this.a).Jb))e[r]=e[r].toString();r=n.Qc,e=td(e);for(var i=0;i<r.length;i++){var o=r[i];o in e&&delete e[o]}n.qb&&n.pb&&!e[n.qb]&&(e[n.qb]=n.pb),tf(e)||nh(t,"customParameters",n8(e))}if("function"==typeof this.a.Rb&&(n=this.a.Rb()).length&&nh(t,"scopes",n.join(",")),this.l?nh(t,"redirectUrl",this.l):nS(t.b,"redirectUrl"),this.g?nh(t,"eventId",this.g):nS(t.b,"eventId"),this.i?nh(t,"v",this.i):nS(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!nl(t,s)&&nh(t,s,this.b[s]);return this.h?nh(t,"tid",this.h):nS(t.b,"tid"),this.f?nh(t,"eid",this.f):nS(t.b,"eid"),(s=s5(this.c)).length&&nh(t,"fw",s.join(",")),t.toString()},(n=s8.prototype).Pb=function(t,e,n){var r=new k("popup-closed-by-user"),i=new k("web-storage-unsupported"),o=this,s=!1;return this.ma().then(function(){var n;(n={type:"webStorageSupport"},s9(o).then(function(){var t;return(t=o.v).sb.then(function(){return new er(function(e){t.a.send(n.type,n,e,n1("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})).then(function(n){n||(t&&nj(t),e(i),s=!0)})}).o(function(){}).then(function(){if(!s)return new er(function(e){return function n(){e9(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}).then(function(){if(!s)return e9(n).then(function(){e(r)})})},n.Yb=function(){var t=n0();return!n5(t)&&!re(t)},n.Ub=function(){return!1},n.Nb=function(t,e,n,r,i,o,s,a){if(!t)return el(new k("popup-blocked"));if(s&&!n5())return this.ma().o(function(e){nj(t),i(e)}),r(),eh();this.a||(this.a=s7(at(this)));var u=this;return this.a.then(function(){var e=u.ma().o(function(e){throw nj(t),i(e),e});return r(),e}).then(function(){iW(n),s||nF(ae(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,a,u.f),t)}).o(function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t})},n.Ob=function(t,e,n,r){this.a||(this.a=s7(at(this)));var i=this;return this.a.then(function(){iW(e),nF(ae(i.s,i.g,i.b,t,e,nM(),n,i.c,void 0,i.i,r,i.f))}).o(function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t})},n.ma=function(){var t=this;return s9(this).then(function(){return t.v.sb}).o(function(){throw t.a=null,new k("network-request-failed")})},n.ac=function(){return!0},n.Ea=function(t){this.h.push(t)},n.Ta=function(t){Y(this.h,function(e){return e==t})},(n=an.prototype).get=function(t){return eh(this.a.getItem(t)).then(function(t){return t&&n9(t)})},n.set=function(t,e){return eh(this.a.setItem(t,n8(e)))},n.U=function(t){return eh(this.a.removeItem(t))},n.ca=function(){},n.ia=function(){};var ai=[];function ao(t,e,n){tf(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function as(t){this.a=t}function aa(t){this.c=t,this.b=!1,this.a=[]}function au(t,e,n,r){var i,o,s,a,u=n||{},c=null;if(t.b)return el(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new er(function(n,r){l?(i=Math.floor(1e20*Math.random()).toString(),l.port1.start(),s=setTimeout(function(){r(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(s),a=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(a),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))}).then(function(e){return ac(t,c),e}).o(function(e){throw ac(t,c),e})}function ac(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),Y(t.a,function(t){return t==e})}}function ah(){if(!ad())throw new k("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=a.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t,e=this;nz()&&self?(this.v=function(){var t=nz()?self:null;if(K(ai,function(n){n.b==t&&(e=n)}),!e){var e=new ar(t);ai.push(e)}return e}(),ao(this.v,"keyChanged",function(t,n){return ay(e).then(function(t){return 0<t.length&&K(e.a,function(e){e(t)}),{keyProcessed:G(t,n.key)}})}),ao(this.v,"ping",function(){return eh(["keyChanged"])})):((t=a.navigator)&&t.serviceWorker?eh().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).o(function(){return null}):eh(null)).then(function(t){(e.h=t)&&(e.g=new aa(new as(t)),au(e.g,"ping",null,!0).then(function(t){t[0].fulfilled&&G(t[0].value,"keyChanged")&&(e.s=!0)}).o(function(){}))})}function al(t){return t.i||(t.i=function t(e){return new er(function(n,r){var i=e.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(t){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){r(t)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):new er(function(t,n){var r=e.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()},r.onerror=function(t){n(Error(t.target.error))}}).then(function(){return t(e)}).then(function(t){n(t)}).o(function(t){r(t)})}})}(t)),t.i}function af(t,e){var n=0;return new er(function r(i,o){al(t).then(e).then(i).o(function(e){if(!(3<++n))return al(t).then(function(e){return e.close(),t.i=void 0,r(i,o)}).o(function(t){o(t)});o(e)})})}function ad(){try{return!!a.indexedDB}catch(t){return!1}}function ap(t){return t.objectStore("firebaseLocalStorage")}function av(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function ag(t){return new er(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function am(t,e){var n;return t.g&&t.h&&((n=a.navigator)&&n.serviceWorker&&n.serviceWorker.controller||null)===t.h?au(t.g,"keyChanged",{key:e},t.s).then(function(){}).o(function(){}):eh()}function ay(t){return al(t).then(function(t){var e=ap(av(t,!1));return e.getAll?ag(e.getAll()):new er(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r})}function a_(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function ab(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=eh().then(function(){if(ad()){var t=rt(),r="__sak"+t;return aN||(aN=new ah),(n=aN).set(r,t).then(function(){return n.get(r)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)}).then(function(){return n}).o(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.ca(function(t){K(e.a,function(e){e(t)})}),t})}function aw(){this.a={},this.type="inMemory"}function aI(){if(!function(){var t="Node"==nG();if(!(t=aT()||t&&eR.INTERNAL.node&&eR.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==nG())throw new k("internal-error","The LocalStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=aT()||eR.INTERNAL.node.localStorage,this.type="localStorage"}function aT(){try{var t=a.localStorage,e=rt();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function aE(){this.type="nullStorage"}function aS(){if(!function(){var t="Node"==nG();if(!(t=aC()||t&&eR.INTERNAL.node&&eR.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==nG())throw new k("internal-error","The SessionStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=aC()||eR.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function aC(){try{var t=a.sessionStorage,e=rt();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function ak(){var t={};t.Browser=aR,t.Node=ax,t.ReactNative=aP,t.Worker=aD,this.a=t[nG()]}ar.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];K(r,function(e){i.push(eh().then(function(){return e(t.origin,t.data.data)}))}),ed(i).then(function(r){var i=[];K(r,function(t){i.push({fulfilled:t.Qb,value:t.value,reason:t.reason?t.reason.message:void 0})}),K(i,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})})}},as.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},aa.prototype.close=function(){for(;0<this.a.length;)ac(this,this.a[0]);this.b=!0},(n=ah.prototype).set=function(t,e){var n=this,r=!1;return af(this,function(e){return ag((e=ap(av(e,!0))).get(t))}).then(function(i){return af(n,function(o){if(o=ap(av(o,!0)),i)return i.value=e,ag(o.put(i));n.b++,r=!0;var s={};return s.fbase_key=t,s.value=e,ag(o.add(s))})}).then(function(){return n.c[t]=e,am(n,t)}).oa(function(){r&&n.b--})},n.get=function(t){return af(this,function(e){return ag(ap(av(e,!1)).get(t))}).then(function(t){return t&&t.value})},n.U=function(t){var e=this,n=!1;return af(this,function(r){return n=!0,e.b++,ag(ap(av(r,!0)).delete(t))}).then(function(){return delete e.c[t],am(e,t)}).oa(function(){n&&e.b--})},n.ca=function(t){var e;0==this.a.length&&(e=this,a_(e),function t(){e.f=setTimeout(function(){e.l=ay(e).then(function(t){0<t.length&&K(e.a,function(e){e(t)})}).then(function(){t()}).o(function(e){"STOP_EVENT"!=e.message&&t()})},800)}()),this.a.push(t)},n.ia=function(t){Y(this.a,function(e){return e==t}),0==this.a.length&&a_(this)},(n=ab.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},n.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},n.U=function(t){return this.b.then(function(e){return e.U(t)})},n.ca=function(t){this.a.push(t)},n.ia=function(t){Y(this.a,function(e){return e==t})},(n=aw.prototype).get=function(t){return eh(this.a[t])},n.set=function(t,e){return this.a[t]=e,eh()},n.U=function(t){return delete this.a[t],eh()},n.ca=function(){},n.ia=function(){},(n=aI.prototype).get=function(t){var e=this;return eh().then(function(){return n9(e.a.getItem(t))})},n.set=function(t,e){var n=this;return eh().then(function(){var r=n8(e);null===r?n.U(t):n.a.setItem(t,r)})},n.U=function(t){var e=this;return eh().then(function(){e.a.removeItem(t)})},n.ca=function(t){a.window&&ez(a.window,"storage",t)},n.ia=function(t){a.window&&eY(a.window,"storage",t)},(n=aE.prototype).get=function(){return eh(null)},n.set=function(){return eh()},n.U=function(){return eh()},n.ca=function(){},n.ia=function(){},(n=aS.prototype).get=function(t){var e=this;return eh().then(function(){return n9(e.a.getItem(t))})},n.set=function(t,e){var n=this;return eh().then(function(){var r=n8(e);null===r?n.U(t):n.a.setItem(t,r)})},n.U=function(t){var e=this;return eh().then(function(){e.a.removeItem(t)})},n.ca=function(){},n.ia=function(){};var aN,aA,aR={F:aI,cb:aS},ax={F:aI,cb:aS},aP={F:an,cb:aE},aD={F:aI,cb:aE},aO={rd:"local",NONE:"none",td:"session"};function aL(){var t=!!(!re(n0())&&nH()),e=n5(),n=n2();this.m=t,this.h=e,this.l=n,this.a={},aA||(aA=new ak),t=aA;try{this.g=!nL()&&rs()||!a.indexedDB?new t.a.F:new ab(nz()?new aw:new t.a.F)}catch(t){this.g=new aw,this.h=!0}try{this.i=new t.a.cb}catch(t){this.i=new aw}this.v=new aw,this.f=I(this.Zb,this),this.b={}}function aM(){return t||(t=new aL),t}function aF(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function aU(t,e){return"firebase:"+t.name+(e?":"+e:"")}function aj(t,e,n){return n=aU(e,n),"local"==e.F&&(t.b[n]=null),aF(t,e.F).U(n)}function aq(t){t.c&&(clearInterval(t.c),t.c=null)}function aV(t){this.a=t,this.b=aM()}(n=aL.prototype).get=function(t,e){return aF(this,t.F).get(aU(t,e))},n.set=function(t,e,n){var r=aU(t,n),i=this,o=aF(this,t.F);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.F&&(i.b[r]=e)})},n.addListener=function(t,e,n){var r;t=aU(t,e),this.l&&(this.b[t]=a.localStorage.getItem(t)),tf(this.a)&&(aF(this,"local").ca(this.f),this.h||(nL()||!rs())&&a.indexedDB||!this.l||(r=this,aq(r),r.c=setInterval(function(){for(var t in r.a){var e=a.localStorage.getItem(t),n=r.b[t];e!=n&&(r.b[t]=e,e=new eO({type:"storage",key:t,target:window,oldValue:n,newValue:e,a:!0}),r.Zb(e))}},1e3))),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},n.removeListener=function(t,e,n){t=aU(t,e),this.a[t]&&(Y(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),tf(this.a)&&(aF(this,"local").ia(this.f),aq(this))},n.Zb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=a.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?aF(this,"local").ia(this.f):aq(this),this.m){if(n=a.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?a.localStorage.setItem(e,r):a.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return}var o=this;n=function(){(void 0!==t.a.a||o.b[e]!==a.localStorage.getItem(e))&&(o.b[e]=a.localStorage.getItem(e),o.nb(e))},tW&&t2&&10==t2&&a.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else K(t,I(this.nb,this))},n.nb=function(t){this.a[t]&&K(this.a[t],function(t){t()})};var aB={name:"authEvent",F:"local"};function aK(){this.a=aM()}function aW(t,n){this.b=aH,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=n,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0===e&&(e=a.Int32Array?new Int32Array(aJ):aJ),this.reset()}S(aW,function(){this.b=-1});for(var aH=64,az=aH-1,aG=[],aQ=0;aQ<az;aQ++)aG[aQ]=0;var aY=$(128,aG);function a$(t){for(var n=t.f,r=t.l,i=0,o=0;o<n.length;)r[i++]=n[o]<<24|n[o+1]<<16|n[o+2]<<8|n[o+3],o=4*i;for(n=16;64>n;n++){o=0|r[n-15],i=0|r[n-2];var s=(0|r[n-16])+((o>>>7|o<<25)^(o>>>18|o<<14)^o>>>3)|0,a=(0|r[n-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;r[n]=s+a|0}i=0|t.a[0],o=0|t.a[1];var u=0|t.a[2],c=0|t.a[3],h=0|t.a[4],l=0|t.a[5],f=0|t.a[6];for(n=0,s=0|t.a[7];64>n;n++){var d=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&o^i&u^o&u)|0;a=h&l^~h&f,a=(s=s+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))|0)+((a=a+(0|e[n])|0)+(0|r[n])|0)|0,s=f,f=l,l=h,h=c+a|0,c=u,u=o,o=i,i=a+d|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+o|0,t.a[2]=t.a[2]+u|0,t.a[3]=t.a[3]+c|0,t.a[4]=t.a[4]+h|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+f|0,t.a[7]=t.a[7]+s|0}function aX(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(a$(t),i=0);else if(d(e))for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(a$(t),i=0)}else throw Error("message must be string or array");t.c=i,t.g+=n}aW.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):X(this.h)};var aJ=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function aZ(){aW.call(this,8,a0)}S(aZ,aW);var a0=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function a1(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new aK,this.g=new aV(this.h),this.f=null,this.b=[],this.a=this.c=null}function a2(t){return new k("invalid-cordova-configuration",t)}function a4(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function a3(t){return t.f||(t.f=t.ma().then(function(){return new er(function(e){t.Ea(function n(r){return e(r),t.Ta(n),!1}),function(t){function e(e){o=!0,s&&s.cancel(),a6(t).then(function(n){var r=i;if(n&&e&&e.url){var o=null;-1!=(r=ic(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=n9(nl(o=nf(r),"firebaseError")||null))?N(o):null)?new iH(n.c,n.b,null,null,o,null,n.T()):new iH(n.c,n.b,r,n.f,null,null,n.T())),r=o||i}a4(t,r)})}var n,r,i=new iH("unknown",null,null,null,new k("no-auth-event")),o=!1,s=e9(500).then(function(){return a6(t).then(function(){o||a4(t,i)})}),u=a.handleOpenURL;a.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(n1("BuildInfo.packageName",a).toLowerCase()+"://")&&e({url:t}),"function"==typeof u)try{u(t)}catch(t){console.error(t)}},iQ||(iQ=new iG),n=e,(r=iQ).a.push(n),r.b||(r.b=function(t){for(var e=0;e<r.a.length;e++)r.a[e](t)},"function"==typeof(n=n1("universalLinks.subscribe",a))&&n(null,r.b))}(t)})})),t.f}function a6(t){var e,n=null;return(e=t.g).b.get(aB,e.a).then(function(t){return iz(t)}).then(function(e){return n=e,aj((e=t.g).b,aB,e.a)}).then(function(){return n})}function a5(t){this.a=t,this.b=aM()}(n=a1.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(nW(void 0)?nK().then(function(){return new er(function(t,e){var n=a.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):el(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof n1("universalLinks.subscribe",a))throw a2("cordova-universal-links-plugin-fix is not installed");if(void 0===n1("BuildInfo.packageName",a))throw a2("cordova-plugin-buildinfo is not installed");if("function"!=typeof n1("cordova.plugins.browsertab.openUrl",a))throw a2("cordova-plugin-browsertab is not installed");if("function"!=typeof n1("cordova.InAppBrowser.open",a))throw a2("cordova-plugin-inappbrowser is not installed")},function(){throw new k("cordova-not-ready")})},n.Pb=function(t,e){return e(new k("operation-not-supported-in-this-environment")),eh()},n.Nb=function(){return el(new k("operation-not-supported-in-this-environment"))},n.ac=function(){return!1},n.Yb=function(){return!0},n.Ub=function(){return!0},n.Ob=function(t,e,n,r){if(this.c)return el(new k("redirect-operation-pending"));var i=this,o=a.document,s=null,u=null,c=null,h=null;return this.c=eh().then(function(){return iW(e),a3(i)}).then(function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new iH(e,r,null,o,new k("no-auth-event"),null,i),u=n1("BuildInfo.packageName",a);if("string"!=typeof u)throw new k("invalid-cordova-configuration");var c=n1("BuildInfo.displayName",a),h={};if(n0().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=u;else{if(!n0().toLowerCase().match(/android/))return el(new k("operation-not-supported-in-this-environment"));h.apn=u}c&&(h.appDisplayName=c),o=function(t){var e=new aZ;aX(e,t),t=[];var n=8*e.g;56>e.c?aX(e,aY,56-e.c):aX(e,aY,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(a$(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return H(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(o),h.sessionId=o;var l=ae(t.v,t.i,t.l,e,n,null,r,t.m,h,t.u,i,t.s);return t.ma().then(function(){var e=t.h;return t.C.a.set(aB,s.w(),e)}).then(function(){var e=n1("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof e)throw new k("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=n1("cordova.plugins.browsertab.openUrl",a)))throw new k("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=n1("cordova.InAppBrowser.open",a)))throw new k("invalid-cordova-configuration");e=n0(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(i,t,e,n,r)}).then(function(){return new er(function(t,e){u=function(){var e=n1("cordova.plugins.browsertab.close",a);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),c=function(){s||(s=e9(2e3).then(function(){e(new k("redirect-cancelled-by-user"))}))},h=function(){ri()&&c()},o.addEventListener("resume",c,!1),n0().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)}).o(function(t){return a6(i).then(function(){throw t})})}).oa(function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),s&&s.cancel(),u&&i.Ta(u),i.c=null})},n.Ea=function(t){this.b.push(t),a3(this).o(function(e){"auth/invalid-cordova-configuration"===e.code&&t(e=new iH("unknown",null,null,null,new k("no-auth-event")))})},n.Ta=function(t){Y(this.b,function(e){return e==t})};var a8={name:"pendingRedirect",F:"session"};function a7(t){return aj(t.b,a8,t.a)}function a9(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=I(this.s,this),this.b=new up,this.C=new u_,this.g=new a5(uf(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=ut(this.D,this.v,this.m,oH,this.J)}function ut(t,e,n,r,i){var o=eR.SDK_VERSION||null;return nW()?new a1(t,e,n,o,r,i):new s8(t,e,n,o,r,i)}function ue(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o(function(n){throw t.a==e&&t.reset(),n})}function un(t){t.a.Yb()&&ue(t).o(function(e){var n=new iH("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));uu(e)&&t.s(n)}),t.a.Ub()||uv(t.b)}function ur(t,e){var n;G(t.h,e)||t.h.push(e),t.f||(n=t.g).b.get(a8,n.a).then(function(t){return"pending"==t}).then(function(e){e?a7(t.g).then(function(){ue(t).o(function(e){var n=new iH("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));uu(e)&&t.s(n)})}):un(t)}).o(function(){un(t)})}function ui(t,e){Y(t.h,function(t){return t==e})}a9.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=ut(this.D,this.v,this.m,null,this.J),this.i={}},a9.prototype.s=function(t){if(!t)throw new k("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return uv(this.b),e};var uo=new rr(2e3,1e4),us=new rr(3e4,6e4);function ua(t,e,n,r,i,o,s){return t.a.Nb(e,n,r,function(){t.f||(t.f=!0,t.a.Ea(t.l))},function(){t.reset()},i,o,s)}function uu(t){return!!t&&"auth/cordova-not-ready"==t.code}function uc(t,e,n,r,i){var o,s;return(s=t.g).b.set(a8,"pending",s.a).then(function(){return t.a.Ob(e,n,r,i).o(function(e){if(uu(e))throw new k("operation-not-supported-in-this-environment");return o=e,a7(t.g).then(function(){throw o})}).then(function(){return t.a.ac()?new er(function(){}):a7(t.g).then(function(){return t.ra()}).then(function(){}).o(function(){})})})}function uh(t,e,n,r,i){return t.a.Pb(r,function(t){e.na(n,null,t,i)},uo.get())}a9.prototype.ra=function(){return this.b.ra()};var ul={};function uf(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function ud(t,e,n,r){var i=uf(e,n,r);return ul[i]||(ul[i]=new a9(t,e,n,r)),ul[i]}function up(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function uv(t){t.g||(t.g=!0,uy(t,!1,null,null))}function ug(t){t.g&&!t.i&&uy(t,!1,null,null)}function um(t,e){if(t.b=function(){return eh(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function uy(t,e,n,r){e?r?function(t,e){if(t.b=function(){return el(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):um(t,n):um(t,{user:null}),t.f=[],t.c=[]}function u_(){}function ub(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(t){this.jb=t},enumerable:!1})}function uw(t,e){this.a=e,rh(this,"verificationId",t)}function uI(t,e,n,r){return new iV(t).gb(e,n).then(function(t){return new uw(t,r)})}function uT(t){var e=r3(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new k("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");rl(this,{token:t,expirationTime:ro(1e3*e.exp),authTime:ro(1e3*e.auth_time),issuedAtTime:ro(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function uE(t,e,n){var r=e&&e[uC];if(!r)throw new k("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=td(e),this.g=n,this.c=new ih(null,r),this.b=[];var i=this;K(e[uS]||[],function(t){(t=rv(t))&&i.b.push(t)}),rh(this,"auth",this.a),rh(this,"session",this.c),rh(this,"hints",this.b)}up.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},up.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(uy(this,!0,null,t.a),eh()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,s=e.T(),a=!!e.c.match(/Redirect$/);n(r,i,s,o).then(function(e){uy(t,a,e,null)}).o(function(e){uy(t,a,null,e)})}(this,t,e):el(new k("invalid-auth-event")):(uy(this,!1,null,null),eh())}else el(new k("invalid-auth-event"))},up.prototype.ra=function(){var t=this;return new er(function(e,n){var r;t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),r=new k("timeout"),t.a&&t.a.cancel(),t.a=e9(us.get()).then(function(){t.b||(t.g=!0,uy(t,!0,null,r))}))})},u_.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),eh()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then(function(t){e.na(r,t,null,n)}).o(function(t){e.na(r,null,t,n)})}(t,e):el(new k("invalid-auth-event"))}else el(new k("invalid-auth-event"))},uw.prototype.confirm=function(t){return t=iB(this.verificationId,t),this.a(t)};var uS="mfaInfo",uC="mfaPendingCredential";function uk(t,e,n,r){k.call(this,"multi-factor-auth-required",r,e),this.b=new uE(t,e,n),rh(this,"resolver",this.b)}function uN(t,e,n){if(t&&v(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new uk(e,t.serverResponse,n,t.message)}catch(t){}return null}function uA(){}function uR(t){rh(this,"factorId",t.fa),this.a=t}function ux(t){if(uR.call(this,t),this.a.fa!=iV.PROVIDER_ID)throw new k("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function uP(t,e){for(var n in eD.call(this,t),e)this[n]=e[n]}function uD(t,e){this.a=t,this.b=[],this.c=I(this.yc,this),ez(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&K(e.multiFactor.enrolledFactors,function(t){var e=null,r={};if(t){t.uid&&(r[ry]=t.uid),t.displayName&&(r[rg]=t.displayName),t.enrollmentTime&&(r[rm]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[r_]=t.phoneNumber);try{e=new rb(r)}catch(t){}t=e}else t=null;t&&n.push(t)}),uO(this,n)}function uO(t,e){t.b=e,rh(t,"enrolledFactors",e)}function uL(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function uM(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function uF(t,e){void 0===e&&(e=t.b?(e=t.b).a-e.g:0),t.c=Date.now()+1e3*e}function uU(t,e){t.b=r4(e[o1]||""),t.a=e.refreshToken,uF(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function uj(t,e){this.a=t||null,this.b=e||null,rl(this,{lastSignInTime:ro(e||null),creationTime:ro(t||null)})}function uq(t,e,n,r,i,o){rl(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function uV(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var r,i=eR.SDK_VERSION?nZ(eR.SDK_VERSION):null;this.a=new oK(this.l,P(oH),i),(this.u=t.emulatorConfig||null)&&o8(this.a,this.u),this.h=new uM(this.a),u$(this,e[o1]),uU(this.h,e),rh(this,"refreshToken",this.h.a),uZ(this,n||{}),e3.call(this),this.P=!1,this.s&&n4()&&(this.b=ud(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=(r=this,new uL(function(){return r.I(!0)},function(t){return!!t&&"auth/network-request-failed"==t.code},function(){var t=r.h.c-Date.now()-3e5;return 0<t?t:0})),this.ba=I(this.ib,this);var o=this;this.za=null,this.Pa=function(t){o.xa(t.h)},this.qa=null,this.Ba=function(t){uB(o,t.c)},this.$=null,this.aa=[],this.Oa=function(t){uH(o,t.f)},this.ja=null,this.S=new uD(this,n),rh(this,"multiFactor",this.S)}function uB(t,e){t.u=e,o8(t.a,e),t.b&&(e=t.b,t.b=ud(t.s,t.l,t.m,t.u),t.P&&(ui(e,t),ur(t.b,t)))}function uK(t,e){t.qa&&eY(t.qa,"languageCodeChanged",t.Pa),(t.qa=e)&&ez(e,"languageCodeChanged",t.Pa)}function uW(t,e){t.$&&eY(t.$,"emulatorConfigChanged",t.Ba),(t.$=e)&&ez(e,"emulatorConfigChanged",t.Ba)}function uH(t,e){t.aa=e,o9(t.a,eR.SDK_VERSION?nZ(eR.SDK_VERSION,t.aa):null)}function uz(t,e){t.ja&&eY(t.ja,"frameworkChanged",t.Oa),(t.ja=e)&&ez(e,"frameworkChanged",t.Oa)}function uG(t){try{return eR.app(t.m).auth()}catch(e){throw new k("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function uQ(t){t.J||t.D.b||(t.D.start(),eY(t,"tokenChanged",t.ba),ez(t,"tokenChanged",t.ba))}function uY(t){eY(t,"tokenChanged",t.ba),t.D.stop()}function u$(t,e){t.Aa=e,rh(t,"_lat",e)}function uX(t){for(var e=[],n=0;n<t.W.length;n++)e.push(t.W[n](t));return ed(e).then(function(){return t})}function uJ(t){t.b&&!t.P&&(t.P=!0,ur(t.b,t))}function uZ(t,e){rl(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new uj(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function u0(){}function u1(t){return eh().then(function(){if(t.J)throw new k("app-deleted")})}function u2(t){return H(t.providerData,function(t){return t.providerId})}function u4(t,e){e&&(u3(t,e.providerId),t.providerData.push(e))}function u3(t,e){Y(t.providerData,function(t){return t.providerId==e})}function u6(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&rh(t,e,n)}function u5(t,e){var n,r,i;t!=e&&(rl(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?rh(t,"metadata",(n=e.metadata,new uj(n.a,n.b))):rh(t,"metadata",new uj),K(e.providerData,function(e){u4(t,e)}),r=t.h,i=e.h,r.b=i.b,r.a=i.a,r.c=i.c,rh(t,"refreshToken",t.h.a),uO(t.S,e.S.b))}function u8(t){return t.I().then(function(e){var n=t.isAnonymous;return s$(t.a,sk,{idToken:e}).then(I(t.Kc,t)).then(function(){return n||u6(t,"isAnonymous",!1),e})})}function u7(t,e){e[o1]&&t.Aa!=e[o1]&&(uU(t.h,e),t.dispatchEvent(new uP("tokenChanged")),u$(t,e[o1]),u6(t,"refreshToken",t.h.a))}function u9(t,e){return u8(t).then(function(){if(G(u2(t),e))return uX(t).then(function(){throw new k("provider-already-linked")})})}function ct(t,e,n){return rf({user:t,credential:iK(e),additionalUserInfo:e=r9(e),operationType:n})}function ce(t,e){return u7(t,e),t.reload().then(function(){return t})}function cn(t,e,n,r,i){if(!n4())return el(new k("operation-not-supported-in-this-environment"));if(t.i&&!i)return el(t.i);var o=r7(n.providerId),s=rt(t.uid+":::"),a=null;(!n5()||nH())&&t.s&&n.isOAuthProvider&&(a=ae(t.s,t.l,t.m,e,n,null,s,eR.SDK_VERSION||null,null,null,t.tenantId,t.u));var u=nq(a,o&&o.va,o&&o.ua);return r=r().then(function(){if(ci(t),!i)return t.I().then(function(){})}).then(function(){return ua(t.b,u,e,n,s,!!a,t.tenantId)}).then(function(){return new er(function(n,r){t.na(e,null,new k("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=s,t.c=uh(t.b,t,e,u,s)})}).then(function(t){return u&&nj(u),t?rf(t):null}).o(function(t){throw u&&nj(u),t}),co(t,r,i)}function cr(t,e,n,r,i){if(!n4())return el(new k("operation-not-supported-in-this-environment"));if(t.i&&!i)return el(t.i);var o=null,s=rt(t.uid+":::");return r=r().then(function(){if(ci(t),!i)return t.I().then(function(){})}).then(function(){return t.ga=s,uX(t)}).then(function(e){return t.ha&&(e=(e=t.ha).b.set(cu,t.w(),e.a)),e}).then(function(){return uc(t.b,e,n,s,t.tenantId)}).o(function(e){if(o=e,t.ha)return cc(t.ha);throw o}).then(function(){if(o)throw o}),co(t,r,i)}function ci(t){if(!t.b||!t.P){if(t.b&&!t.P)throw new k("internal-error");throw new k("auth-domain-config-required")}}function co(t,e,n){var r=t.i&&!n?(e.cancel(),el(t.i)):e.o(function(e){throw e&&("auth/user-disabled"==e.code||"auth/user-token-expired"==e.code)&&(t.i||t.dispatchEvent(new uP("userInvalidated")),t.i=e),e});return t.N.push(r),r.oa(function(){Q(t.N,r)}),r.o(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=uN(e.w(),uG(t),I(t.jc,t))),n||e})}function cs(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[o1]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new uV(e,n,t);return t.providerData&&K(t.providerData,function(t){t&&u4(i,rf(t))}),t.redirectEventId&&(i.ga=t.redirectEventId),i}function ca(t){this.a=t,this.b=aM()}uE.prototype.Rc=function(t){var e=this;return t.tb(this.a.a,this.c).then(function(t){var n=td(e.f);return delete n[uS],delete n[uC],tv(n,t),e.g(n)})},S(uk,k),uA.prototype.tb=function(t,e,n){var r,i;return e.type==il?(r=this,e.Ha().then(function(e){return e={idToken:e},void 0!==n&&(e.displayName=n),tv(e,{phoneVerificationInfo:iq(r.a)}),s$(t,sS,e)})):(i=this,e.Ha().then(function(e){return tv(e={mfaPendingCredential:e},{phoneVerificationInfo:iq(i.a)}),s$(t,sC,e)}))},S(uR,uA),S(ux,uR),S(uP,eD),(n=uD.prototype).yc=function(t){var e,n;uO(this,(e=t.hd,n=[],K(e.mfaInfo||[],function(t){(t=rv(t))&&n.push(t)}),n))},n.Sb=function(){return this.a.I().then(function(t){return new ih(t,null)})},n.fc=function(t,e){var n=this,r=this.a.a;return this.Sb().then(function(n){return t.tb(r,n,e)}).then(function(t){return u7(n.a,t),n.a.reload()})},n.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then(function(t){return s$(r,sY,{idToken:t,mfaEnrollmentId:n})}).then(function(t){var r=W(e.b,function(t){return t.uid!=n});return uO(e,r),u7(e.a,t),e.a.reload().o(function(t){if("auth/user-token-expired"!=t.code)throw t})})},n.w=function(){return{multiFactor:{enrolledFactors:H(this.b,function(t){return t.w()})}}},uL.prototype.start=function(){this.a=this.c,function t(e,n){var r;e.stop(),e.b=e9((r=n)?(e.a=e.c,e.g()):(r=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),r)).then(function(){var t,e;return t=a.document,e=null,ri()||!t?eh():new er(function(n){e=function(){ri()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).o(function(n){throw t.removeEventListener("visibilitychange",e,!1),n})}).then(function(){return e.h()}).then(function(){t(e,!0)}).o(function(n){e.i(n)&&t(e,!1)})}(this,!0)},uL.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},uM.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},uM.prototype.getToken=function(t){var e,n,r;return t=!!t,this.b&&!this.a?el(new k("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?(e=this,n={grant_type:"refresh_token",refresh_token:this.a},(r=e.f,new er(function(t,e){"refresh_token"==n.grant_type&&n.refresh_token||"authorization_code"==n.grant_type&&n.code?st(r,r.l+"?key="+encodeURIComponent(r.c),function(n){n?n.error?e(sJ(n)):n.access_token&&n.refresh_token?t(n):e(new k("internal-error")):e(new k("network-request-failed"))},"POST",nE(n).toString(),r.g,r.m.get()):e(new k("internal-error"))})).then(function(t){return e.b=r4(t.access_token),e.a=t.refresh_token,uF(e,t.expires_in),{accessToken:e.b.toString(),refreshToken:e.a}}).o(function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t})):eh(null):eh({accessToken:this.b.toString(),refreshToken:this.a})},uj.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(uV,e3),uV.prototype.xa=function(t){this.za=t,o5(this.a,t)},uV.prototype.la=function(){return this.za},uV.prototype.Ga=function(){return X(this.aa)},uV.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},rh(uV.prototype,"providerId","firebase"),(n=uV.prototype).reload=function(){var t=this;return co(this,u1(this).then(function(){return u8(t).then(function(){return uX(t)}).then(u0)}))},n.oc=function(t){return this.I(t).then(function(t){return new uT(t)})},n.I=function(t){var e=this;return co(this,u1(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new k("internal-error");return t.accessToken!=e.Aa&&(u$(e,t.accessToken),e.dispatchEvent(new uP("tokenChanged"))),u6(e,"refreshToken",t.refreshToken),t.accessToken}))},n.Kc=function(t){if(!(t=t.users)||!t.length)throw new k("internal-error");uZ(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e,n=(e=(e=t).providerUserInfo)&&e.length?H(e,function(t){return new uq(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[],r=0;r<n.length;r++)u4(this,n[r]);u6(this,"isAnonymous",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length)),this.dispatchEvent(new uP("userReloaded",{hd:t}))},n.Lc=function(t){return ru("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(t)},n.ub=function(t){var e=this,n=null;return co(this,t.c(this.a,this.uid).then(function(t){return u7(e,t),n=ct(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},n.Cc=function(t){return ru("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(t)},n.rb=function(t){var e=this,n=null;return co(this,u9(this,t.providerId).then(function(){return e.I()}).then(function(n){return t.b(e.a,n)}).then(function(t){return n=ct(e,t,"link"),ce(e,t)}).then(function(){return n}))},n.Dc=function(t,e){var n=this;return co(this,u9(this,"phone").then(function(){return uI(uG(n),t,e,I(n.rb,n))}))},n.Mc=function(t,e){var n=this;return co(this,eh().then(function(){return uI(uG(n),t,e,I(n.ub,n))}),!0)},n.Cb=function(t){var e=this;return co(this,this.I().then(function(n){return e.a.Cb(n,t)}).then(function(t){return u7(e,t),e.reload()}))},n.ed=function(t){var e=this;return co(this,this.I().then(function(n){return t.b(e.a,n)}).then(function(t){return u7(e,t),e.reload()}))},n.Db=function(t){var e=this;return co(this,this.I().then(function(n){return e.a.Db(n,t)}).then(function(t){return u7(e,t),e.reload()}))},n.Eb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return u1(this);var e=this;return co(this,this.I().then(function(n){return e.a.Eb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return u7(e,t),u6(e,"displayName",t.displayName||null),u6(e,"photoURL",t.photoUrl||null),K(e.providerData,function(t){"password"===t.providerId&&(rh(t,"displayName",e.displayName),rh(t,"photoURL",e.photoURL))}),uX(e)}).then(u0))},n.cd=function(t){var e=this;return co(this,u8(this).then(function(n){return G(u2(e),t)?s$(e.a,sI,{idToken:n,deleteProvider:[t]}).then(function(t){var n={};return K(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),K(u2(e),function(t){n[t]||u3(e,t)}),n[iV.PROVIDER_ID]||rh(e,"phoneNumber",null),uX(e)}):uX(e).then(function(){throw new k("no-such-provider")})}))},n.delete=function(){var t=this;return co(this,this.I().then(function(e){return s$(t.a,sw,{idToken:e})}).then(function(){t.dispatchEvent(new uP("userDeleted"))})).then(function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");uK(t,null),uW(t,null),uz(t,null),t.N=[],t.J=!0,uY(t),rh(t,"refreshToken",null),t.b&&ui(t.b,t)})},n.Gb=function(t,e){return"linkViaPopup"==t&&(this.g||null)==e&&!!this.f||"reauthViaPopup"==t&&(this.g||null)==e&&!!this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e},n.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},n.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?I(this.Lb,this):"reauthViaPopup"==t&&e==(this.g||null)?I(this.Mb,this):"linkViaRedirect"==t&&(this.ga||null)==e?I(this.Lb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?I(this.Mb,this):null},n.Ec=function(t){var e=this;return cn(this,"linkViaPopup",t,function(){return u9(e,t.providerId).then(function(){return uX(e)})},!1)},n.Nc=function(t){return cn(this,"reauthViaPopup",t,function(){return eh()},!0)},n.Fc=function(t){var e=this;return cr(this,"linkViaRedirect",t,function(){return u9(e,t.providerId)},!1)},n.Oc=function(t){return cr(this,"reauthViaRedirect",t,function(){return eh()},!0)},n.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return co(this,this.I().then(function(n){return sp(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})}).then(function(t){return o=ct(i,t,"link"),ce(i,t)}).then(function(){return o}))},n.Mb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return co(this,eh().then(function(){return iv(sv(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)}).then(function(t){return o=ct(i,t,"reauthenticate"),u7(i,t),i.i=null,i.reload()}).then(function(){return o}),!0)},n.vb=function(t){var e=this,n=null;return co(this,this.I().then(function(e){return n=e,void 0===t||tf(t)?{}:r0(new rW(t))}).then(function(t){return e.a.vb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},n.Fb=function(t,e){var n=this,r=null;return co(this,this.I().then(function(t){return r=t,void 0===e||tf(e)?{}:r0(new rW(e))}).then(function(e){return n.a.Fb(r,t,e)}).then(function(t){if(n.email!=t)return n.reload()}).then(function(){}))},n.jc=function(t){var e=null,n=this;return co(this,t=iv(eh(t),n.uid).then(function(t){return e=ct(n,t,"reauthenticate"),u7(n,t),n.i=null,n.reload()}).then(function(){return e}),!0)},n.toJSON=function(){return this.w()},n.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&tv(t,this.metadata.w()),K(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),tv(t,this.S.w()),t};var cu={name:"redirectUser",F:"session"};function cc(t){return aj(t.b,cu,t.a)}function ch(t){var e,n,r,i,o,s,u,c;this.a=t,this.b=aM(),this.c=null,this.f=(e=this,s=cd("local"),u=cd("session"),c=cd("none"),(n=e.b,i=aU(s,r=e.a),o=aF(n,s.F),n.get(s,r).then(function(t){var e=null;try{e=n9(a.localStorage.getItem(i))}catch(t){}if(e&&!t)return a.localStorage.removeItem(i),n.set(s,e,r);e&&t&&"localStorage"!=o.type&&a.localStorage.removeItem(i)})).then(function(){return e.b.get(u,e.a)}).then(function(t){return t?u:e.b.get(c,e.a).then(function(t){return t?c:e.b.get(s,e.a).then(function(t){return t?s:e.b.get(cf,e.a).then(function(t){return t?cd(t):s})})})}).then(function(t){return e.c=t,cl(e,t.F)}).o(function(){e.c||(e.c=s)})),this.b.addListener(cd("local"),this.a,I(this.g,this))}function cl(t,e){var n,r=[];for(n in aO)aO[n]!==e&&r.push(aj(t.b,cd(aO[n]),t.a));return r.push(aj(t.b,cf,t.a)),new er(function(t,e){var n=r.length,i=[];if(n)for(var o=function(e,r){n--,i[e]=r,0==n&&t(i)},s=function(t){e(t)},a=0;a<r.length;a++)ef(r[a],T(o,a),s);else t(i)})}ch.prototype.g=function(){var t=this,e=cd("local");cm(this,function(){return eh().then(function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null}).then(function(n){if(n)return cl(t,"local").then(function(){t.c=e})})})};var cf={name:"persistence",F:"session"};function cd(t){return{name:"authUser",F:t}}function cp(t,e){return cm(t,function(){return t.b.set(t.c,e.w(),t.a)})}function cv(t){return cm(t,function(){return aj(t.b,t.c,t.a)})}function cg(t,e,n){return cm(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),cs(t||{})})})}function cm(t,e){return t.f=t.f.then(e,e),t.f}function cy(t){var e,n,r,i,o,s,a,u,c,h;if(this.l=!1,rh(this,"settings",new ub),rh(this,"app",t),cC(this).options&&cC(this).options.apiKey)t=eR.SDK_VERSION?nZ(eR.SDK_VERSION):null,this.a=new oK(cC(this).options&&cC(this).options.apiKey,P(oH),t);else throw new k("invalid-api-key");this.P=[],this.s=[],this.N=[],this.Pa=eR.INTERNAL.createSubscribe(I(this.zc,this)),this.W=void 0,this.ib=eR.INTERNAL.createSubscribe(I(this.Ac,this)),cE(this,null),this.i=new ch(cC(this).options.apiKey+":"+cC(this).name),this.D=new ca(cC(this).options.apiKey+":"+cC(this).name),this.$=cR(this,(o=this,c=cC(o).options.authDomain,h=(u=(s=o.D,a=cC(o).options.authDomain,s.b.get(cu,s.a).then(function(t){return t&&a&&(t.authDomain=a),cs(t||{})})).then(function(t){return(o.m=t)&&(t.ha=o.D),cc(o.D)}),cR(o,u)).then(function(){return cg(o.i,c,o.R)}).then(function(t){return t?(t.ha=o.D,o.m&&(o.m.ga||null)==(t.ga||null)?t:t.reload().then(function(){return cp(o.i,t).then(function(){return t})}).o(function(e){return"auth/network-request-failed"==e.code?t:cv(o.i)})):null}).then(function(t){cE(o,t||null)}),cR(o,h))),this.h=cR(this,(e=this,e.$.then(function(){return cT(e)}).o(function(){}).then(function(){if(!e.l)return e.ja()}).o(function(){}).then(function(){if(!e.l){e.ba=!0;var t=e.i;t.b.addListener(cd("local"),t.a,e.ja)}}))),this.ba=!1,this.ja=I(this.Zc,this),this.Ba=I(this.da,this),this.qa=I(this.mc,this),this.za=I(this.wc,this),this.Aa=I(this.xc,this),this.b=null,n=this,r=cC(n).options.authDomain,i=cC(n).options.apiKey,r&&n4()&&(n.Oa=n.$.then(function(){if(!n.l){if(n.b=ud(r,i,cC(n).name,n.R),ur(n.b,n),ck(n)&&uJ(ck(n)),n.m){uJ(n.m);var t=n.m;t.xa(n.la()),uK(t,n),uH(t=n.m,n.J),uz(t,n),uB(t=n.m,n.R),uW(t,n),n.m=null}return n.b}})),this.INTERNAL={},this.INTERNAL.delete=I(this.delete,this),this.INTERNAL.logFramework=I(this.Gc,this),this.u=0,e3.call(this),Object.defineProperty(this,"lc",{get:function(){return this.la()},set:function(t){this.xa(t)},enumerable:!1}),this.aa=null,Object.defineProperty(this,"ti",{get:function(){return this.T()},set:function(t){this.zb(t)},enumerable:!1}),this.S=null,Object.defineProperty(this,"emulatorConfig",{get:function(){if(this.R){var t=nf(this.R.url);t=rf({protocol:t.c,host:t.a,port:t.g,options:rf({disableWarnings:this.R.ec})})}else t=null;return t},enumerable:!1}),this.J=[],this.R=null}function c_(t){eD.call(this,"languageCodeChanged"),this.h=t}function cb(t){eD.call(this,"emulatorConfigChanged"),this.c=t}function cw(t){eD.call(this,"frameworkChanged"),this.f=t}function cI(t){return t.Oa||el(new k("auth-domain-config-required"))}function cT(t){if(!n4())return el(new k("operation-not-supported-in-this-environment"));var e=cI(t).then(function(){return t.b.ra()}).then(function(t){return t?rf(t):null});return cR(t,e)}function cE(t,e){var n,r;ck(t)&&(n=ck(t),r=t.Ba,Y(n.W,function(t){return t==r}),eY(ck(t),"tokenChanged",t.qa),eY(ck(t),"userDeleted",t.za),eY(ck(t),"userInvalidated",t.Aa),uY(ck(t))),e&&(e.W.push(t.Ba),ez(e,"tokenChanged",t.qa),ez(e,"userDeleted",t.za),ez(e,"userInvalidated",t.Aa),0<t.u&&uQ(e)),rh(t,"currentUser",e),e&&(e.xa(t.la()),uK(e,t),uH(e,t.J),uz(e,t),uB(e,t.R),uW(e,t))}function cS(t,e){var n=null,r=null;return cR(t,e.then(function(e){var i;return n=iK(e),r=r9(e),(i={}).apiKey=cC(t).options.apiKey,i.authDomain=cC(t).options.authDomain,i.appName=cC(t).name,t.R&&(i.emulatorConfig=t.R),t.$.then(function(){var n,r,o;return n=t.D,r=t.Ga(),o=new uV(i,e),n&&(o.ha=n),r&&uH(o,r),o.reload().then(function(){return o})}).then(function(e){return ck(t)&&e.uid==ck(t).uid?(u5(ck(t),e),t.da(e)):(cE(t,e),uJ(e),t.da(e))}).then(function(){cA(t)})},function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=uN(e.w(),t,I(t.kc,t))),n||e}).then(function(){return rf({user:ck(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function cC(t){return t.app}function ck(t){return t.currentUser}function cN(t){return ck(t)&&ck(t)._lat||null}function cA(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](cN(t));if(t.W!==t.getUid()&&t.N.length)for(t.W=t.getUid(),e=0;e<t.N.length;e++)t.N[e]&&t.N[e](cN(t))}}function cR(t,e){return t.P.push(e),e.oa(function(){Q(t.P,e)}),e}function cx(){}function cP(){this.a={},this.b=1e12}ch.prototype.yb=function(t){var e=null,n=this;return function(t){var e=new k("invalid-persistence-type"),n=new k("unsupported-persistence-type");t:{for(r in aO)if(aO[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(nG()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!ad()&&"none"!==t)throw n;break;default:if(!n2()&&"none"!==t)throw n}}(t),cm(this,function(){return t!=n.c.F?n.b.get(n.c,n.a).then(function(r){return e=r,cl(n,t)}).then(function(){if(n.c=cd(t),e)return n.b.set(n.c,e,n.a)}):eh()})},S(cy,e3),S(c_,eD),S(cb,eD),S(cw,eD),(n=cy.prototype).yb=function(t){return cR(this,t=this.i.yb(t))},n.xa=function(t){this.aa===t||this.l||(this.aa=t,o5(this.a,this.aa),this.dispatchEvent(new c_(this.la())))},n.la=function(){return this.aa},n.fd=function(){var t=a.navigator;this.xa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},n.gd=function(t,e){if(!this.R){var n;if(!/^https?:\/\//.test(t))throw new k("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");n=e=!!e&&!!e.disableWarnings,"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),a.document&&!n&&nK().then(function(){var t=a.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),a.document.body.appendChild(t)}),this.R={url:t,ec:e},this.settings.jb=!0,o8(this.a,this.R),this.dispatchEvent(new cb(this.R))}},n.Gc=function(t){this.J.push(t),o9(this.a,eR.SDK_VERSION?nZ(eR.SDK_VERSION,this.J):null),this.dispatchEvent(new cw(this.J))},n.Ga=function(){return X(this.J)},n.zb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},n.T=function(){return this.S},n.toJSON=function(){return{apiKey:cC(this).options.apiKey,authDomain:cC(this).options.authDomain,appName:cC(this).name,currentUser:ck(this)&&ck(this).w()}},n.Gb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},n.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},n.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?I(this.ic,this):null},n.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then(function(){return cS(i,sd(i.a,o))})},n.Xc=function(t){if(!n4())return el(new k("operation-not-supported-in-this-environment"));var e=this,n=r7(t.providerId),r=rt(),i=null;(!n5()||nH())&&cC(this).options.authDomain&&t.isOAuthProvider&&(i=ae(cC(this).options.authDomain,cC(this).options.apiKey,cC(this).name,"signInViaPopup",t,null,r,eR.SDK_VERSION||null,null,null,this.T(),this.R));var o=nq(i,n&&n.va,n&&n.ua);return cR(this,n=cI(this).then(function(n){return ua(n,o,"signInViaPopup",t,r,!!i,e.T())}).then(function(){return new er(function(t,n){e.na("signInViaPopup",null,new k("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=r,e.c=uh(e.b,e,"signInViaPopup",o,r)})}).then(function(t){return o&&nj(o),t?rf(t):null}).o(function(t){throw o&&nj(o),t}))},n.Yc=function(t){if(!n4())return el(new k("operation-not-supported-in-this-environment"));var e=this;return cR(this,cI(this).then(function(){var t;return cm(t=e.i,function(){return t.b.set(cf,t.c.F,t.a)})}).then(function(){return uc(e.b,"signInViaRedirect",t,void 0,e.T())}))},n.ra=function(){var t=this;return cT(this).then(function(e){return t.b&&ug(t.b.b),e}).o(function(e){throw t.b&&ug(t.b.b),e})},n.dd=function(t){if(!t)return el(new k("null-user"));if(this.S!=t.tenantId)return el(new k("tenant-id-mismatch"));var e,n,r,i,o,s=this,a={};a.apiKey=cC(this).options.apiKey,a.authDomain=cC(this).options.authDomain,a.appName=cC(this).name;var u=(e=a,n=s.D,r=s.Ga(),i=t.h,(o={})[o1]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new uV(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&uH(e,r),u5(e,t),e);return cR(this,this.h.then(function(){if(cC(s).options.apiKey!=t.l)return u.reload()}).then(function(){return ck(s)&&t.uid==ck(s).uid?(u5(ck(s),t),s.da(t)):(cE(s,u),uJ(u),s.da(u))}).then(function(){cA(s)}))},n.Bb=function(){var t=this;return cR(this,this.h.then(function(){return(t.b&&ug(t.b.b),ck(t))?(cE(t,null),cv(t.i).then(function(){cA(t)})):eh()}))},n.Zc=function(){var t=this;return cg(this.i,cC(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=ck(t)&&e){n=ck(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return u5(ck(t),e),ck(t).I();(ck(t)||e)&&(cE(t,e),e&&(uJ(e),e.ha=t.D),t.b&&ur(t.b,t),cA(t))}})},n.da=function(t){return cp(this.i,t)},n.mc=function(){cA(this),this.da(ck(this))},n.wc=function(){this.Bb()},n.xc=function(){this.Bb()},n.kc=function(t){var e=this;return this.h.then(function(){return cS(e,eh(t))})},n.zc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(ck(e))})},n.Ac=function(t){var e,n,r=this;e=this,n=function(){t.next(ck(r))},e.N.push(n),cR(e,e.h.then(function(){!e.l&&G(e.N,n)&&e.W!==e.getUid()&&(e.W=e.getUid(),n(cN(e)))}))},n.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then(function(){"function"==typeof t?t(ck(r)):"function"==typeof t.next&&t.next(ck(r))}),this.Pa(t,e,n)},n.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then(function(){r.W=r.getUid(),"function"==typeof t?t(ck(r)):"function"==typeof t.next&&t.next(ck(r))}),this.ib(t,e,n)},n.nc=function(t){var e=this;return cR(this,this.h.then(function(){return ck(e)?ck(e).I(t).then(function(t){return{accessToken:t}}):null}))},n.Tc=function(t){var e=this;return this.h.then(function(){return cS(e,s$(e.a,sW,{token:t}))}).then(function(t){var n=t.user;return u6(n,"isAnonymous",!1),e.da(n),t})},n.Uc=function(t,e){var n=this;return this.h.then(function(){return cS(n,s$(n.a,sH,{email:t,password:e}))})},n.dc=function(t,e){var n=this;return this.h.then(function(){return cS(n,s$(n.a,s_,{email:t,password:e}))})},n.ab=function(t){var e=this;return this.h.then(function(){return cS(e,t.ka(e.a))})},n.Sc=function(t){return ru("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(t)},n.Ab=function(){var t=this;return this.h.then(function(){var e=ck(t);if(e&&e.isAnonymous){var n=rf({providerId:null,isNewUser:!1});return rf({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return cS(t,t.a.Ab()).then(function(e){var n=e.user;return u6(n,"isAnonymous",!0),t.da(n),e})})},n.getUid=function(){return ck(this)&&ck(this).uid||null},n.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&ck(this)&&uQ(ck(this))},n.Pc=function(t){var e=this;K(this.s,function(n){n==t&&e.u--}),0>this.u&&(this.u=0),0==this.u&&ck(this)&&uY(ck(this)),this.removeAuthTokenListener(t)},n.addAuthTokenListener=function(t){var e=this;this.s.push(t),cR(this,this.h.then(function(){e.l||G(e.s,t)&&t(cN(e))}))},n.removeAuthTokenListener=function(t){Y(this.s,function(e){return e==t})},n.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(cd("local"),t.a,this.ja),this.b&&(ui(this.b,this),ug(this.b.b)),Promise.resolve()},n.hc=function(t){return cR(this,s$(this.a,sb,{identifier:t,continueUri:n3()?nM():"http://localhost"}).then(function(t){return t.signinMethods||[]}))},n.Bc=function(t){return!!iF(t)},n.xb=function(t,e){var n=this;return cR(this,eh().then(function(){var t=new rW(e);if(!t.c)throw new k("argument-error",rG+" must be true when sending sign in link to email");return r0(t)}).then(function(e){return n.a.xb(t,e)}).then(function(){}))},n.jd=function(t){return this.Sa(t).then(function(t){return t.data.email})},n.ob=function(t,e){return cR(this,this.a.ob(t,e).then(function(){}))},n.Sa=function(t){return cR(this,this.a.Sa(t).then(function(t){return new rw(t)}))},n.kb=function(t){return cR(this,this.a.kb(t).then(function(){}))},n.wb=function(t,e){var n=this;return cR(this,eh().then(function(){return void 0===e||tf(e)?{}:r0(new rW(e))}).then(function(e){return n.a.wb(t,e)}).then(function(){}))},n.Wc=function(t,e){return cR(this,uI(this,t,e,I(this.ab,this)))},n.Vc=function(t,e){var n=this;return cR(this,eh().then(function(){var r=e||nM(),i=iM(t,r);if(!(r=iF(r)))throw new k("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new k("tenant-id-mismatch");return n.ab(i)}))},cx.prototype.render=function(){},cx.prototype.reset=function(){},cx.prototype.getResponse=function(){},cx.prototype.execute=function(){};var cD=null;function cO(t,e){return(e=cL(e))&&t.a[e]||null}function cL(t){return(t=void 0===t?1e12:t)?t.toString():null}function cM(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=t3(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():ez(this.f,"click",this.i)}function cF(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function cU(){}function cj(){}cP.prototype.render=function(t,e){return this.a[this.b.toString()]=new cM(t,e),this.b++},cP.prototype.reset=function(t){var e=cO(this,t);t=cL(t),e&&t&&(e.delete(),delete this.a[t])},cP.prototype.getResponse=function(t){return(t=cO(this,t))?t.getResponse():null},cP.prototype.execute=function(t){(t=cO(this,t))&&t.execute()},cM.prototype.getResponse=function(){return cF(this),this.b},cM.prototype.execute=function(){cF(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()},6e4)},500))},cM.prototype.delete=function(){cF(this),this.g=!0,clearTimeout(this.a),this.a=null,eY(this.f,"click",this.i)},rh(cU,"FACTOR_ID","phone"),cj.prototype.g=function(){return cD||(cD=new cP),eh(cD)},cj.prototype.c=function(){};var cq=null;function cV(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var cB=new tm(tb,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),cK=new rr(3e4,6e4);cV.prototype.g=function(t){var e=this;return new er(function(n,r){var i=setTimeout(function(){r(new k("network-request-failed"))},cK.get());a.grecaptcha&&(t===e.f||e.b)?(clearTimeout(i),n(a.grecaptcha)):(a[e.a]=function(){if(a.grecaptcha){e.f=t;var o=a.grecaptcha.render;a.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(a.grecaptcha)}else clearTimeout(i),r(new k("internal-error"));delete a[e.a]},eh(oM(tE(cB,{onload:e.a,hl:t||""}))).o(function(){clearTimeout(i),r(new k("internal-error","Unable to load external reCAPTCHA dependencies!"))}))})},cV.prototype.c=function(){this.b--};var cW=null;function cH(t,e,n,r,i,o,s){if(rh(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=e,this.g=null,s?(cq||(cq=new cj),s=cq):(cW||(cW=new cV),s=cW),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[cQ])throw new k("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[cY],!a.document)throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!t3(e)||!this.i&&t3(e).hasChildNodes())throw new k("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new oK(t,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[cz];this.a[cz]=function(t){if(c$(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=n1(c,a);"function"==typeof e&&e(t)}};var h=this.a[cG];this.a[cG]=function(){if(c$(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=n1(h,a);"function"==typeof t&&t()}}}var cz="callback",cG="expired-callback",cQ="sitekey",cY="size";function c$(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function cX(t,e){return t.h.push(e),e.oa(function(){Q(t.h,e)}),e}function cJ(t){if(t.J)throw new k("internal-error","RecaptchaVerifier instance has been destroyed.")}function cZ(t,e,n){var r=!1;try{this.b=n||eR.app()}catch(t){throw new k("argument-error","No firebase.app.App instance is currently initialized.")}if(this.b.options&&this.b.options.apiKey)n=this.b.options.apiKey;else throw new k("invalid-api-key");var i=this,o=null;try{o=this.b.auth().Ga()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=eR.SDK_VERSION?nZ(eR.SDK_VERSION,o):null,cH.call(this,n,t,e,function(){try{var t=i.b.auth().la()}catch(e){t=null}return t},o,P(oH),r)}function c0(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<e.length;s++)if(e[s].optional)o=!0;else{if(o)throw new k("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=c1.length)throw new k("internal-error","Argument validator received an unsupported number of arguments.");n=c1[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new k("argument-error",t+" failed: "+r)}(n=cH.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=cX(this,eh().then(function(){if(n3()&&!nz())return nK();throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.m.g(t.u())}).then(function(e){return t.g=e,s$(t.s,sD,{})}).then(function(e){t.a[cQ]=e.recaptchaSiteKey}).o(function(e){throw t.f=null,e}))},n.render=function(){cJ(this);var t=this;return cX(this,this.Ia().then(function(){if(null===t.c){var e=t.v;if(!t.i){var n=t3(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!t4&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',tV(s.name),'"'),s.type){o.push(' type="',tV(s.type),'"');var a={};tv(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=t8(i,o),s&&("string"==typeof s?o.className=s:Array.isArray(s)?o.className=s.join(" "):t6(o,s)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!d(o)||v(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(v(o)){var s="function"==typeof o.item||"string"==typeof o.item;break t}if(p(o)){s="function"==typeof o.item;break t}}s=!1}K(s?X(o):o,r)}}}(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},n.verify=function(){cJ(this);var t=this;return cX(this,this.render().then(function(e){return new er(function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(Y(t.l,function(t){return t==i}),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}})}))},n.reset=function(){cJ(this),null!==this.c&&this.g.reset(this.c)},n.clear=function(){cJ(this),this.J=!0,this.m.c();for(var t,e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i)for(e=t3(this.v);t=e.firstChild;)e.removeChild(t)},S(cZ,cH);var c1="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function c2(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function c4(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function c3(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:v}}function c6(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function c5(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function c8(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function c7(){return{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}}}function c9(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}}function ht(t,e){return v(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function he(t){return v(t)&&"string"==typeof t.uid}function hn(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}}function hr(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function hi(t,e){for(var n in e){var r=e[n].name;t[r]=ha(r,t[n],e[n].j)}}function ho(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:T(function(t){return this[t]},n),set:T(function(t,e,n,r){c0(t,[n],[r],!0),this[e]=r},r,n,e[n].lb),enumerable:!0})}}function hs(t,e,n,r){t[e]=ha(e,n,r)}function ha(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return c0(s,n,t),e.apply(this,t)}if(!n)return e;var i,o,s=(i=(i=t).split("."))[i.length-1];for(o in e)r[o]=e[o];for(o in e.prototype)r.prototype[o]=e.prototype[o];return r}hi(cy.prototype,{kb:{name:"applyActionCode",j:[c2("code")]},Sa:{name:"checkActionCode",j:[c2("code")]},ob:{name:"confirmPasswordReset",j:[c2("code"),c2("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[c2("email"),c2("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[c2("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[c2("emailLink")]},Hc:{name:"onAuthStateChanged",j:[hr(c3(),c6(),"nextOrObserver"),c6("opt_error",!0),c6("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[hr(c3(),c6(),"nextOrObserver"),c6("opt_error",!0),c6("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[c2("email"),hr(c3("opt_actionCodeSettings",!0),c5(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[c2("email"),c3("actionCodeSettings")]},yb:{name:"setPersistence",j:[c2("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[c8()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[c8()]},Tc:{name:"signInWithCustomToken",j:[c2("token")]},Uc:{name:"signInWithEmailAndPassword",j:[c2("email"),c2("password")]},Vc:{name:"signInWithEmailLink",j:[c2("email"),c2("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[c2("phoneNumber"),hn()]},Xc:{name:"signInWithPopup",j:[c9()]},Yc:{name:"signInWithRedirect",j:[c9()]},dd:{name:"updateCurrentUser",j:[hr({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof uV)}},c5(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[c2(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[c2("url"),c3("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[c2("code")]}}),ho(cy.prototype,{lc:{name:"languageCode",lb:hr(c2(),c5(),"languageCode")},ti:{name:"tenantId",lb:hr(c2(),c5(),"tenantId")}}),cy.Persistence=aO,cy.Persistence.LOCAL="local",cy.Persistence.SESSION="session",cy.Persistence.NONE="none",hi(uV.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[c4("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[c4("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[c8()]},rb:{name:"linkWithCredential",j:[c8()]},Dc:{name:"linkWithPhoneNumber",j:[c2("phoneNumber"),hn()]},Ec:{name:"linkWithPopup",j:[c9()]},Fc:{name:"linkWithRedirect",j:[c9()]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[c8()]},ub:{name:"reauthenticateWithCredential",j:[c8()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[c2("phoneNumber"),hn()]},Nc:{name:"reauthenticateWithPopup",j:[c9()]},Oc:{name:"reauthenticateWithRedirect",j:[c9()]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[hr(c3("opt_actionCodeSettings",!0),c5(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[c2(null,!0)]},cd:{name:"unlink",j:[c2("provider")]},Cb:{name:"updateEmail",j:[c2("email")]},Db:{name:"updatePassword",j:[c2("password")]},ed:{name:"updatePhoneNumber",j:[c8("phone")]},Eb:{name:"updateProfile",j:[c3("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[c2("email"),hr(c3("opt_actionCodeSettings",!0),c5(null,!0),"opt_actionCodeSettings",!0)]}}),hi(cP.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),hi(cx.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),hi(er.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),ho(ub.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:c4("appVerificationDisabledForTesting")}}),hi(uw.prototype,{confirm:{name:"confirm",j:[c2("verificationCode")]}}),hs(ip,"fromJSON",function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[iw,iO,ij,iy],r=0;r<n.length;r++)if(e=n[r](t))return e;return null},[hr(c2(),c3(),"json")]),hs(iL,"credential",function(t,e){return new iD(t,e)},[c2("email"),c2("password")]),hi(iD.prototype,{w:{name:"toJSON",j:[c2(null,!0)]}}),hi(iS.prototype,{Ca:{name:"addScope",j:[c2("scope")]},Ka:{name:"setCustomParameters",j:[c3("customOAuthParameters")]}}),hs(iS,"credential",iC,[hr(c2(),c3(),"token")]),hs(iL,"credentialWithLink",iM,[c2("email"),c2("emailLink")]),hi(ik.prototype,{Ca:{name:"addScope",j:[c2("scope")]},Ka:{name:"setCustomParameters",j:[c3("customOAuthParameters")]}}),hs(ik,"credential",iN,[hr(c2(),c3(),"token")]),hi(iA.prototype,{Ca:{name:"addScope",j:[c2("scope")]},Ka:{name:"setCustomParameters",j:[c3("customOAuthParameters")]}}),hs(iA,"credential",iR,[hr(c2(),hr(c3(),c5()),"idToken"),hr(c2(),c5(),"accessToken",!0)]),hi(ix.prototype,{Ka:{name:"setCustomParameters",j:[c3("customOAuthParameters")]}}),hs(ix,"credential",iP,[hr(c2(),c3(),"token"),c2("secret",!0)]),hi(iE.prototype,{Ca:{name:"addScope",j:[c2("scope")]},credential:{name:"credential",j:[hr(c2(),hr(c3(),c5()),"optionsOrIdToken"),hr(c2(),c5(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[c3("customOAuthParameters")]}}),hi(i_.prototype,{w:{name:"toJSON",j:[c2(null,!0)]}}),hi(ig.prototype,{w:{name:"toJSON",j:[c2(null,!0)]}}),hs(iV,"credential",iB,[c2("verificationId"),c2("verificationCode")]),hi(iV.prototype,{gb:{name:"verifyPhoneNumber",j:[hr(c2(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?ht(t.session,il)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?ht(t.session,id)&&he(t.multiFactorHint):t.session&&t.multiFactorUid?ht(t.session,id)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),hn()]}}),hi(iU.prototype,{w:{name:"toJSON",j:[c2(null,!0)]}}),hi(k.prototype,{toJSON:{name:"toJSON",j:[c2(null,!0)]}}),hi(i$.prototype,{toJSON:{name:"toJSON",j:[c2(null,!0)]}}),hi(iY.prototype,{toJSON:{name:"toJSON",j:[c2(null,!0)]}}),hi(uk.prototype,{toJSON:{name:"toJSON",j:[c2(null,!0)]}}),hi(uE.prototype,{Rc:{name:"resolveSignIn",j:[c7()]}}),hi(uD.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[c7(),c2("displayName",!0)]},bd:{name:"unenroll",j:[hr({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:he},c2(),"multiFactorInfoIdentifier")]}}),hi(cZ.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),hs(rL,"parseLink",rK,[c2("link")]),hs(cU,"assertion",function(t){return new ux(t)},[c8("phone")]),function(){if(void 0!==eR&&eR.INTERNAL&&eR.INTERNAL.registerComponent){var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:rT,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:rI,VERIFY_AND_CHANGE_EMAIL:rE,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:cy,AuthCredential:ip,Error:k};hs(t,"EmailAuthProvider",iL,[]),hs(t,"FacebookAuthProvider",iS,[]),hs(t,"GithubAuthProvider",ik,[]),hs(t,"GoogleAuthProvider",iA,[]),hs(t,"TwitterAuthProvider",ix,[]),hs(t,"OAuthProvider",iE,[c2("providerId")]),hs(t,"SAMLAuthProvider",iT,[c2("providerId")]),hs(t,"PhoneAuthProvider",iV,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof cy)}}]),hs(t,"RecaptchaVerifier",cZ,[hr(c2(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),c3("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof eR.app.App)}}]),hs(t,"ActionCodeURL",rL,[]),hs(t,"PhoneMultiFactorGenerator",cU,[]),eR.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return t=t.getProvider("app").getImmediate(),new cy(t)},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(t){t.getProvider("auth-internal").initialize()}}),eR.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:I((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:I(t.nc,t),addAuthTokenListener:I(t.cc,t),removeAuthTokenListener:I(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),eR.registerVersion("@firebase/auth","0.16.8"),eR.INTERNAL.extendNamespace({User:uV})}else throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.")}()}).apply(void 0!==b?b:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ex={},eP=ex={};function eD(){throw Error("setTimeout has not been defined")}function eO(){throw Error("clearTimeout has not been defined")}function eL(t){if(sV===setTimeout)return setTimeout(t,0);if((sV===eD||!sV)&&setTimeout)return sV=setTimeout,setTimeout(t,0);try{return sV(t,0)}catch(e){try{return sV.call(null,t,0)}catch(e){return sV.call(this,t,0)}}}!function(){try{sV="function"==typeof setTimeout?setTimeout:eD}catch(t){sV=eD}try{sB="function"==typeof clearTimeout?clearTimeout:eO}catch(t){sB=eO}}();var eM=[],eF=!1,eU=-1;function ej(){eF&&sK&&(eF=!1,sK.length?eM=sK.concat(eM):eU=-1,eM.length&&eq())}function eq(){if(!eF){var t=eL(ej);eF=!0;for(var e=eM.length;e;){for(sK=eM,eM=[];++eU<e;)sK&&sK[eU].run();eU=-1,e=eM.length}sK=null,eF=!1,function(t){if(sB===clearTimeout)return clearTimeout(t);if((sB===eO||!sB)&&clearTimeout)return sB=clearTimeout,clearTimeout(t);try{sB(t)}catch(e){try{return sB.call(null,t)}catch(e){return sB.call(this,t)}}}(t)}}function eV(t,e){this.fun=t,this.array=e}function eB(){}eP.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];eM.push(new eV(t,e)),1!==eM.length||eF||eL(eq)},eV.prototype.run=function(){this.fun.apply(null,this.array)},eP.title="browser",eP.browser=!0,eP.env={},eP.argv=[],eP.version="",eP.versions={},eP.on=eB,eP.addListener=eB,eP.once=eB,eP.off=eB,eP.removeListener=eB,eP.removeAllListeners=eB,eP.emit=eB,eP.prependListener=eB,eP.prependOnceListener=eB,eP.listeners=function(t){return[]},eP.binding=function(t){throw Error("process.binding is not supported")},eP.cwd=function(){return"/"},eP.chdir=function(t){throw Error("process.chdir is not supported")},eP.umask=function(){return 0};var eK="",eW=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),tY(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:tQ(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),eH=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return t0(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),ez=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new eW(e)}}catch(t){}return new eH},eG=ez("localStorage"),eQ=ez("sessionStorage"),eY=new eg("@firebase/database"),e$=function(){var t=1;return function(){return t++}}(),eX=function(t){var e=en(t),n=new t3;n.update(e);var r=n.digest();return tx.encodeByteArray(r)},eJ=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=eJ.apply(null,i):"object"==typeof i?n+=tY(i):n+=i,n+=" "}return n},eZ=null,e0=!0,e1=function(t,e){tk(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(eY.logLevel=sU.VERBOSE,eZ=eY.log.bind(eY),e&&eQ.set("logging_enabled",!0)):"function"==typeof t?eZ=t:(eZ=null,eQ.remove("logging_enabled"))},e2=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!0===e0&&(e0=!1,null===eZ&&!0===eQ.get("logging_enabled")&&e1(!0)),eZ&&eZ(eJ.apply(null,t))},e4=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e2.apply(void 0,tS([t],tE(e)))}},e3=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+eJ.apply(void 0,tS([],tE(t)));eY.error(n)},e6=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+eJ.apply(void 0,tS([],tE(t)));throw eY.error(n),Error(n)},e5=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+eJ.apply(void 0,tS([],tE(t)));eY.warn(n)},e8=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&e5("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},e7=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},e9=function(t){if(tV()||"complete"===document.readyState)t();else{var e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},nt="[MIN_NAME]",ne="[MAX_NAME]",nn=function(t,e){if(t===e)return 0;if(t===nt||e===ne)return -1;if(e===nt||t===ne)return 1;var n=nh(t),r=nh(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},nr=function(t,e){return t===e?0:t<e?-1:1},ni=function(t,e){if(e&&t in e)return e[t];throw Error("Missing required key ("+t+") in object: "+tY(e))},no=function(t){if("object"!=typeof t||null===t)return tY(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=tY(e[i])+":"+no(t[e[i]]);return r+"}"},ns=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function na(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var nu=function(t){tk(!e7(t),"Invalid JSON number"),0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=22250738585072014e-324?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-4503599627370496)):(n=0,r=Math.round(t/5e-324)));var e,n,r,i,o,s=[];for(o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();var a=s.join(""),u="";for(o=0;o<64;o+=8){var c=parseInt(a.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()},nc=RegExp("^-?(0*)\\d{1,10}$"),nh=function(t){if(nc.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},nl=function(t){try{t()}catch(t){setTimeout(function(){throw e5("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},nf=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},nd=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then(function(t){return n.appCheck=t})}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise(function(n,r){setTimeout(function(){e.appCheck?e.getToken(t).then(n,r):n(null)},0)})},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(function(e){return e.addTokenListener(t)})},t.prototype.notifyForInvalidToken=function(){e5('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),np=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(function(t){return r.auth_=t})}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch(function(t){return t&&"auth/token-not-initialized"===t.code?(e2("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)}):new Promise(function(n,r){setTimeout(function(){e.auth_?e.getToken(t).then(n,r):n(null)},0)})},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(function(e){return e.addAuthTokenListener(t)})},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then(function(e){return e.removeAuthTokenListener(t)})},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',e5(t)},t}(),nv=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),ng=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,nm="websocket",ny="long_polling",n_=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=eG.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&eG.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function nb(t,e,n){if(tk("string"==typeof e,"typeof type must == string"),tk("object"==typeof n,"typeof params must == object"),e===nm)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===ny)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw Error("Unknown connection type: "+e);(t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams)&&(n.ns=t.namespace);var r,i=[];return na(n,function(t,e){i.push(t+"="+e)}),r+i.join("&")}var nw=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),t0(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return tO(void 0,this.counters_)},t}(),nI={},nT={};function nE(t){var e=t.toString();return nI[e]||(nI[e]=new nw),nI[e]}var nS=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=this;this.pendingResponses[this.currentResponseNum]&&"break"!==function(){var t=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var e=function(e){t[e]&&nl(function(){n.onMessage_(t[e])})},i=0;i<t.length;++i)e(i);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++}(););},t}(),nC="start",nk=function(){function t(t,e,n,r,i,o,s){var a=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=e4(t),this.stats_=nE(e),this.urlFn=function(t){return a.appCheckToken&&(t.ac=a.appCheckToken),nb(e,ny,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new nS(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),e9(function(){if(!n.isClosed_){n.scriptTagHolder=new nN(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=tE(t,5),i=r[0],o=r[1],s=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder){if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===nC)n.id=o,n.password=s;else if("close"===i)o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,function(){n.onClosed_()})):n.onClosed_();else throw Error("Unrecognized command received: "+i)}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=tE(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)},function(){n.onClosed_()},n.urlFn);var t={};t[nC]="t",t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&ng.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!tV()&&(!!t.forceAllow_||!t.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){!this.isClosed_&&(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=tY(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=ns(tP(e),1840),r=0;r<n.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[r]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!tV()){this.myDisconnFrame=document.createElement("iframe");var n={};n.dframe="t",n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=tY(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),nN=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,tV())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=e$(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(o='<script>document.domain="'+document.domain+'";</script>');var s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(t){e2("frame writing exception"),t.stack&&e2(t.stack),e2(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||e2("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(!this.alive||!this.sendNewPolls||!(this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)))return!1;this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0;)if(this.pendingSegs[0].d.length+30+n.length<=1870){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}else break;return e+=n,this.addLongPollTag_(e,this.currentSerial),!0},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,function(){clearTimeout(i),r()})},t.prototype.addTag=function(t,e){var n=this;tV()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){e2("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}},Math.floor(1))},t}(),nA=null;"undefined"!=typeof MozWebSocket?nA=MozWebSocket:"undefined"!=typeof WebSocket&&(nA=WebSocket);var nR=function(){function t(e,n,r,i,o,s,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=e4(this.connId),this.stats_=nE(n),this.connURL=t.connectionURL_(n,s,a,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var i={};return i.v="5",!tV()&&"undefined"!=typeof location&&location.hostname&&ng.test(location.hostname)&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),r&&(i.ac=r),nb(t,nm,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,eG.set("previous_websocket_failure",!0);try{if(tV()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+eK+"/"+ex.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization=this.authToken),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var o={},s=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new nA(this.connURL,[],i)}else{var i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new nA(this.connURL,[],i)}}catch(t){this.log_("Error instantiating WebSocket.");var a=t.message||t.data;a&&this.log_(a),this.onClosed_();return}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&4.4>parseFloat(n[1])&&(e=!0)}return!e&&null!==nA&&!t.forceDisallow_},t.previouslyFailed=function(){return eG.isInMemoryStorage||!0===eG.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){eG.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=tQ(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(tk(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=tY(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=ns(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){!this.isClosed_&&(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),nx=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[nk,nR]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=nR&&nR.isAvailable(),o=i&&!nR.previouslyFailed();if(e.webSocketOnly&&(i||e5("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[nR];else{var s=this.transports_=[];try{for(var a=tT(t.ALL_TRANSPORTS),u=a.next();!u.done;u=a.next()){var c=u.value;c&&c.isAvailable()&&s.push(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),nP=function(){function t(t,e,n,r,i,o,s,a,u,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=e4("c:"+this.id+":"),this.transportManager_=new nx(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,r)},Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=nf(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){this.sendData_({t:"d",d:t})},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=ni("t",t),n=ni("d",t);if("c"===e)this.onSecondaryControl_(n);else if("d"===e)this.pendingDataMessages.push(n);else throw Error("Unknown protocol layer: "+e)},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=ni("t",t),n=ni("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){!this.isHealthy_&&(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=ni("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?e3("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):e3("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&e5("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),nf(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):nf(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(eG.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),nD=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),nO=function(){function t(t){this.allowedEvents_=t,this.listeners_={},tk(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=tS([],tE(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context)){r.splice(i,1);return}},t.prototype.validateEventType_=function(t){tk(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}(),nL=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||tU()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return t_(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return tk("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(nO),nM=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function nF(){return new nM("")}function nU(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function nj(t){return t.pieces_.length-t.pieceNum_}function nq(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new nM(t.pieces_,e)}function nV(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function nB(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function nK(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new nM(e,0)}function nW(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof nM)for(var r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else for(var i=e.split("/"),r=0;r<i.length;r++)i[r].length>0&&n.push(i[r]);return new nM(n,0)}function nH(t){return t.pieceNum_>=t.pieces_.length}function nz(t,e){var n=nU(t),r=nU(e);if(null===n)return e;if(n===r)return nz(nq(t),nq(e));throw Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function nG(t,e){for(var n=nB(t,0),r=nB(e,0),i=0;i<n.length&&i<r.length;i++){var o=nn(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function nQ(t,e){if(nj(t)!==nj(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function nY(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(nj(t)>nj(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var n$=function(t,e){this.errorPrefix_=e,this.parts_=nB(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=er(this.parts_[n]);nX(this)};function nX(t){if(t.byteLength_>768)throw Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+nJ(t))}function nJ(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var nZ=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))},!1),r}return t_(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return tk("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(nO),n0=function(t){function e(n,r,i,o,s,a,u,c){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=o,h.onServerInfoUpdate_=s,h.authTokenProvider_=a,h.appCheckTokenProvider_=u,h.authOverride_=c,h.id=e.nextPersistentConnectionId_++,h.log_=e4("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=1e3,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,c&&!tV())throw Error("Auth override specified in options, but not supported on non Node.js platforms");return nZ.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&nL.getInstance().on("online",h.onOnline_,h),h}return t_(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(tY(i)),tk(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new tL,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var t=e.outstandingGets_[o];void 0!==t&&i===t&&(delete e.outstandingGets_[o],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+o+" timed out on connection"),n.reject(Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(o),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var i=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),tk(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),tk(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var s={p:i};t.tag&&(s.q=r._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest("q",s,function(s){var a=s.d,u=s.s;e.warnOnListenWarnings_(a,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",s),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,a))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&t0(t,"w")){var n=t1(t,"w");Array.isArray(n)&&~n.indexOf("no_index")&&e5('Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ".indexOn": "'+e._queryParams.getIndex().toString()+'" at '+e._path.toString()+" to your security rules for better performance.")}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||tZ(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=tJ(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))})}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(e){var n=e.s,r=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)})},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),tk(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+tY(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else if("error"in t)throw"A server-side error has occurred: "+t.error;else"a"in t&&this.onDataPush_(t.a,t.b)},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):e3("Unrecognized action received from server: "+tY(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;tk(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){!t||this.visible_||this.reconnectDelay_!==this.maxReconnectDelay_||(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());var t=new Date().getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return tw(this,void 0,void 0,function(){var t,n,r,i,o,s,a,u,c,h,l,f,d,p,v=this;return tI(this,function(g){switch(g.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this.lastSessionId,s=!1,a=null,u=function(){a?a.close():(s=!0,r())},c=function(t){tk(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(t)},this.realtime_={close:u,sendRequest:c},h=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,g.label=1;case 1:return g.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)])];case 2:return f=(l=tE.apply(void 0,[g.sent(),2]))[0],d=l[1],s?e2("getToken() completed but was canceled"):(e2("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=d&&d.token,a=new nP(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,function(t){e5(t+" ("+v.repoInfo_.toString()+")"),v.interrupt("server_kill")},o)),[3,4];case 3:return p=g.sent(),this.log_("Failed to get token: "+p),s||(this.repoInfo_.nodeAdmin&&e5(p),u()),[3,4];case 4:return[2]}})})},e.prototype.interrupt=function(t){e2("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){e2("Resuming connection for reason: "+t),delete this.interruptReasons_[t],t2(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){n=e?e.map(function(t){return no(t)}).join("$"):"default";var n,r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new nM(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){e2("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){e2("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=tT(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,tT(s.values())),u=a.next();!u.done;u=a.next()){var c=u.value;this.sendListen_(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var l=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(l.action,l.pathString,l.data,l.onComplete)}for(var h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},e.prototype.sendConnectStats_=function(){var t={},e="js";tV()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+eK.replace(/\./g,"-")]=1,tU()?t["framework.cordova"]=1:tq()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=nL.getInstance().currentlyOnline();return t2(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(nD),n1=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),n2=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new n1(nt,t),r=new n1(nt,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return n1.MIN},t}(),n4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return sW},set:function(t){sW=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return nn(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw tN("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return n1.MIN},e.prototype.maxPost=function(){return new n1(ne,sW)},e.prototype.makePost=function(t,e){return tk("string"==typeof t,"KeyIndex indexValue must always be a string."),new n1(t,sW)},e.prototype.toString=function(){return".key"},e}(n2),n3=new n4,n6=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else if(0===o){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),n5=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:n7.EMPTY_NODE,this.right=null!=o?o:n7.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return n7.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(n=this,0>e(t,n.key))n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return n7.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){return Math.pow(2,this.check_())<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t===this.right.check_())return t+(this.isRed_()?0:1);throw Error("Black depths differ")},t.RED=!0,t.BLACK=!1,t}(),n8=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new n5(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),n7=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,n5.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,n5.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty()){if(r)return r.key;return null}for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new n6(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new n6(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new n6(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new n6(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new n8,t}();function n9(t,e){return nn(t.name,e.name)}function rt(t,e){return nn(t,e)}var re=function(t){return"number"==typeof t?"number:"+nu(t):"string:"+t},rn=function(t){if(t.isLeafNode()){var e=t.val();tk("string"==typeof e||"number"==typeof e||"object"==typeof e&&t0(e,".sv"),"Priority must be a string or number.")}else tk(t===sH||t.isEmpty(),"priority of unexpected type.");tk(t===sH||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},rr=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,tk(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),rn(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return sz},set:function(t){sz=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return nH(e)?this:".priority"===nU(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=nU(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:(tk(".priority"!==r||1===nj(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(nq(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+re(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":","number"===e?t+=nu(this.value_):t+=this.value_,this.lazyHash_=eX(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(tk(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return(tk(i>=0,"Unknown leaf type: "+n),tk(o>=0,"Unknown leaf type: "+r),i!==o)?o-i:"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){return t===this||!!t.isLeafNode()&&this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),ri=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?nn(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return n1.MIN},e.prototype.maxPost=function(){return new n1(ne,new rr("[PRIORITY-POST]",sQ))},e.prototype.makePost=function(t,e){var n=sG(t);return new n1(e,new rr("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(n2)),ro=Math.log(2),rs=function(){function t(t){this.count=parseInt(Math.log(t+1)/ro,10),this.current_=this.count-1;var e=parseInt(Array(this.count+1).join("1"),2);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),ra=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,s,a=r-e;if(0===a)return null;if(1===a)return o=t[e],s=n?n(o):o,new n5(s,o.node,n5.BLACK,null,null);var u=parseInt(a/2,10)+e,c=i(e,u),h=i(u+1,r);return o=t[u],s=n?n(o):o,new n5(s,o.node,n5.BLACK,c,h)},o=function(e){for(var r=null,o=null,s=t.length,a=function(e,r){var o=s-e,a=s;s-=e;var c=i(o+1,a),h=t[o],l=n?n(h):h;u(new n5(l,h.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var h=e.nextBitIsOne(),l=Math.pow(2,e.count-(c+1));h?a(l,n5.BLACK):(a(l,n5.BLACK),a(l,n5.RED))}return o}(new rs(t.length));return new n7(r||e,o)},ru={},rc=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return tk(ru&&ri,"ChildrenNode.ts has not been loaded"),sY=sY||new t({".priority":ru},{".priority":ri})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=t1(this.indexes_,t);if(!e)throw Error("No index defined for "+t);return e instanceof n7?e:null},t.prototype.hasIndex=function(t){return t0(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){tk(e!==n3,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,s=n.getIterator(n1.Wrap),a=s.getNext();a;)o=o||e.isDefinedOn(a.node),i.push(a),a=s.getNext();r=o?ra(i,e.getCompare()):ru;var u=e.toString(),c=tb({},this.indexSet_);c[u]=e;var h=tb({},this.indexes_);return h[u]=r,new t(h,c)},t.prototype.addToIndexes=function(e,n){var r=this,i=t4(this.indexes_,function(t,i){var o=t1(r.indexSet_,i);if(tk(o,"Missing index implementation for "+i),t===ru){if(!o.isDefinedOn(e.node))return ru;for(var s=[],a=n.getIterator(n1.Wrap),u=a.getNext();u;)u.name!==e.name&&s.push(u),u=a.getNext();return s.push(e),ra(s,o.getCompare())}var c=n.get(e.name),h=t;return c&&(h=h.remove(new n1(e.name,c))),h.insert(e,e.node)});return new t(i,this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){var r=t4(this.indexes_,function(t){if(t===ru)return t;var r=n.get(e.name);return r?t.remove(new n1(e.name,r)):t});return new t(r,this.indexSet_)},t}(),rh=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&rn(this.priorityNode_),this.children_.isEmpty()&&tk(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return s$||(s$=new t(new n7(rt),null,rc.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||s$},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?s$:e},t.prototype.getChild=function(t){var e=nU(t);return null===e?this:this.getImmediateChild(e).getChild(nq(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(tk(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new n1(e,n),i=void 0,o=void 0;n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?s$:this.priorityNode_;return new t(i,s,o)},t.prototype.updateChild=function(t,e){var n=nU(t);if(null===n)return e;tk(".priority"!==nU(t)||1===nj(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(nq(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(ri,function(s,a){n[s]=a.val(e),r++,o&&t.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1}),e||!o||!(i<2*r))return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n;var s=[];for(var a in n)s[a]=n[a];return s},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+re(this.getPriority().val())+":"),this.forEachChild(ri,function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)}),this.lazyHash_=""===t?"":eX(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(!r)return this.children_.getPredecessorKey(t);var i=r.getPredecessorKey(new n1(t,e));return i?i.name:null},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(!e)return this.children_.minKey();var n=e.minKey();return n&&n.name},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new n1(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(!e)return this.children_.maxKey();var n=e.maxKey();return n&&n.name},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new n1(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this.children_.getIteratorFrom(t.name,n1.Wrap),i=r.peek();null!=i&&0>e.compare(i,t);)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this.children_.getReverseIteratorFrom(t.name,n1.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===rl?-1:0},t.prototype.withIndex=function(e){if(e===n3||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===n3||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()||!this.getPriority().equals(t.getPriority())||this.children_.count()!==t.children_.count())return!1;for(var e=this.getIterator(ri),n=t.getIterator(ri),r=e.getNext(),i=n.getNext();r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i},t.prototype.resolveIndex_=function(t){return t===n3?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),rl=new(function(t){function e(){return t.call(this,new n7(rt),rh.EMPTY_NODE,rc.Default)||this}return t_(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return rh.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(rh));function rf(t,e){if(void 0===e&&(e=null),null===t)return rh.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),tk(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t){var n=t;return new rr(n,rf(e))}if(t instanceof Array){var r=rh.EMPTY_NODE;return na(t,function(e,n){if(t0(t,e)&&"."!==e.substring(0,1)){var i=rf(n);(i.isLeafNode()||!i.isEmpty())&&(r=r.updateImmediateChild(e,i))}}),r.updatePriority(rf(e))}var i=[],o=!1;if(na(t,function(t,e){if("."!==t.substring(0,1)){var n=rf(e);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),i.push(new n1(t,n)))}}),0===i.length)return rh.EMPTY_NODE;var s=ra(i,n9,function(t){return t.name},rt);if(!o)return new rh(s,rf(e),rc.Default);var a=ra(i,ri.getCompare());return new rh(s,rf(e),new rc({".priority":a},{".priority":ri}))}Object.defineProperties(n1,{MIN:{value:new n1(nt,rh.EMPTY_NODE)},MAX:{value:new n1(ne,rl)}}),n4.__EMPTY_NODE=rh.EMPTY_NODE,rr.__childrenNodeConstructor=rh,sH=rl,sQ=rl,sG=rf;var rd=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,tk(!nH(e)&&".priority"!==nU(e),"Can't create PathIndex with empty path or .priority key"),n}return t_(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?nn(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=rf(t),r=rh.EMPTY_NODE.updateChild(this.indexPath_,n);return new n1(e,r)},e.prototype.maxPost=function(){var t=rh.EMPTY_NODE.updateChild(this.indexPath_,rl);return new n1(ne,t)},e.prototype.toString=function(){return nB(this.indexPath_,0).join("/")},e}(n2),rp=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?nn(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return n1.MIN},e.prototype.maxPost=function(){return n1.MAX},e.prototype.makePost=function(t,e){var n=rf(t);return new n1(e,n)},e.prototype.toString=function(){return".value"},e}(n2)),rv="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",rg=function(){var t=0,e=[];return function(n){var r,i=n===t;t=n;var o=Array(8);for(r=7;r>=0;r--)o[r]=rv.charAt(n%64),n=Math.floor(n/64);tk(0===n,"Cannot push at time == 0");var s=o.join("");if(i){for(r=11;r>=0&&63===e[r];r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)s+=rv.charAt(e[r]);return tk(20===s.length,"nextPushId: Length should be 20."),s}}(),rm=function(t){if("2147483647"===t)return"-";var e=nh(t);if(null!=e)return""+(e+1);for(var n=Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return ne;var o=n[i],s=rv.charAt(rv.indexOf(o)+1);return n[i]=s,n.slice(0,i+1).join("")},ry=function(t){if("-2147483648"===t)return nt;var e=nh(t);if(null!=e)return""+(e-1);for(var n=Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=rv.charAt(rv.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function r_(t){return{type:"value",snapshotNode:t}}function rb(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function rw(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function rI(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var rT=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){tk(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(rw(e,s)):tk(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(rb(e,n)):o.trackChildChange(rI(e,n,s))),t.isLeafNode()&&n.isEmpty())?t:t.updateImmediateChild(e,n).withIndex(this.index_)},t.prototype.updateFullNode=function(t,e,n){return null==n||(t.isLeafNode()||t.forEachChild(ri,function(t,r){e.hasChild(t)||n.trackChildChange(rw(t,r))}),e.isLeafNode()||e.forEachChild(ri,function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(rI(e,r,i))}else n.trackChildChange(rb(e,r))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?rh.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),rE=function(){function t(e){this.indexedFilter_=new rT(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return 0>=this.index_.compare(this.getStartPost(),t)&&0>=this.index_.compare(t,this.getEndPost())},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new n1(e,n))||(n=rh.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=rh.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(rh.EMPTY_NODE);var i=this;return e.forEachChild(ri,function(t,e){i.matches(new n1(t,e))||(r=r.updateImmediateChild(t,rh.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(!t.hasStart())return t.getIndex().minPost();var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)},t.getEndPost_=function(t){if(!t.hasEnd())return t.getIndex().maxPost();var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)},t}(),rS=function(){function t(t){this.rangedFilter_=new rE(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return(this.rangedFilter_.matches(new n1(e,n))||(n=rh.EMPTY_NODE),t.getImmediateChild(e).equals(n))?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=rh.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=rh.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext(),a=void 0;if(a=this.reverse_?0>=this.index_.compare(this.rangedFilter_.getStartPost(),s):0>=this.index_.compare(s,this.rangedFilter_.getEndPost()))r=r.updateImmediateChild(s.name,s.node),o++;else break}}else{r=(r=e.withIndex(this.index_)).updatePriority(rh.EMPTY_NODE);var u=void 0,c=void 0,h=void 0,i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();h=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();for(var o=0,f=!1;i.hasNext();){var s=i.getNext();!f&&0>=h(u,s)&&(f=!0);var a=f&&o<this.limit_&&0>=h(s,c);a?o++:r=r.updateImmediateChild(s.name,rh.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){if(this.reverse_){var o,s=this.index_.getCompare();o=function(t,e){return s(e,t)}}else o=this.index_.getCompare();tk(t.numChildren()===this.limit_,"");var a=new n1(e,n),u=this.reverse_?t.getFirstChild(this.index_):t.getLastChild(this.index_),c=this.rangedFilter_.matches(a);if(t.hasChild(e)){for(var h=t.getImmediateChild(e),l=r.getChildAfterChild(this.index_,u,this.reverse_);null!=l&&(l.name===e||t.hasChild(l.name));)l=r.getChildAfterChild(this.index_,l,this.reverse_);var f=null==l?1:o(l,a);if(c&&!n.isEmpty()&&f>=0)return null!=i&&i.trackChildChange(rI(e,n,h)),t.updateImmediateChild(e,n);null!=i&&i.trackChildChange(rw(e,h));var d=t.updateImmediateChild(e,rh.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=i&&i.trackChildChange(rb(l.name,l.node)),d.updateImmediateChild(l.name,l.node)):d}return n.isEmpty()?t:c&&o(u,a)>=0?(null!=i&&(i.trackChildChange(rw(u.name,u.node)),i.trackChildChange(rb(e,n))),t.updateImmediateChild(e,n).updateImmediateChild(u.name,rh.EMPTY_NODE)):t},t}(),rC=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ri}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return tk(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(tk(this.startSet_,"Only valid if start has been set"),this.startNameSet_)?this.indexStartName_:nt},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return tk(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(tk(this.endSet_,"Only valid if end has been set"),this.endNameSet_)?this.indexEndName_:ne},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return tk(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===ri},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function rk(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function rN(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function rA(t,e){var n=t.copy();return n.index_=e,n}function rR(t){var e,n={};return t.isDefault()||(t.index_===ri?e="$priority":t.index_===rp?e="$value":t.index_===n3?e="$key":(tk(t.index_ instanceof rd,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=tY(e),t.startSet_&&(n.startAt=tY(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+tY(t.indexStartName_))),t.endSet_&&(n.endAt=tY(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+tY(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function rx(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==ri&&(e.i=t.index_.toString()),e}var rP=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=e4("p:rest:"),o.listens_={},o}return t_(e,t),e.prototype.reportStats=function(t){throw Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(tk(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);var a=e.getListenId_(t,r),u={};this.listens_[a]=u;var c=rR(t._queryParams);this.restRequest_(s+".json",c,function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(s,n,!1,r),t1(o.listens_,a)===u&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)})},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=rR(t._queryParams),r=t._path.toString(),i=new tL;return this.restRequest_(r+".json",n,function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(Error(o))}),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(i){var o=tE(i,2),s=o[0],a=o[1];s&&s.accessToken&&(e.auth=s.accessToken),a&&a.token&&(e.ac=a.token);var u=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}(e);r.log_("Sending REST request for "+u);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(n&&4===c.readyState){r.log_("REST Response for "+u+" received. status:",c.status,"response:",c.responseText);var t=null;if(c.status>=200&&c.status<300){try{t=tQ(c.responseText)}catch(t){e5("Failed to parse JSON response for "+u+": "+c.responseText)}n(null,t)}else 401!==c.status&&404!==c.status&&e5("Got unsuccessful REST response for "+u+" Status: "+c.status),n(c.status);n=null}},c.open("GET",u,!0),c.send()})},e}(nD),rD=function(){function t(){this.rootNode_=rh.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function rO(){return{value:null,children:new Map}}function rL(t,e,n){if(nH(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=nU(e);t.children.has(r)||t.children.set(r,rO()),rL(t.children.get(r),e=nq(e),n)}}function rM(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach(function(t,n){e(n,t)})}(t,function(t,r){rM(r,new nM(e.toString()+"/"+t),n)})}var rF=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=tb({},t);return this.last_&&na(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}(),rU=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new rF(t),nf(this.reportStats_.bind(this),Math.floor(1e4+2e4*Math.random()))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;na(e,function(e,i){i>0&&t0(t.statsToReport_,e)&&(n[e]=i,r=!0)}),r&&this.server_.reportStats(n),nf(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();function rj(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function rq(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function rV(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(sX||(sX={}));var rB=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=sX.ACK_USER_WRITE,this.source=rj()}return t.prototype.operationForChild=function(e){if(!nH(this.path))return tk(nU(this.path)===e,"operationForChild called for unrelated child."),new t(nq(this.path),this.affectedTree,this.revert);if(null!=this.affectedTree.value)return tk(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new nM(e));return new t(nF(),n,this.revert)},t}(),rK=function(){function t(t,e){this.source=t,this.path=e,this.type=sX.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return nH(this.path)?new t(this.source,nF()):new t(this.source,nq(this.path))},t}(),rW=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=sX.OVERWRITE}return t.prototype.operationForChild=function(e){return nH(this.path)?new t(this.source,nF(),this.snap.getImmediateChild(e)):new t(this.source,nq(this.path),this.snap)},t}(),rH=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=sX.MERGE}return t.prototype.operationForChild=function(e){if(!nH(this.path))return tk(nU(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,nq(this.path),this.children);var n=this.children.subtree(new nM(e));return n.isEmpty()?null:n.value?new rW(this.source,nF(),n.value):new t(this.source,nF(),n)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),rz=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(nH(t))return this.isFullyInitialized()&&!this.filtered_;var e=nU(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),rG=function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()};function rQ(t,e,n,r,i,o){var s=r.filter(function(t){return t.type===n});s.sort(function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw tN("Should only compare child_ events.");var r=new n1(e.childName,e.snapshotNode),i=new n1(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n)}),s.forEach(function(n){var r=("value"===n.type||"child_removed"===n.type||(n.prevName=o.getPredecessorChildName(n.childName,n.snapshotNode,t.index_)),n);i.forEach(function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))})})}function rY(t,e){return{eventCache:t,serverCache:e}}function r$(t,e,n,r){return rY(new rz(e,n,r),t.serverCache)}function rX(t,e,n,r){return rY(t.eventCache,new rz(e,n,r))}function rJ(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function rZ(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var r0=function(){function t(t,e){void 0===e&&(sJ||(sJ=new n7(nr)),e=sJ),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return na(e,function(t,e){n=n.set(new nM(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:nF(),value:this.value};if(nH(t))return null;var n=nU(t),r=this.children.get(n);if(null===r)return null;var i=r.findRootMostMatchingPathAndValue(nq(t),e);return null!=i?{path:nW(new nM(n),i.path),value:i.value}:null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(nH(e))return this;var n=nU(e),r=this.children.get(n);return null!==r?r.subtree(nq(e)):new t(null)},t.prototype.set=function(e,n){if(nH(e))return new t(n,this.children);var r=nU(e),i=(this.children.get(r)||new t(null)).set(nq(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(nH(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=nU(e),r=this.children.get(n);if(!r)return this;var i=r.remove(nq(e)),o=void 0;return(o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty())?new t(null):new t(this.value,o)},t.prototype.get=function(t){if(nH(t))return this.value;var e=nU(t),n=this.children.get(e);return n?n.get(nq(t)):null},t.prototype.setTree=function(e,n){if(nH(e))return n;var r=nU(e),i=(this.children.get(r)||new t(null)).setTree(nq(e),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(nF(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(nW(t,r),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,nF(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(nH(t))return null;var i=nU(t),o=this.children.get(i);return o?o.findOnPath_(nq(t),nW(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,nF(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(nH(e))return this;this.value&&r(n,this.value);var i=nU(e),o=this.children.get(i);return o?o.foreachOnPath_(nq(e),nW(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(nF(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,r){r.foreach_(nW(t,n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t}(),r1=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new r0(null))},t}();function r2(t,e,n){if(nH(e))return new r1(new r0(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,s=nz(i,e);return o=o.updateChild(s,n),new r1(t.writeTree_.set(i,o))}var a=new r0(n),u=t.writeTree_.setTree(e,a);return new r1(u)}function r4(t,e,n){var r=t;return na(n,function(t,n){r=r2(r,nW(e,t),n)}),r}function r3(t,e){if(nH(e))return r1.empty();var n=t.writeTree_.setTree(e,new r0(null));return new r1(n)}function r6(t,e){return null!=r5(t,e)}function r5(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(nz(n.path,e)):null}function r8(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ri,function(t,n){e.push(new n1(t,n))}):t.writeTree_.children.inorderTraversal(function(t,n){null!=n.value&&e.push(new n1(t,n.value))}),e}function r7(t,e){if(nH(e))return t;var n=r5(t,e);return new r1(null!=n?new r0(n):t.writeTree_.subtree(e))}function r9(t){return t.writeTree_.isEmpty()}function it(t,e){return function t(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(tk(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=t(nW(e,n),o,r)}),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(nW(e,".priority"),i)),r}(nF(),t.writeTree_,e)}function ie(t){return t.visible}function ir(t,e,n){for(var r=r1.empty(),i=0;i<t.length;++i){var o=t[i];if(e(o)){var s=o.path,a=void 0;if(o.snap)nY(n,s)?r=r2(r,a=nz(n,s),o.snap):nY(s,n)&&(a=nz(s,n),r=r2(r,nF(),o.snap.getChild(a)));else if(o.children){if(nY(n,s))r=r4(r,a=nz(n,s),o.children);else if(nY(s,n)){if(nH(a=nz(s,n)))r=r4(r,nF(),o.children);else{var u=t1(o.children,nU(a));if(u){var c=u.getChild(nq(a));r=r2(r,nF(),c)}}}}else throw tN("WriteRecord should have .snap or .children")}}return r}function ii(t,e,n,r,i){if(r||i){var o=r7(t.visibleWrites,e);if(!i&&r9(o))return n;if(!i&&null==n&&!r6(o,nF()))return null;var s=ir(t.allWrites,function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(nY(t.path,e)||nY(e,t.path))},e),a=n||rh.EMPTY_NODE;return it(s,a)}var u=r5(t.visibleWrites,e);if(null!=u)return u;var c=r7(t.visibleWrites,e);if(r9(c))return n;if(null==n&&!r6(c,nF()))return null;var a=n||rh.EMPTY_NODE;return it(c,a)}function io(t,e,n,r){return ii(t.writeTree,t.treePath,e,n,r)}function is(t,e){return function(t,e,n){var r=rh.EMPTY_NODE,i=r5(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ri,function(t,e){r=r.updateImmediateChild(t,e)}),r;if(!n)return r8(r7(t.visibleWrites,e)).forEach(function(t){r=r.updateImmediateChild(t.name,t.node)}),r;var o=r7(t.visibleWrites,e);return n.forEachChild(ri,function(t,e){var n=it(r7(o,new nM(t)),e);r=r.updateImmediateChild(t,n)}),r8(o).forEach(function(t){r=r.updateImmediateChild(t.name,t.node)}),r}(t.writeTree,t.treePath,e)}function ia(t,e,n,r){return function(t,e,n,r,i){tk(r||i,"Either existingEventSnap or existingServerSnap must exist");var o=nW(e,n);if(r6(t.visibleWrites,o))return null;var s=r7(t.visibleWrites,o);return r9(s)?i.getChild(n):it(s,i.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function iu(t,e){var n,r;return n=t.writeTree,r=nW(t.treePath,e),r5(n.visibleWrites,r)}function ic(t,e,n){var r,i,o;return r=t.writeTree,i=nW(t.treePath,e),null!=(o=r5(r.visibleWrites,i))?o:n.isCompleteForChild(e)?it(r7(r.visibleWrites,i),n.getNode().getImmediateChild(e)):null}function ih(t,e){return il(nW(t.treePath,e),t.writeTree)}function il(t,e){return{treePath:t,writeTree:e}}var id=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;tk("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),tk(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,rI(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,rw(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,rb(n,t.snapshotNode));else if("child_changed"===e&&"child_changed"===i)this.changeMap.set(n,rI(n,t.snapshotNode,r.oldSnap));else throw tN("Illegal combination of changes: "+t+" occurred after "+r)}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),ip=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),iv=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new rz(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ic(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r,i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:rZ(this.viewCache_),o=function(t,e,n,r,i,o,s){var a,u=r7(t.visibleWrites,e),c=r5(u,nF());if(null!=c)a=c;else{if(null==n)return[];a=it(u,n)}if((a=a.withIndex(s)).isEmpty()||a.isLeafNode())return[];for(var h=[],l=s.getCompare(),f=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),d=f.getNext();d&&h.length<1;)0!==l(d,r)&&h.push(d),d=f.getNext();return h}((r=this.writes_).writeTree,r.treePath,i,e,0,n,t);return 0===o.length?null:o[0]},t}();function ig(t,e,n,r,i,o){var s=e.eventCache;if(null!=iu(r,n))return e;var a=void 0,u=void 0;if(nH(n)){if(tk(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var c=rZ(e),h=is(r,c instanceof rh?c:rh.EMPTY_NODE);a=t.filter.updateFullNode(e.eventCache.getNode(),h,o)}else{var l=io(r,rZ(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,o)}}else{var f=nU(n);if(".priority"===f){tk(1===nj(n),"Can't have a priority with additional path components");var d=s.getNode(),p=ia(r,n,d,u=e.serverCache.getNode());a=null!=p?t.filter.updatePriority(d,p):s.getNode()}else{var v=nq(n),g=void 0;if(s.isCompleteForChild(f)){u=e.serverCache.getNode();var m=ia(r,n,s.getNode(),u);g=null!=m?s.getNode().getImmediateChild(f).updateChild(v,m):s.getNode().getImmediateChild(f)}else g=ic(r,f,e.serverCache);a=null!=g?t.filter.updateChild(s.getNode(),f,g,v,i,o):s.getNode()}}return r$(e,a,s.isFullyInitialized()||nH(n),t.filter.filtersNodes())}function im(t,e,n,r,i,o,s,a){var u,c=e.serverCache,h=s?t.filter:t.filter.getIndexedFilter();if(nH(n))u=h.updateFullNode(c.getNode(),r,null);else if(h.filtersNodes()&&!c.isFiltered()){var l=c.getNode().updateChild(n,r);u=h.updateFullNode(c.getNode(),l,null)}else{var f=nU(n);if(!c.isCompleteForPath(n)&&nj(n)>1)return e;var d=nq(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?h.updatePriority(c.getNode(),p):h.updateChild(c.getNode(),f,p,d,ip,null)}var v=rX(e,u,c.isFullyInitialized()||nH(n),h.filtersNodes()),g=new iv(i,v,o);return ig(t,v,n,i,g,a)}function iy(t,e,n,r,i,o,s){var a,u,c=e.eventCache,h=new iv(i,e,o);if(nH(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,s),a=r$(e,u,!0,t.filter.filtersNodes());else{var l=nU(n);if(".priority"===l)u=t.filter.updatePriority(e.eventCache.getNode(),r),a=r$(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=nq(n),d=c.getNode().getImmediateChild(l),p=void 0;if(nH(f))p=r;else{var v=h.getCompleteChild(l);p=null!=v?".priority"===nV(f)&&v.getChild(nK(f)).isEmpty()?v:v.updateChild(f,r):rh.EMPTY_NODE}if(d.equals(p))a=e;else{var g=t.filter.updateChild(c.getNode(),l,p,f,h,s);a=r$(e,g,c.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function i_(t,e){return t.eventCache.isCompleteForChild(e)}function ib(t,e,n){return n.foreach(function(t,n){e=e.updateChild(t,n)}),e}function iw(t,e,n,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=nH(n)?r:new r0(null).setTree(n,r);var h=e.serverCache.getNode();return u.children.inorderTraversal(function(n,r){if(h.hasChild(n)){var u=ib(t,e.serverCache.getNode().getImmediateChild(n),r);c=im(t,c,new nM(n),u,i,o,s,a)}}),u.children.inorderTraversal(function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!h.hasChild(n)&&!u){var l=ib(t,e.serverCache.getNode().getImmediateChild(n),r);c=im(t,c,new nM(n),l,i,o,s,a)}}),c}var iI=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_._queryParams,r=new rT(n.getIndex()),i=n.loadsAllData()?new rT(n.getIndex()):n.hasLimit()?new rS(n):new rE(n);this.processor_={filter:i};var o=e.serverCache,s=e.eventCache,a=r.updateFullNode(rh.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(rh.EMPTY_NODE,s.getNode(),null),c=new rz(a,o.isFullyInitialized(),r.filtersNodes()),h=new rz(u,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=rY(h,c),this.eventGenerator_=new rG(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function iT(t){return 0===t.eventRegistrations_.length}function iE(t,e,n){var r=[];if(n){tk(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach(function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)})}if(e){for(var o=[],s=0;s<t.eventRegistrations_.length;++s){var a=t.eventRegistrations_[s];if(a.matches(e)){if(e.hasAnyCallback()){o=o.concat(t.eventRegistrations_.slice(s+1));break}}else o.push(a)}t.eventRegistrations_=o}else t.eventRegistrations_=[];return r}function iS(t,e,n,r){e.type===sX.MERGE&&null!==e.source.queryId&&(tk(rZ(t.viewCache_),"We should always have a full cache before handling merges"),tk(rJ(t.viewCache_),"Missing event cache, even though we have a server cache"));var i,o,s=t.viewCache_,a=function(t,e,n,r,i){var o,s,a,u,c,h,l,f=new id;if(n.type===sX.OVERWRITE)n.source.fromUser?h=iy(t,e,n.path,n.snap,r,i,f):(tk(n.source.fromServer,"Unknown source."),l=n.source.tagged||e.serverCache.isFiltered()&&!nH(n.path),h=im(t,e,n.path,n.snap,r,i,l,f));else if(n.type===sX.MERGE)n.source.fromUser?(o=n.path,s=n.children,a=e,s.foreach(function(n,s){var u=nW(o,n);i_(e,nU(u))&&(a=iy(t,a,u,s,r,i,f))}),s.foreach(function(n,s){var u=nW(o,n);i_(e,nU(u))||(a=iy(t,a,u,s,r,i,f))}),h=a):(tk(n.source.fromServer,"Unknown source."),l=n.source.tagged||e.serverCache.isFiltered(),h=iw(t,e,n.path,n.children,r,i,l,f));else if(n.type===sX.ACK_USER_WRITE)h=n.revert?function(t,e,n,r,i,o){if(null!=iu(r,n))return e;var s,a=new iv(r,e,i),u=e.eventCache.getNode(),c=void 0;if(nH(n)||".priority"===nU(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=io(r,rZ(e));else{var l=e.serverCache.getNode();tk(l instanceof rh,"serverChildren would be complete if leaf node"),h=is(r,l)}c=t.filter.updateFullNode(u,h,o)}else{var f=nU(n),d=ic(r,f,e.serverCache);null==d&&e.serverCache.isCompleteForChild(f)&&(d=u.getImmediateChild(f)),(c=null!=d?t.filter.updateChild(u,f,d,nq(n),a,o):e.eventCache.getNode().hasChild(f)?t.filter.updateChild(u,f,rh.EMPTY_NODE,nq(n),a,o):u).isEmpty()&&e.serverCache.isFullyInitialized()&&(s=io(r,rZ(e))).isLeafNode()&&(c=t.filter.updateFullNode(c,s,o))}return s=e.serverCache.isFullyInitialized()||null!=iu(r,nF()),r$(e,c,s,t.filter.filtersNodes())}(t,e,n.path,r,i,f):function(t,e,n,r,i,o,s){if(null!=iu(i,n))return e;var a=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(nH(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return im(t,e,n,u.getNode().getChild(n),i,o,a,s);if(!nH(n))return e;var c=new r0(null);return u.getNode().forEachChild(n3,function(t,e){c=c.set(new nM(t),e)}),iw(t,e,n,c,i,o,a,s)}var h=new r0(null);return r.foreach(function(t,e){var r=nW(n,t);u.isCompleteForPath(r)&&(h=h.set(t,u.getNode().getChild(r)))}),iw(t,e,n,h,i,o,a,s)}(t,e,n.path,n.affectedTree,r,i,f);else if(n.type===sX.LISTEN_COMPLETE)u=n.path,c=e.serverCache,h=ig(t,rX(e,c.getNode(),c.isFullyInitialized()||nH(u),c.isFiltered()),u,r,ip,f);else throw tN("Unknown operation type: "+n.type);var d=f.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=rJ(t);!(n.length>0)&&t.eventCache.isFullyInitialized()&&(!i||r.getNode().equals(o))&&r.getNode().getPriority().equals(o.getPriority())||n.push(r_(rJ(e)))}}(e,h,d),{viewCache:h,changes:d}}(t.processor_,s,e,n,r);return i=t.processor_,tk((o=a.viewCache).eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),tk(o.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),tk(a.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=a.viewCache,iC(t,a.changes,a.viewCache.eventCache.getNode(),null)}function iC(t,e,n,r){var i,o,s,a=r?[r]:t.eventRegistrations_;return i=t.eventGenerator_,o=[],s=[],e.forEach(function(t){if("child_changed"===t.type&&i.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)){var e;s.push((e=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:e}))}}),rQ(i,o,"child_removed",e,a,n),rQ(i,o,"child_added",e,a,n),rQ(i,o,"child_moved",s,a,n),rQ(i,o,"child_changed",e,a,n),rQ(i,o,"value",e,a,n),o}var ik=function(){this.views=new Map};function iN(t,e,n,r){var i,o,s=e.source.queryId;if(null!==s){var a=t.views.get(s);return tk(null!=a,"SyncTree gave us an op for an invalid query."),iS(a,e,n,r)}var u=[];try{for(var c=tT(t.views.values()),h=c.next();!h.done;h=c.next()){var a=h.value;u=u.concat(iS(a,e,n,r))}}catch(t){i={error:t}}finally{try{h&&!h.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return u}function iA(t,e,n,r,i){var o=e._queryIdentifier,s=t.views.get(o);if(!s){var a=io(n,i?r:null),u=!1;a?u=!0:r instanceof rh?(a=is(n,r),u=!1):(a=rh.EMPTY_NODE,u=!1);var c=rY(new rz(a,u,!1),new rz(r,i,!1));return new iI(e,c)}return s}function iR(t){var e,n,r=[];try{for(var i=tT(t.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function ix(t,e){var n,r,i=null;try{for(var o=tT(t.views.values()),s=o.next();!s.done;s=o.next()){var a=s.value;i=i||function(t,e){var n=rZ(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!nH(e)&&!n.getImmediateChild(nU(e)).isEmpty())?n.getChild(e):null}(a,e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function iP(t,e){if(e._queryParams.loadsAllData())return iO(t);var n=e._queryIdentifier;return t.views.get(n)}function iD(t){return null!=iO(t)}function iO(t){var e,n;try{for(var r=tT(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}var iL=1,iM=function(t){this.listenProvider_=t,this.syncPointTree_=new r0(null),this.pendingWriteTree_={visibleWrites:r1.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function iF(t,e,n,r,i){var o,s;return(o=t.pendingWriteTree_,s=i,tk(r>o.lastWriteId,"Stacking an older write on top of newer ones"),void 0===s&&(s=!0),o.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(o.visibleWrites=r2(o.visibleWrites,e,n)),o.lastWriteId=r,i)?iK(t,new rW(rj(),e,n)):[]}function iU(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(!function(t,e){var n=t.allWrites.findIndex(function(t){return t.writeId===e});tk(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var i=r.visible,o=!1,s=t.allWrites.length-1;i&&s>=0;){var a=t.allWrites[s];a.visible&&(s>=n&&function(t,e){if(t.snap)return nY(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&nY(nW(t.path,n),e))return!0;return!1}(a,r.path)?i=!1:nY(r.path,a.path)&&(o=!0)),s--}return!!i&&(o?(t.visibleWrites=ir(t.allWrites,ie,nF()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1,!0):(r.snap?t.visibleWrites=r3(t.visibleWrites,r.path):na(r.children,function(e){t.visibleWrites=r3(t.visibleWrites,nW(r.path,e))}),!0))}(t.pendingWriteTree_,e))return[];var i=new r0(null);return null!=r.snap?i=i.set(nF(),!0):na(r.children,function(t){i=i.set(new nM(t),!0)}),iK(t,new rB(r.path,i,n))}function ij(t,e,n){return iK(t,new rW(rq(),e,n))}function iq(t,e,n,r){var i=e._path,o=t.syncPointTree_.get(i),s=[];if(o&&("default"===e._queryIdentifier||null!=iP(o,e))){var a=function(t,e,n,r){var i,o,s=e._queryIdentifier,a=[],u=[],c=iD(t);if("default"===s)try{for(var h=tT(t.views.entries()),l=h.next();!l.done;l=h.next()){var f=tE(l.value,2),d=f[0],p=f[1];u=u.concat(iE(p,n,r)),iT(p)&&(t.views.delete(d),p.query._queryParams.loadsAllData()||a.push(p.query))}}catch(t){i={error:t}}finally{try{l&&!l.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else{var p=t.views.get(s);p&&(u=u.concat(iE(p,n,r)),iT(p)&&(t.views.delete(s),p.query._queryParams.loadsAllData()||a.push(p.query)))}return c&&!iD(t)&&a.push(new(tk(sZ,"Reference.ts has not been loaded"),sZ)(e._repo,e._path)),{removed:a,events:u}}(o,e,n,r);0===o.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(i));var u=a.removed;s=a.events;var c=-1!==u.findIndex(function(t){return t._queryParams.loadsAllData()}),h=t.syncPointTree_.findOnPath(i,function(t,e){return iD(e)});if(c&&!h){var l=t.syncPointTree_.subtree(i);if(!l.isEmpty())for(var f=l.fold(function(t,e,n){if(e&&iD(e))return[iO(e)];var r=[];return e&&(r=iR(e)),na(n,function(t,e){r=r.concat(e)}),r}),d=0;d<f.length;++d){var p=f[d],v=p.query,g=iW(t,p);t.listenProvider_.startListening(i$(v),iH(t,v),g.hashFn,g.onComplete)}}h||!(u.length>0)||r||(c?t.listenProvider_.stopListening(i$(e),null):u.forEach(function(e){var n=t.queryToTagMap.get(iz(e));t.listenProvider_.stopListening(i$(e),n)})),function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=iz(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,u)}return s}function iV(t,e,n){var r,i,o,s,a,u,c=e._path,h=null,l=!1;t.syncPointTree_.foreachOnPath(c,function(t,e){var n=nz(t,c);h=h||ix(e,n),l=l||iD(e)});var f=t.syncPointTree_.get(c);f?(l=l||iD(f),h=h||ix(f,nF())):(f=new ik,t.syncPointTree_=t.syncPointTree_.set(c,f)),null!=h?u=!0:(u=!1,h=rh.EMPTY_NODE,t.syncPointTree_.subtree(c).foreachChild(function(t,e){var n=ix(e,nF());n&&(h=h.updateImmediateChild(t,n))}));var d=null!=iP(f,e);if(!d&&!e._queryParams.loadsAllData()){var p=iz(e);tk(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");var v=iL++;t.queryToTagMap.set(p,v),t.tagToQueryMap.set(v,p)}var g=(r=t.pendingWriteTree_,il(c,r)),m=(o=iA(i=f,e,g,h,u),i.views.has(e._queryIdentifier)||i.views.set(e._queryIdentifier,o),!function(t,e){t.eventRegistrations_.push(e)}(o,n),s=o.viewCache_.eventCache,a=[],s.getNode().isLeafNode()||s.getNode().forEachChild(ri,function(t,e){a.push(rb(t,e))}),s.isFullyInitialized()&&a.push(r_(s.getNode())),iC(o,a,s.getNode(),n));if(!d&&!l){var y=iP(f,e);m=m.concat(function(t,e,n){var r=e._path,i=iH(t,e),o=iW(t,n),s=t.listenProvider_.startListening(i$(e),i,o.hashFn,o.onComplete),a=t.syncPointTree_.subtree(r);if(i)tk(!iD(a.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=a.fold(function(t,e,n){if(!nH(t)&&e&&iD(e))return[iO(e).query];var r=[];return e&&(r=r.concat(iR(e).map(function(t){return t.query}))),na(n,function(t,e){r=r.concat(e)}),r}),c=0;c<u.length;++c){var h=u[c];t.listenProvider_.stopListening(i$(h),iH(t,h))}return s}(t,e,y))}return m}function iB(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,function(t,n){var r=ix(n,nz(t,e));if(r)return r});return ii(r,e,i,n,!0)}function iK(t,e){var n;return function t(e,n,r,i){if(nH(e.path))return function t(e,n,r,i){var o=n.get(nF());null==r&&null!=o&&(r=ix(o,nF()));var s=[];return n.children.inorderTraversal(function(n,o){var a=r?r.getImmediateChild(n):null,u=ih(i,n),c=e.operationForChild(n);c&&(s=s.concat(t(c,o,a,u)))}),o&&(s=s.concat(iN(o,e,i,r))),s}(e,n,r,i);var o=n.get(nF());null==r&&null!=o&&(r=ix(o,nF()));var s=[],a=nU(e.path),u=e.operationForChild(a),c=n.children.get(a);if(c&&u){var h=r?r.getImmediateChild(a):null,l=ih(i,a);s=s.concat(t(u,c,h,l))}return o&&(s=s.concat(iN(o,e,i,r))),s}(e,t.syncPointTree_,null,(n=t.pendingWriteTree_,il(nF(),n)))}function iW(t,e){var n=e.query,r=iH(t,n);return{hashFn:function(){return(e.viewCache_.serverCache.getNode()||rh.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=iG(t,n);if(!r)return[];var i=iQ(r),o=i.path,s=i.queryId,a=nz(o,e),u=new rK(rV(s),a);return iY(t,o,u)}(t,n._path,r):(i=n._path,iK(t,new rK(rq(),i)));var i,o,s,a=(o="Unknown Error","too_big"===e?o="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?o="Client doesn't have permission to access the desired data.":"unavailable"===e&&(o="The service is unavailable"),(s=Error(e+" at "+n._path.toString()+": "+o)).code=e.toUpperCase(),s);return iq(t,n,null,a)}}}function iH(t,e){var n=iz(e);return t.queryToTagMap.get(n)}function iz(t){return t._path.toString()+"$"+t._queryIdentifier}function iG(t,e){return t.tagToQueryMap.get(e)}function iQ(t){var e=t.indexOf("$");return tk(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new nM(t.substr(0,e))}}function iY(t,e,n){var r=t.syncPointTree_.get(e);return tk(r,"Missing sync point for query tag that we're tracking"),iN(r,n,il(e,t.pendingWriteTree_),null)}function i$(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(tk(s0,"Reference.ts has not been loaded"),s0)(t._repo,t._path):t}var iX=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){var n=this.node_.getImmediateChild(e);return new t(n)},t.prototype.node=function(){return this.node_},t}(),iJ=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=nW(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return iB(this.syncTree_,this.path_)},t}(),iZ=function(t,e,n){return t&&"object"==typeof t?(tk(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"])?i0(t[".sv"],e,n):"object"==typeof t[".sv"]?i1(t[".sv"],e):void tk(!1,"Unexpected server value: "+JSON.stringify(t,null,2)):t},i0=function(t,e,n){if("timestamp"===t)return n.timestamp;tk(!1,"Unexpected server value: "+t)},i1=function(t,e,n){t.hasOwnProperty("increment")||tk(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&tk(!1,"Unexpected increment value: "+r);var i=e.node();if(tk(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var o=i.getValue();return"number"!=typeof o?r:o+r},i2=function(t,e,n,r){return i3(e,new iJ(n,t),r)},i4=function(t,e,n){return i3(t,new iX(e),n)};function i3(t,e,n){var r,i=iZ(t.getPriority().val(),e.getImmediateChild(".priority"),n);if(!t.isLeafNode())return r=t,i!==t.getPriority().val()&&(r=r.updatePriority(new rr(i))),t.forEachChild(ri,function(t,i){var o=i3(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))}),r;var o=iZ(t.getValue(),e,n);return o!==t.getValue()||i!==t.getPriority().val()?new rr(o,rf(i)):t}var i6=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function i5(t,e){for(var n=e instanceof nM?e:new nM(e),r=t,i=nU(n);null!==i;){var o=t1(r.node.children,i)||{children:{},childCount:0};r=new i6(i,r,o),i=nU(n=nq(n))}return r}function i8(t){return t.node.value}function i7(t,e){t.node.value=e,function t(e){var n,r,i,o,s;null!==e.parent&&(n=e.parent,r=e.name,o=void 0===i8(i=e)&&!i9(i),s=t0(n.node.children,r),o&&s?(delete n.node.children[r],n.node.childCount--,t(n)):o||s||(n.node.children[r]=i.node,n.node.childCount++,t(n)))}(t)}function i9(t){return t.node.childCount>0}function ot(t,e){na(t.node.children,function(n,r){e(new i6(n,t,r))})}function oe(t){return new nM(null===t.parent?t.name:oe(t.parent)+"/"+t.name)}var on=/[\[\].#$\/\u0000-\u001F\u007F]/,or=/[\[\].#$\u0000-\u001F\u007F]/,oi=function(t){return"string"==typeof t&&0!==t.length&&!on.test(t)},oo=function(t){return"string"==typeof t&&0!==t.length&&!or.test(t)},os=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!e7(t)||t&&"object"==typeof t&&t0(t,".sv")},oa=function(t,e,n,r){r&&void 0===e||ou(t9(t,"value"),e,n)},ou=function(t,e,n){var r=n instanceof nM?new n$(n,t):n;if(void 0===e)throw Error(t+"contains undefined "+nJ(r));if("function"==typeof e)throw Error(t+"contains a function "+nJ(r)+" with contents = "+e.toString());if(e7(e))throw Error(t+"contains "+e.toString()+" "+nJ(r));if("string"==typeof e&&e.length>10485760/3&&er(e)>10485760)throw Error(t+"contains a string greater than 10485760 utf8 bytes "+nJ(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(na(e,function(e,n){var s;if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!oi(e)))throw Error(t+" contains an invalid key ("+e+") "+nJ(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.parts_.length>0&&(r.byteLength_+=1),r.parts_.push(e),r.byteLength_+=er(e),nX(r),ou(t,n,r),s=r.parts_.pop(),r.byteLength_-=er(s),r.parts_.length>0&&(r.byteLength_-=1)}),i&&o)throw Error(t+' contains ".value" child '+nJ(r)+" in addition to actual children.")}},oc=function(t,e){for(n=0;n<e.length;n++)for(var n,r,i=nB(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!oi(i[o]))throw Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(nG);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&nY(s,r))throw Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},oh=function(t,e,n,r){if(!r||void 0!==e){var i=t9(t,"values");if(!(e&&"object"==typeof e)||Array.isArray(e))throw Error(i+" must be an object containing the children to replace.");var o=[];na(e,function(t,e){var r=new nM(t);if(ou(i,e,nW(n,r)),".priority"===nV(r)&&!os(e))throw Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)}),oc(i,o)}},ol=function(t,e,n){if(!n||void 0!==e){if(e7(e))throw Error(t9(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!os(e))throw Error(t9(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},of=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw Error(t9(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},od=function(t,e,n,r){if((!r||void 0!==n)&&!oi(n))throw Error(t9(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},op=function(t,e,n,r){if((!r||void 0!==n)&&!oo(n))throw Error(t9(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ov=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),op(t,e,n,r)},og=function(t,e){if(".info"===nU(e))throw Error(t+" failed = Can't modify data under /.info/")},om=function(t,e){var n,r=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!oi(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==r.length&&((n=r)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),!oo(n)))throw Error(t9(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},oy=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw Error(t9(t,e)+"must be a boolean.")},o_=function(){this.eventLists_=[],this.recursionDepth_=0};function ob(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||nQ(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function ow(t,e,n){ob(t,n),oT(t,function(t){return nQ(t,e)})}function oI(t,e,n){ob(t,n),oT(t,function(t){return nY(t,e)||nY(e,t)})}function oT(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];i&&(e(i.path)?(function(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();eZ&&e2("event: "+n.toString()),nl(r)}}}(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}var oE="repo_interrupt",oS=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new o_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=rO(),this.transactionQueueTree_=new i6,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function oC(t){var e=t.infoData_.getNode(new nM(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e}function ok(t){var e;return(e=e={timestamp:oC(t)}).timestamp=e.timestamp||new Date().getTime(),e}function oN(t,e,n,r,i){t.dataUpdateCount++;var o=new nM(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var s=[];if(i){if(r){var a=t4(n,function(t){return rf(t)});s=function(t,e,n,r){var i=iG(t,r);if(!i)return[];var o=iQ(i),s=o.path,a=o.queryId,u=nz(s,e),c=r0.fromObject(n),h=new rH(rV(a),u,c);return iY(t,s,h)}(t.serverSyncTree_,o,a,i)}else{var u=rf(n);s=function(t,e,n,r){var i=iG(t,r);if(null==i)return[];var o=iQ(i),s=o.path,a=o.queryId,u=nz(s,e),c=new rW(rV(a),u,n);return iY(t,s,c)}(t.serverSyncTree_,o,u,i)}}else if(r){var c,h,l=t4(n,function(t){return rf(t)});c=t.serverSyncTree_,h=r0.fromObject(l),s=iK(c,new rH(rq(),o,h))}else{var f=rf(n);s=ij(t.serverSyncTree_,o,f)}var d=o;s.length>0&&(d=oq(t,o)),oI(t.eventQueue_,d,s)}function oA(t,e){var n,r,i;oR(t,"connected",e),!1===e&&(oM(t,"onDisconnectEvents"),n=ok(t),r=rO(),rM(t.onDisconnect_,nF(),function(e,i){var o=i2(e,i,t.serverSyncTree_,n);rL(r,e,o)}),i=[],rM(r,nF(),function(e,n){i=i.concat(ij(t.serverSyncTree_,e,n));var r=oW(t,e);oq(t,r)}),t.onDisconnect_=rO(),oI(t.eventQueue_,nF(),i))}function oR(t,e,n){var r=new nM("/.info/"+e),i=rf(n);t.infoData_.updateSnapshot(r,i);var o=ij(t.infoSyncTree_,r,i);oI(t.eventQueue_,r,o)}function ox(t){return t.nextWriteId_++}function oP(t,e,n,r,i){oM(t,"set",{path:e.toString(),value:n,priority:r});var o=ok(t),s=rf(n,r),a=i4(s,iB(t.serverSyncTree_,e),o),u=ox(t),c=iF(t.serverSyncTree_,e,a,u,!0);ob(t.eventQueue_,c),t.server_.put(e.toString(),s.val(!0),function(n,r){var o="ok"===n;o||e5("set at "+e+" failed: "+n);var s=iU(t.serverSyncTree_,u,!o);oI(t.eventQueue_,e,s),oF(t,i,n,r)});var h=oW(t,e);oq(t,h),oI(t.eventQueue_,h,[])}function oD(t,e,n,r){var i=rf(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),function(n,o){"ok"===n&&rL(t.onDisconnect_,e,i),oF(t,r,n,o)})}function oO(t,e,n){var r;r=".info"===nU(e._path)?iq(t.infoSyncTree_,e,n):iq(t.serverSyncTree_,e,n),ow(t.eventQueue_,e._path,r)}function oL(t){t.persistentConnection_&&t.persistentConnection_.interrupt(oE)}function oM(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),e2.apply(void 0,tS([r],tE(e)))}function oF(t,e,n,r){e&&nl(function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=Error(i);o.code=t,e(o)}})}function oU(t,e,n){return iB(t.serverSyncTree_,e,n)||rh.EMPTY_NODE}function oj(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||oK(t,e),i8(e)){var n=oB(t,e);tk(n.length>0,"Sending zero length transaction queue"),n.every(function(t){return 0===t.status})&&function(t,e,n){for(var r=oU(t,e,n.map(function(t){return t.currentWriteId})),i=r,o=r.hash(),s=0;s<n.length;s++){var a=n[s];tk(0===a.status,"tryToSendTransactionQueue_: items in queue should all be run."),a.status=1,a.retryCount++;var u=nz(e,a.path);i=i.updateChild(u,a.currentOutputSnapshotRaw)}var c=i.val(!0);t.server_.put(e.toString(),c,function(r){oM(t,"transaction put response",{path:e.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=function(e){n[e].status=2,i=i.concat(iU(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push(function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)}),n[e].unwatcher()},a=0;a<n.length;a++)s(a);oK(t,i5(t.transactionQueueTree_,e)),oj(t,t.transactionQueueTree_),oI(t.eventQueue_,e,i);for(var a=0;a<o.length;a++)nl(o[a])}else{if("datastale"===r)for(var a=0;a<n.length;a++)3===n[a].status?n[a].status=4:n[a].status=0;else{e5("transaction at "+e.toString()+" failed: "+r);for(var a=0;a<n.length;a++)n[a].status=4,n[a].abortReason=r}oq(t,e)}},o)}(t,oe(e),n)}else i9(e)&&ot(e,function(e){oj(t,e)})}function oq(t,e){var n=oV(t,e),r=oe(n),i=oB(t,n);return function(t,e,n){if(0!==e.length){for(var r=[],i=[],o=e.filter(function(t){return 0===t.status}).map(function(t){return t.currentWriteId}),s=function(s){var a,u=e[s],c=nz(n,u.path),h=!1;if(tk(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)h=!0,a=u.abortReason,i=i.concat(iU(t.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status){if(u.retryCount>=25)h=!0,a="maxretry",i=i.concat(iU(t.serverSyncTree_,u.currentWriteId,!0));else{var l=oU(t,u.path,o);u.currentInputSnapshot=l;var f=e[s].update(l.val());if(void 0!==f){ou("transaction failed: Data returned ",f,u.path);var d=rf(f);"object"==typeof f&&null!=f&&t0(f,".priority")||(d=d.updatePriority(l.getPriority()));var p=u.currentWriteId,v=i4(d,l,ok(t));u.currentOutputSnapshotRaw=d,u.currentOutputSnapshotResolved=v,u.currentWriteId=ox(t),o.splice(o.indexOf(p),1),i=(i=i.concat(iF(t.serverSyncTree_,u.path,v,u.currentWriteId,u.applyLocally))).concat(iU(t.serverSyncTree_,p,!0))}else h=!0,a="nodata",i=i.concat(iU(t.serverSyncTree_,u.currentWriteId,!0))}}oI(t.eventQueue_,n,i),i=[],h&&(e[s].status=2,setTimeout(e[s].unwatcher,Math.floor(0)),e[s].onComplete&&("nodata"===a?r.push(function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)}):r.push(function(){return e[s].onComplete(Error(a),!1,null)})))},a=0;a<e.length;a++)s(a);oK(t,t.transactionQueueTree_);for(var a=0;a<r.length;a++)nl(r[a]);oj(t,t.transactionQueueTree_)}}(t,i,r),r}function oV(t,e){var n,r=t.transactionQueueTree_;for(n=nU(e);null!==n&&void 0===i8(r);)r=i5(r,n),n=nU(e=nq(e));return r}function oB(t,e){var n=[];return function t(e,n,r){var i=i8(n);if(i)for(var o=0;o<i.length;o++)r.push(i[o]);ot(n,function(n){t(e,n,r)})}(t,e,n),n.sort(function(t,e){return t.order-e.order}),n}function oK(t,e){var n=i8(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,i7(e,n.length>0?n:void 0)}ot(e,function(e){oK(t,e)})}function oW(t,e){var n=oe(oV(t,e)),r=i5(t.transactionQueueTree_,e);return!function(t,e,n){for(var r=t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,function(e){oH(t,e)}),oH(t,r),!function t(e,n,r,i){r&&!i&&n(e),ot(e,function(e){t(e,n,!0,i)}),r&&i&&n(e)}(r,function(e){oH(t,e)}),n}function oH(t,e){var n=i8(e);if(n){for(var r=[],i=[],o=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?(tk(o===s-1,"All SENT items should be at beginning of queue."),o=s,n[s].status=3,n[s].abortReason="set"):(tk(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(iU(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,Error("set"),!1,null))));-1===o?i7(e,void 0):n.length=o+1,oI(t.eventQueue_,oe(e),i);for(var s=0;s<r.length;s++)nl(r[s])}}var oz=function(t,e){var n=oG(t),r=n.namespace;"firebase.com"===n.domain&&e6(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||e6("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||e8();var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new n_(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new nM(n.pathString)}},oG=function(t){var e="",n="",r="",i="",o="",s=!0,a="https",u=443;if("string"==typeof t){var c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));var h=t.indexOf("/");-1===h&&(h=t.length);var l=t.indexOf("?");-1===l&&(l=t.length),e=t.substring(0,Math.min(h,l)),h<l&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(h,l)));var f=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=tT(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var a=s.split("=");2===a.length?r[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):e5("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,l)));(c=e.indexOf(":"))>=0?(s="https"===a||"wss"===a,u=parseInt(e.substring(c+1),10)):c=e.length;var d=e.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),o=r}"ns"in f&&(o=f.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}},oQ=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+tY(this.snapshot.exportVal())},t}(),oY=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),o$=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return tk(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),oX=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new tL;return function(t,e,n){t.server_.onDisconnectCancel(e.toString(),function(r,i){"ok"===r&&function t(e,n){if(nH(n))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var r=e.value;return e.value=null,r.forEachChild(ri,function(t,n){rL(e,new nM(t),n)}),t(e,n)}if(!(e.children.size>0))return!0;var i=nU(n);return n=nq(n),e.children.has(i)&&t(e.children.get(i),n)&&e.children.delete(i),0===e.children.size}(t.onDisconnect_,e),oF(t,n,r,i)})}(this._repo,this._path,t.wrapCallback(function(){})),t.promise},t.prototype.remove=function(){og("OnDisconnect.remove",this._path);var t=new tL;return oD(this._repo,this._path,null,t.wrapCallback(function(){})),t.promise},t.prototype.set=function(t){og("OnDisconnect.set",this._path),oa("OnDisconnect.set",t,this._path,!1);var e=new tL;return oD(this._repo,this._path,t,e.wrapCallback(function(){})),e.promise},t.prototype.setWithPriority=function(t,e){og("OnDisconnect.setWithPriority",this._path),oa("OnDisconnect.setWithPriority",t,this._path,!1),ol("OnDisconnect.setWithPriority",e,!1);var n=new tL;return function(t,e,n,r,i){var o=rf(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),function(n,r){"ok"===n&&rL(t.onDisconnect_,e,o),oF(t,i,n,r)})}(this._repo,this._path,t,e,n.wrapCallback(function(){})),n.promise},t.prototype.update=function(t){og("OnDisconnect.update",this._path),oh("OnDisconnect.update",t,this._path,!1);var e=new tL;return function(t,e,n,r){if(t2(n)){e2("onDisconnect().update() called with empty data.  Don't do anything."),oF(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,function(i,o){"ok"===i&&na(n,function(n,r){var i=rf(r);rL(t.onDisconnect_,nW(e,n),i)}),oF(t,r,i,o)})}(this._repo,this._path,t,e.wrapCallback(function(){})),e.promise},t}(),oJ=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return nH(this._path)?null:nV(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new o2(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=no(rx(this._queryParams));return"{}"===t?"default":t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return rx(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=eo(e))instanceof t))return!1;var n=this._repo===e._repo,r=nQ(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function oZ(t,e){if(!0===t._orderByCalled)throw Error(e+": You can't combine multiple orderBy calls.")}function o0(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===n3){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==nt)throw Error(r);if("string"!=typeof e)throw Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==ne)throw Error(r);if("string"!=typeof n)throw Error(i)}}else if(t.getIndex()===ri){if(null!=e&&!os(e)||null!=n&&!os(n))throw Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(tk(t.getIndex() instanceof rd||t.getIndex()===rp,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function o1(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var o2=function(t){function e(e,n){return t.call(this,e,n,new rC,!1)||this}return t_(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=nK(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(oJ),o4=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new nM(e),r=o5(this.ref,e);return new t(this._node.getChild(n),r,ri)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,function(r,i){return e(new t(i,o5(n.ref,r),ri))})},t.prototype.hasChild=function(t){var e=new nM(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function o3(t,e){return(t=eo(t))._checkNotDeleted("ref"),void 0!==e?o5(t._root,e):t._root}function o6(t,e){(t=eo(t))._checkNotDeleted("refFromURL");var n=oz(e,t._repo.repoInfo_.nodeAdmin);om("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||e6("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),o3(t,n.path.toString())}function o5(t,e){return null===nU((t=eo(t))._path)?ov("child","path",e,!1):op("child","path",e,!1),new o2(t._repo,nW(t._path,e))}function o8(t,e){og("set",(t=eo(t))._path),oa("set",e,t._path,!1);var n=new tL;return oP(t._repo,t._path,e,null,n.wrapCallback(function(){})),n.promise}var o7=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new oQ("value",this,new o4(t.snapshotNode,new o2(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new oY(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),o9=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new oY(this,t,e):null},t.prototype.createEvent=function(t,e){tk(null!=t.childName,"Child events should have a childName.");var n=o5(new o2(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new oQ(t.type,this,new o4(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function st(t,e,n,r,i){if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){var o,s,a,u=n,c=function(e,n){oO(t._repo,t,l),u(e,n)};c.userCallback=n.userCallback,c.context=n.context,n=c}var h=new o$(n,a||void 0),l="value"===e?new o7(h):new o9(e,h);return o=t._repo,s=".info"===nU(t._path)?iV(o.infoSyncTree_,t,l):iV(o.serverSyncTree_,t,l),ow(o.eventQueue_,t._path,s),function(){return oO(t._repo,t,l)}}function se(t,e,n,r){return st(t,"value",e,n,r)}function sn(t,e,n,r){return st(t,"child_added",e,n,r)}function sr(t,e,n,r){return st(t,"child_changed",e,n,r)}function si(t,e,n,r){return st(t,"child_moved",e,n,r)}function so(t,e,n,r){return st(t,"child_removed",e,n,r)}function ss(t,e,n){var r=null,i=n?new o$(n):null;"value"===e?r=new o7(i):e&&(r=new o9(e,i)),oO(t._repo,t,r)}var sa=function(){},su=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return t_(e,t),e.prototype._apply=function(t){oa("endAt",this._value,t._path,!0);var e=rN(t._queryParams,this._value,this._key);if(o1(e),o0(e),t._queryParams.hasEnd())throw Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new oJ(t._repo,t._path,e,t._orderByCalled)},e}(sa),sc=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return t_(e,t),e.prototype._apply=function(t){oa("endBefore",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===n3?("string"==typeof n&&(n=ry(n)),i=rN(e,n,r)):i=rN(e,n,null==r?nt:ry(r)),i.endBeforeSet_=!0,i);if(o1(o),o0(o),t._queryParams.hasEnd())throw Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new oJ(t._repo,t._path,o,t._orderByCalled)},e}(sa),sh=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return t_(e,t),e.prototype._apply=function(t){oa("startAt",this._value,t._path,!0);var e=rk(t._queryParams,this._value,this._key);if(o1(e),o0(e),t._queryParams.hasStart())throw Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new oJ(t._repo,t._path,e,t._orderByCalled)},e}(sa),sl=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return t_(e,t),e.prototype._apply=function(t){oa("startAfter",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===n3?("string"==typeof n&&(n=rm(n)),i=rk(e,n,r)):i=rk(e,n,null==r?ne:rm(r)),i.startAfterSet_=!0,i);if(o1(o),o0(o),t._queryParams.hasStart())throw Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new oJ(t._repo,t._path,o,t._orderByCalled)},e}(sa),sf=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return t_(e,t),e.prototype._apply=function(t){var e,n,r;if(t._queryParams.hasLimit())throw Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new oJ(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),t._orderByCalled)},e}(sa),sd=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return t_(e,t),e.prototype._apply=function(t){var e,n,r;if(t._queryParams.hasLimit())throw Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new oJ(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),t._orderByCalled)},e}(sa),sp=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return t_(e,t),e.prototype._apply=function(t){oZ(t,"orderByChild");var e=new nM(this._path);if(nH(e))throw Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new rd(e),r=rA(t._queryParams,n);return o0(r),new oJ(t._repo,t._path,r,!0)},e}(sa),sv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype._apply=function(t){oZ(t,"orderByKey");var e=rA(t._queryParams,n3);return o0(e),new oJ(t._repo,t._path,e,!0)},e}(sa),sg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype._apply=function(t){oZ(t,"orderByPriority");var e=rA(t._queryParams,ri);return o0(e),new oJ(t._repo,t._path,e,!0)},e}(sa),sm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype._apply=function(t){oZ(t,"orderByValue");var e=rA(t._queryParams,rp);return o0(e),new oJ(t._repo,t._path,e,!0)},e}(sa),sy=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return t_(e,t),e.prototype._apply=function(t){if(oa("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new su(this._value,this._key)._apply(new sh(this._value,this._key)._apply(t))},e}(sa);function s_(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=eo(t);try{for(var s=tT(r),a=s.next();!a.done;a=s.next())o=a.value._apply(o)}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return o}tk(!sZ,"__referenceConstructor has already been defined"),sZ=o2,tk(!s0,"__referenceConstructor has already been defined"),s0=o2;var sb={},sw=!1;function sI(t,e,n,r,i){var o,s,a,u,c,h=r||t.options.databaseURL;void 0===h&&(t.options.projectId||e6("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),e2("Using default host for project ",t.options.projectId),h=t.options.projectId+"-default-rtdb.firebaseio.com");var l=oz(h,i),f=l.repoInfo,d=void 0;void 0!==ex&&(d=ex.env.FIREBASE_DATABASE_EMULATOR_HOST),d?(c=!0,f=(l=oz(h="http://"+d+"?ns="+f.namespace,i)).repoInfo):c=!l.repoInfo.secure;var p=i&&c?new nv(nv.OWNER):new np(t.name,t.options,e);om("Invalid Firebase Database URL",l),nH(l.path)||e6("Database URL must point to the root of a Firebase Database (not including a child path).");var v=(o=f,s=new nd(t.name,n),(a=sb[t.name])||(a={},sb[t.name]=a),(u=a[o.toURLString()])&&e6("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),u=new oS(o,sw,p,s),a[o.toURLString()]=u,u);return new sT(v,t)}var sT=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(function(t,e,n){var r;if(t.stats_=nE(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new rP(t.repoInfo_,function(e,n,r,i){oN(t,e,n,r,i)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(function(){return oA(t,!0)},0);else{if(null!=n){if("object"!=typeof n)throw Error("Only objects are supported for option databaseAuthVariableOverride");try{tY(n)}catch(t){throw Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new n0(t.repoInfo_,e,function(e,n,r,i){oN(t,e,n,r,i)},function(e){oA(t,e)},function(e){na(e,function(e,n){oR(t,e,n)})},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(function(e){t.server_.refreshAuthToken(e)}),t.appCheckProvider_.addTokenChangeListener(function(e){t.server_.refreshAppCheckToken(e.token)}),t.statsReporter_=(nT[r=t.repoInfo_.toString()]||(nT[r]=new rU(t.stats_,t.server_)),nT[r]),t.infoData_=new rD,t.infoSyncTree_=new iM({startListening:function(e,n,r,i){var o=[],s=t.infoData_.getNode(e._path);return s.isEmpty()||(o=ij(t.infoSyncTree_,e._path,s),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),oR(t,"connected",!1),t.serverSyncTree_=new iM({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,function(n,r){var o=i(n,r);oI(t.eventQueue_,e._path,o)}),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new o2(this._repo,nF())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){var t,e,n;return this._checkNotDeleted("delete"),t=this._repo,(n=sb[e=this.app.name])&&n[t.key]===t||e6("Database "+e+"("+t.repoInfo_+") has already been deleted."),oL(t),delete n[t.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&e6("Cannot call "+t+" on a deleted database.")},t}(),sE={".sv":"timestamp"},sS=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),sC=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){t7("OnDisconnect.cancel",0,1,arguments.length),et("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},t.prototype.remove=function(t){t7("OnDisconnect.remove",0,1,arguments.length),et("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},t.prototype.set=function(t,e){t7("OnDisconnect.set",1,2,arguments.length),et("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then(function(){return e(null)},function(t){return e(t)}),n},t.prototype.setWithPriority=function(t,e,n){t7("OnDisconnect.setWithPriority",2,3,arguments.length),et("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then(function(){return n(null)},function(t){return n(t)}),r},t.prototype.update=function(t,e){if(t7("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,e5("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}et("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then(function(){return e(null)},function(t){return e(t)}),i},t}(),sk=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return t7("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),sN=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return t7("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return t7("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return t7("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return t7("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return t7("DataSnapshot.child",0,1,arguments.length),op("DataSnapshot.child","path",e=String(e),!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return t7("DataSnapshot.hasChild",1,1,arguments.length),op("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return t7("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return t7("DataSnapshot.forEach",1,1,arguments.length),et("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(function(r){return e(new t(n._database,r))})},t.prototype.hasChildren=function(){return t7("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return t7("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return t7("DataSnapshot.ref",0,0,arguments.length),new sR(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),sA=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var o,s=this;t7("Query.on",2,4,arguments.length),et("Query.on","callback",n,!1);var a=t.getCancelAndContextArgs_("Query.on",r,i),u=function(t,e){n.call(a.context,new sN(s.database,t),e)};u.userCallback=n,u.context=a.context;var c=null===(o=a.cancel)||void 0===o?void 0:o.bind(a.context);switch(e){case"value":return se(this._delegate,u,c),n;case"child_added":return sn(this._delegate,u,c),n;case"child_removed":return so(this._delegate,u,c),n;case"child_changed":return sr(this._delegate,u,c),n;case"child_moved":return si(this._delegate,u,c),n;default:throw Error(t9("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if(t7("Query.off",0,3,arguments.length),of("Query.off",t,!0),et("Query.off","callback",e,!0),ee("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,ss(this._delegate,t,r)}else ss(this._delegate,t)},t.prototype.get=function(){var t,e,n,r,i=this;return(e=(t=eo(t=this._delegate))._repo,n=t,null!=(r=function(t,e){var n,r=e._path,i=null;t.syncPointTree_.foreachOnPath(r,function(t,e){var n=nz(t,r);i=i||ix(e,n)});var o=t.syncPointTree_.get(r);o?i=i||ix(o,nF()):(o=new ik,t.syncPointTree_=t.syncPointTree_.set(r,o));var s=null!=i,a=s?new rz(i,!0,!1):null,u=(n=t.pendingWriteTree_,il(e._path,n));return rJ(iA(o,e,u,s?a.getNode():rh.EMPTY_NODE,s).viewCache_)}(e.serverSyncTree_,n))?Promise.resolve(r):e.server_.get(n).then(function(t){var r=rf(t).withIndex(n._queryParams.getIndex()),i=ij(e.serverSyncTree_,n._path,r);return ow(e.eventQueue_,n._path,i),Promise.resolve(r)},function(t){return oM(e,"get for query "+tY(n)+" failed: "+t),Promise.reject(Error(t))})).then(function(e){return new o4(e,new o2(t._repo,t._path),t._queryParams.getIndex())}).then(function(t){return new sN(i.database,t)})},t.prototype.once=function(e,n,r,i){var o=this;t7("Query.once",1,4,arguments.length),et("Query.once","callback",n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),a=new tL,u=function(t,e){var r=new sN(o.database,t);n&&n.call(s.context,r,e),a.resolve(r)};u.userCallback=n,u.context=s.context;var c=function(t){s.cancel&&s.cancel.call(s.context,t),a.reject(t)};switch(e){case"value":se(this._delegate,u,c,{onlyOnce:!0});break;case"child_added":sn(this._delegate,u,c,{onlyOnce:!0});break;case"child_removed":so(this._delegate,u,c,{onlyOnce:!0});break;case"child_changed":sr(this._delegate,u,c,{onlyOnce:!0});break;case"child_moved":si(this._delegate,u,c,{onlyOnce:!0});break;default:throw Error(t9("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return a.promise},t.prototype.limitToFirst=function(e){return t7("Query.limitToFirst",1,1,arguments.length),new t(this.database,s_(this._delegate,function(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw Error("limitToFirst: First argument must be a positive integer.");return new sf(t)}(e)))},t.prototype.limitToLast=function(e){return t7("Query.limitToLast",1,1,arguments.length),new t(this.database,s_(this._delegate,function(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw Error("limitToLast: First argument must be a positive integer.");return new sd(t)}(e)))},t.prototype.orderByChild=function(e){return t7("Query.orderByChild",1,1,arguments.length),new t(this.database,s_(this._delegate,function(t){if("$key"===t)throw Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return op("orderByChild","path",t,!1),new sp(t)}(e)))},t.prototype.orderByKey=function(){return t7("Query.orderByKey",0,0,arguments.length),new t(this.database,s_(this._delegate,new sv))},t.prototype.orderByPriority=function(){return t7("Query.orderByPriority",0,0,arguments.length),new t(this.database,s_(this._delegate,new sg))},t.prototype.orderByValue=function(){return t7("Query.orderByValue",0,0,arguments.length),new t(this.database,s_(this._delegate,new sm))},t.prototype.startAt=function(e,n){var r;return void 0===e&&(e=null),t7("Query.startAt",0,2,arguments.length),new t(this.database,s_(this._delegate,(void 0===(r=e)&&(r=null),od("startAt","key",n,!0),new sh(r,n))))},t.prototype.startAfter=function(e,n){var r;return void 0===e&&(e=null),t7("Query.startAfter",0,2,arguments.length),new t(this.database,s_(this._delegate,(r=e,od("startAfter","key",n,!0),new sl(r,n))))},t.prototype.endAt=function(e,n){var r;return void 0===e&&(e=null),t7("Query.endAt",0,2,arguments.length),new t(this.database,s_(this._delegate,(r=e,od("endAt","key",n,!0),new su(r,n))))},t.prototype.endBefore=function(e,n){var r;return void 0===e&&(e=null),t7("Query.endBefore",0,2,arguments.length),new t(this.database,s_(this._delegate,(r=e,od("endBefore","key",n,!0),new sc(r,n))))},t.prototype.equalTo=function(e,n){return t7("Query.equalTo",1,2,arguments.length),new t(this.database,s_(this._delegate,(od("equalTo","key",n,!0),new sy(e,n))))},t.prototype.toString=function(){return t7("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return t7("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if(t7("Query.isEqual",1,1,arguments.length),!(e instanceof t))throw Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,et(t,"cancel",r.cancel,!0),r.context=n,ee(t,"context",r.context,!0);else if(e){if("object"==typeof e&&null!==e)r.context=e;else if("function"==typeof e)r.cancel=e;else throw Error(t9(t,"cancelOrContext")+" must either be a cancel callback or a context object.")}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new sR(this.database,new o2(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),sR=function(t){function e(e,n){var r=t.call(this,e,new oJ(n._repo,n._path,new rC,!1))||this;return r.database=e,r._delegate=n,r}return t_(e,t),e.prototype.getKey=function(){return t7("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return t7("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new e(this.database,o5(this._delegate,t))},e.prototype.getParent=function(){t7("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return t7("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){t7("Reference.set",1,2,arguments.length),et("Reference.set","onComplete",e,!0);var n=o8(this._delegate,t);return e&&n.then(function(){return e(null)},function(t){return e(t)}),n},e.prototype.update=function(t,e){if(t7("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n,r,i,o={},s=0;s<t.length;++s)o[""+s]=t[s];t=o,e5("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}og("Reference.update",this._delegate._path),et("Reference.update","onComplete",e,!0);var a=(n=this._delegate,oh("update",r=t,n._path,!1),i=new tL,function(t,e,n,r){oM(t,"update",{path:e.toString(),value:n});var i=!0,o=ok(t),s={};if(na(n,function(n,r){i=!1,s[n]=i2(nW(e,n),rf(r),t.serverSyncTree_,o)}),i)e2("update() called with empty data.  Don't do anything."),oF(t,r,"ok",void 0);else{var a,u,c,h=ox(t),l=(tk(h>(u=(a=t.serverSyncTree_).pendingWriteTree_).lastWriteId,"Stacking an older merge on top of newer ones"),u.allWrites.push({path:e,children:s,writeId:h,visible:!0}),u.visibleWrites=r4(u.visibleWrites,e,s),u.lastWriteId=h,c=r0.fromObject(s),iK(a,new rH(rj(),e,c)));ob(t.eventQueue_,l),t.server_.merge(e.toString(),n,function(n,i){var o="ok"===n;o||e5("update at "+e+" failed: "+n);var s=iU(t.serverSyncTree_,h,!o),a=s.length>0?oq(t,e):e;oI(t.eventQueue_,a,s),oF(t,r,n,i)}),na(n,function(n){var r=oW(t,nW(e,n));oq(t,r)}),oI(t.eventQueue_,e,[])}}(n._repo,n._path,r,i.wrapCallback(function(){})),i.promise);return e&&a.then(function(){return e(null)},function(t){return e(t)}),a},e.prototype.setWithPriority=function(t,e,n){t7("Reference.setWithPriority",2,3,arguments.length),et("Reference.setWithPriority","onComplete",n,!0);var r=function(t,e,n){if(og("setWithPriority",t._path),oa("setWithPriority",e,t._path,!1),ol("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new tL;return oP(t._repo,t._path,e,n,r.wrapCallback(function(){})),r.promise}(this._delegate,t,e);return n&&r.then(function(){return n(null)},function(t){return n(t)}),r},e.prototype.remove=function(t){t7("Reference.remove",0,1,arguments.length),et("Reference.remove","onComplete",t,!0);var e,n=(og("remove",(e=this._delegate)._path),o8(e,null));return t&&n.then(function(){return t(null)},function(e){return t(e)}),n},e.prototype.transaction=function(t,e,n){var r=this;t7("Reference.transaction",1,3,arguments.length),et("Reference.transaction","transactionUpdate",t,!1),et("Reference.transaction","onComplete",e,!0),oy("Reference.transaction","applyLocally",n,!0);var i=(function(t,e,n){if(og("Reference.transaction",(t=eo(t))._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var r,i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,o=new tL,s=se(t,function(){});return function(t,e,n,r,i,o){oM(t,"transaction on "+e);var s={path:e,update:n,onComplete:r,status:null,order:e$(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=oU(t,e,void 0);s.currentInputSnapshot=a;var u=s.update(a.val());if(void 0===u)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{ou("transaction failed: Data returned ",u,s.path),s.status=0;var c=i5(t.transactionQueueTree_,e),h=i8(c)||[];h.push(s),i7(c,h);var l=void 0;"object"==typeof u&&null!==u&&t0(u,".priority")?tk(os(l=t1(u,".priority")),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null."):l=(iB(t.serverSyncTree_,e)||rh.EMPTY_NODE).getPriority().val();var f=ok(t),d=rf(u,l),p=i4(d,a,f);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=p,s.currentWriteId=ox(t);var v=iF(t.serverSyncTree_,e,p,s.currentWriteId,s.applyLocally);oI(t.eventQueue_,e,v),oj(t,t.transactionQueueTree_)}}(t._repo,t._path,e,function(e,n,r){var i=null;e?o.reject(e):(i=new o4(r,new o2(t._repo,t._path),ri),o.resolve(new sS(n,i)))},s,i),o.promise})(this._delegate,t,{applyLocally:n}).then(function(t){return new sk(t.committed,new sN(r.database,t.snapshot))});return e&&i.then(function(t){return e(null,t.committed,t.snapshot)},function(t){return e(t,!1,null)}),i},e.prototype.setPriority=function(t,e){t7("Reference.setPriority",1,2,arguments.length),et("Reference.setPriority","onComplete",e,!0);var n,r,i=(og("setPriority",(n=eo(n=this._delegate))._path),ol("setPriority",t,!1),r=new tL,oP(n._repo,nW(n._path,".priority"),t,null,r.wrapCallback(function(){})),r.promise);return e&&i.then(function(){return e(null)},function(t){return e(t)}),i},e.prototype.push=function(t,n){var r,i,o,s,a,u=this;t7("Reference.push",0,2,arguments.length),et("Reference.push","onComplete",n,!0);var c=(og("push",(r=eo(r=this._delegate))._path),oa("push",t,r._path,!0),o=rg(oC(r._repo)),s=o5(r,o),a=o5(r,o),i=null!=t?o8(a,t).then(function(){return a}):Promise.resolve(a),s.then=i.then.bind(i),s.catch=i.then.bind(i,void 0),s),h=c.then(function(t){return new e(u.database,t)});n&&h.then(function(){return n(null)},function(t){return n(t)});var l=new e(this.database,c);return l.then=h.then.bind(h),l.catch=h.catch.bind(h,void 0),l},e.prototype.onDisconnect=function(){return og("Reference.onDisconnect",this._delegate._path),new sC(new oX(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(sA),sx=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={}),(t=eo(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&e6("Cannot call useEmulator() after instance has already been initialized.");var i,o=t._repoInternal,s=void 0;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&e6('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new nv(nv.OWNER);else if(r.mockUserToken){var a=tM(r.mockUserToken,t.app.options.projectId);s=new nv(a)}i=s,o.repoInfo_=new n_(e+":"+n,!1,o.repoInfo_.namespace,o.repoInfo_.webSocketOnly,o.repoInfo_.nodeAdmin,o.repoInfo_.persistenceKey,o.repoInfo_.includeNamespaceInQueryParams),i&&(o.authTokenProvider_=i)}(this._delegate,t,e,n)},t.prototype.ref=function(t){if(t7("database.ref",0,1,arguments.length),t instanceof sR){var e=o6(this._delegate,t.toString());return new sR(this,e)}var e=o3(this._delegate,t);return new sR(this,e)},t.prototype.refFromURL=function(t){t7("database.refFromURL",1,1,arguments.length);var e=o6(this._delegate,t);return new sR(this,e)},t.prototype.goOffline=function(){var t;return t7("database.goOffline",0,0,arguments.length),void((t=eo(t=this._delegate))._checkNotDeleted("goOffline"),oL(t._repo))},t.prototype.goOnline=function(){var t,e;return t7("database.goOnline",0,0,arguments.length),void((t=eo(t=this._delegate))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume(oE))},t.ServerValue={TIMESTAMP:sE,increment:function(t){return{".sv":{increment:t}}}},t}(),sP=Object.freeze({__proto__:null,forceLongPolling:function(){nR.forceDisallow(),nk.forceAllow()},forceWebSockets:function(){nk.forceDisallow()},isWebSocketsAvailable:function(){return nR.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){e?(t.statsListener_||(t.statsListener_=new rF(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var n,r=Object.keys(n).reduce(function(t,e){return Math.max(e.length,t)},0);na(n,function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)})}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){var n;(n=t._delegate._repo).stats_.incrementCounter(e),n.statsReporter_.statsToReport_[e]=!0},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){t._delegate._repo.interceptServerDataCallback_=e},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,i=t.customAuthImpl,o=t.namespace,s=t.nodeAdmin,a=void 0!==s&&s;eK=r;var u=new eu("auth-internal",new ec("database-standalone"));return u.setComponent(new es("auth-internal",function(){return i},"PRIVATE")),{instance:new sx(sI(e,u,void 0,n,a),e),namespace:o}}});n0.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},n0.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var sD=Object.freeze({__proto__:null,DataConnection:n0,RealTimeConnection:nP,hijackHash:function(t){var e=n0.prototype.put;return n0.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){n0.prototype.put=e}},ConnectionTarget:n_,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){sw=t}}),sO=sx.ServerValue;!function(t){eK=t.SDK_VERSION,t.INTERNAL.registerComponent(new es("database",function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new sx(sI(r,i,o,n),r)},"PUBLIC").setServiceProps({Reference:sR,Query:sA,Database:sx,DataSnapshot:sN,enableLogging:e1,INTERNAL:sP,ServerValue:sO,TEST_ACCESS:sD}).setMultipleInstances(!0)),t.registerVersion("@firebase/database","0.10.7"),tV()}(eR);var sL=function(t,e){return(sL=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function sM(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var sF,sU,sj,sq,sV,sB,sK,sW,sH,sz,sG,sQ,sY,s$,sX,sJ,sZ,s0,s1,s2="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==b?b:"undefined"!=typeof self?self:{},s4=s4||{},s3=s2||self;function s6(){}function s5(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function s8(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function s7(t,e,n){return t.call.apply(t.bind,arguments)}function s9(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function at(t,e,n){return(at=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s7:s9).apply(null,arguments)}function ae(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function an(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ar(){this.s=this.s,this.o=this.o}ar.prototype.s=!1,ar.prototype.na=function(){this.s||(this.s=!0,this.M())},ar.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var ai=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return -1},ao=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function as(t){return Array.prototype.concat.apply([],arguments)}function aa(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function au(t){return/^[\s\xa0]*$/.test(t)}var ac=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ah(t,e){return -1!=t.indexOf(e)}function al(t,e){return t<e?-1:t>e?1:0}t:{var af=s3.navigator;if(af){var ad=af.userAgent;if(ad){lz=ad;break t}}lz=""}function ap(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function av(t){var e={};for(var n in t)e[n]=t[n];return e}var ag="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function am(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ag.length;o++)n=ag[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ay(t){return ay[" "](t),t}ay[" "]=s6;var a_=ah(lz,"Opera"),ab=ah(lz,"Trident")||ah(lz,"MSIE"),aw=ah(lz,"Edge"),aI=aw||ab,aT=ah(lz,"Gecko")&&!(ah(lz.toLowerCase(),"webkit")&&!ah(lz,"Edge"))&&!(ah(lz,"Trident")||ah(lz,"MSIE"))&&!ah(lz,"Edge"),aE=ah(lz.toLowerCase(),"webkit")&&!ah(lz,"Edge");function aS(){var t=s3.document;return t?t.documentMode:void 0}t:{var aC="",ak=function(){var t=lz;return aT?/rv:([^\);]+)(\)|;)/.exec(t):aw?/Edge\/([\d\.]+)/.exec(t):ab?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):aE?/WebKit\/(\S+)/.exec(t):a_?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(ak&&(aC=ak?ak[1]:""),ab){var aN=aS();if(null!=aN&&aN>parseFloat(aC)){lG=String(aN);break t}}lG=aC}var aA={},aR=s3.document&&ab&&(aS()||parseInt(lG,10))||void 0,ax=function(){if(!s3.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s3.addEventListener("test",s6,e),s3.removeEventListener("test",s6,e)}catch(t){}return t}();function aP(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function aD(t,e){if(aP.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(aT){t:{try{ay(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:aO[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&aD.Z.h.call(this)}}aP.prototype.h=function(){this.defaultPrevented=!0},an(aD,aP);var aO={2:"touch",3:"pen",4:"mouse"};aD.prototype.h=function(){aD.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var aL="closure_listenable_"+(1e6*Math.random()|0),aM=0;function aF(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++aM,this.ca=this.fa=!1}function aU(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function aj(t){this.src=t,this.g={},this.h=0}function aq(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=ai(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(aU(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function aV(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&!!n==o.capture&&o.ia==r)return i}return -1}aj.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=aV(t,e,r,i);return -1<s?(e=t[s],n||(e.fa=!1)):((e=new aF(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var aB="closure_lm_"+(1e6*Math.random()|0),aK={};function aW(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=s8(i)?!!i.capture:!!i,a=aQ(t);if(a||(t[aB]=a=new aj(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function t(e){return aG.call(t.src,t.listener,e)},n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ax||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(az(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function aH(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[aL])aq(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(az(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=aQ(e))?(aq(n,t),0==n.h&&(n.src=null,e[aB]=null)):aU(t)}}}function az(t){return t in aK?aK[t]:aK[t]="on"+t}function aG(t,e){if(t.ca)t=!0;else{e=new aD(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&aH(t),t=n.call(r,e)}return t}function aQ(t){return(t=t[aB])instanceof aj?t:null}var aY="__closure_events_fn_"+(1e9*Math.random()>>>0);function a$(t){return"function"==typeof t?t:(t[aY]||(t[aY]=function(e){return t.handleEvent(e)}),t[aY])}function aX(){ar.call(this),this.i=new aj(this),this.P=this,this.I=null}function aJ(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new aP(e,t);else if(e instanceof aP)e.target=e.target||t;else{var i=e;am(e=new aP(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=aZ(s,r,!0,e)&&i}if(i=aZ(s=e.g=t,r,!0,e)&&i,i=aZ(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=aZ(s=e.g=n[o],r,!1,e)&&i}function aZ(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&aq(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}an(aX,ar),aX.prototype[aL]=!0,aX.prototype.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else(i=s8(i)?!!i.capture:!!i,r=a$(r),e&&e[aL])?(e=e.i,(n=String(n).toString())in e.g&&-1<(r=aV(s=e.g[n],r,i,o))&&(aU(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.g[n],e.h--))):e&&(e=aQ(e))&&(n=e.g[n.toString()],e=-1,n&&(e=aV(n,r,i,o)),(r=-1<e?n[e]:null)&&aH(r))}(this,t,e,n,r)},aX.prototype.M=function(){if(aX.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)aU(n[r]);delete e.g[t],e.h--}}this.I=null},aX.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},aX.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var a0=s3.JSON.stringify,a1=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=a2.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),a2=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())(function(){return new a4},function(t){return t.reset()}),a4=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function a3(t,e){var n;lY||(n=s3.Promise.resolve(void 0),lY=function(){n.then(a8)}),a6||(lY(),a6=!0),a5.add(t,e)}var a6=!1,a5=new a1;function a8(){for(var t,e;t=null,a5.g&&(t=a5.g,a5.g=a5.g.next,a5.g||(a5.h=null),t.next=null),e=t;){try{e.h.call(e.g)}catch(t){!function(t){s3.setTimeout(function(){throw t},0)}(t)}a2.j(e),100>a2.h&&(a2.h++,e.next=a2.g,a2.g=e)}a6=!1}function a7(t,e){aX.call(this),this.h=t||1,this.g=e||s3,this.j=at(this.kb,this),this.l=Date.now()}function a9(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function ut(t,e,n){if("function"==typeof t)n&&(t=at(t,n));else if(t&&"function"==typeof t.handleEvent)t=at(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:s3.setTimeout(t,e||0)}an(a7,aX),(s1=a7.prototype).da=!1,s1.S=null,s1.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),aJ(this,"tick"),this.da&&(a9(this),this.start()))}},s1.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},s1.M=function(){a7.Z.M.call(this),a9(this),delete this.g};var ue=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}sL(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:function t(e){e.g=ut(function(){e.g=null,e.i&&(e.i=!1,t(e))},e.j);var n=e.h;e.h=null,e.m.apply(null,n)}(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(s3.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(ar);function un(t){ar.call(this),this.h=t,this.g={}}an(un,ar);var ur=[];function ui(t,e,n,r){Array.isArray(n)||(n&&(ur[0]=n.toString()),n=ur);for(var i=0;i<n.length;i++){var o=function t(e,n,r,i,o){if(i&&i.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=a$(r),e&&e[aL]?e.O(n,r,s8(i)?!!i.capture:!!i,o):aW(e,n,r,!0,i,o)}(e,n,r,i,o);if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=a$(r),e&&e[aL]?e.N(n,r,s8(i)?!!i.capture:!!i,o):aW(e,n,r,!1,i,o)}(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function uo(t){ap(t.g,function(t,e){this.g.hasOwnProperty(e)&&aH(t)},t),t.g={}}function us(){this.g=!0}function ua(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}}return a0(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}un.prototype.M=function(){un.Z.M.call(this),uo(this)},un.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},us.prototype.Aa=function(){this.g=!1},us.prototype.info=function(){};var uu={},uc=null;function uh(){return uc=uc||new aX}function ul(t){aP.call(this,uu.Ma,t)}function uf(t){var e=uh();aJ(e,new ul(e,t))}function ud(t,e){aP.call(this,uu.STAT_EVENT,t),this.stat=e}function up(t){var e=uh();aJ(e,new ud(e,t))}function uv(t,e){aP.call(this,uu.Na,t),this.size=e}function ug(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return s3.setTimeout(function(){t()},e)}uu.Ma="serverreachability",an(ul,aP),uu.STAT_EVENT="statevent",an(ud,aP),uu.Na="timingevent",an(uv,aP);var um={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},uy={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function u_(){}function ub(t){return t.h||(t.h=t.i())}function uw(){}u_.prototype.h=null;var uI={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function uT(){aP.call(this,"d")}function uE(){aP.call(this,"c")}function uS(){}function uC(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new un(this),this.P=uN,t=aI?125:void 0,this.W=new a7(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new uk}function uk(){this.i=null,this.g="",this.h=!1}an(uT,aP),an(uE,aP),an(uS,u_),uS.prototype.g=function(){return new XMLHttpRequest},uS.prototype.i=function(){return{}},l$=new uS;var uN=45e3,uA={},uR={};function ux(t,e,n){t.K=1,t.v=uZ(uG(e)),t.s=n,t.U=!0,uP(t,null)}function uP(t,e){t.F=Date.now(),uL(t),t.A=uG(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),cn(n.h,"t",r),t.C=0,n=t.l.H,t.h=new uk,t.g=c2(t.l,n?e:null,!t.s),0<t.O&&(t.L=new ue(at(t.Ia,t,t.g),t.O)),ui(t.V,t.g,"readystatechange",t.gb),e=t.H?av(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),uf(1),function(t,e,n,r,i,o){t.info(function(){if(t.g){if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null}else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.j,t.u,t.A,t.m,t.X,t.s)}function uD(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function uO(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;)if((r=function(t,e){var n=t.C,r=e.indexOf("\n",n);return -1==r?uR:isNaN(n=Number(e.substring(n,r)))?uA:(r+=1)+n>e.length?uR:(e=e.substr(r,n),t.C=r+n,e)}(t,n))==uR){4==e&&(t.o=4,up(14),i=!1),ua(t.j,t.m,null,"[Incomplete Response]");break}else if(r==uA){t.o=4,up(15),ua(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}else ua(t.j,t.m,r,null),uq(t,r);uD(t)&&r!=uR&&r!=uA&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,up(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),cQ(e),e.L=!0,up(11))):(ua(t.j,t.m,n,"[Invalid Chunked Response]"),uj(t),uU(t))}function uL(t){t.Y=Date.now()+t.P,uM(t,t.P)}function uM(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ug(at(t.eb,t),e)}function uF(t){t.B&&(s3.clearTimeout(t.B),t.B=null)}function uU(t){0==t.l.G||t.I||cX(t.l,t)}function uj(t){uF(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,a9(t.W),uo(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function uq(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||cc(n.i,t))){if(n.I=t.N,!t.J&&cc(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(n.g.F+3e3<t.F)c$(n),cj(n);else break t}cG(n),up(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=ug(at(n.ab,n),6e3));if(1>=cu(n.i)&&n.ka){try{n.ka()}catch(t){}n.ka=void 0}}else cZ(n,11)}else if((t.J||n.g==t)&&c$(n),!au(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G){if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(ah(h,"spdy")||ah(h,"quic")||ah(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(ch(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,uJ(r.F,r.D,f))}}if(n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),(r=n).oa=c1(r,r.H?r.la:null,r.W),t.J){cl(r.i,t);var d=r.K;d&&t.setTimeout(d),t.B&&(uF(t),uL(t)),r.g=t}else cz(r);0<n.l.length&&cB(n)}else"stop"!=o[0]&&"close"!=o[0]||cZ(n,7)}else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?cZ(n,7):cU(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}}uf(4)}catch(t){}}function uV(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(s5(t)||"string"==typeof t)ao(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(s5(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(s5(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function uB(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t){if(t instanceof uB)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}}function uK(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];uW(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)uW(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function uW(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(s1=uC.prototype).setTimeout=function(t){this.P=t},s1.gb=function(t){t=t.target;var e=this.L;e&&3==cD(t)?e.l():this.Ia(t)},s1.Ia=function(t){try{if(t==this.g)t:{var e=cD(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||aI||this.g&&(this.h.h||this.g.ga()||cO(this.g)))){this.I||4!=e||7==n||(8==n||0>=r?uf(3):uf(2)),uF(this);var i=this.g.ba();this.N=i;e:if(uD(this)){var o=cO(this.g);t="";var s=o.length,a=4==cD(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){uj(this),uU(this);var u="";break e}this.h.i=new s3.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!au(c)){var l=c;break e}}l=null}if(i=l)ua(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,uq(this,i);else{this.i=!1,this.o=3,up(12),uj(this),uU(this);break t}}this.U?(uO(this,e,u),aI&&this.i&&3==e&&(ui(this.V,this.W,"tick",this.fb),this.W.start())):(ua(this.j,this.m,u,null),uq(this,u)),4==e&&uj(this),this.i&&!this.I&&(4==e?cX(this.l,this):(this.i=!1,uL(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,up(12)):(this.o=0,up(13)),uj(this),uU(this)}}}catch(t){}finally{}},s1.fb=function(){if(this.g){var t=cD(this.g),e=this.g.ga();this.C<e.length&&(uF(this),uO(this,t,e),this.i&&4!=t&&uL(this))}},s1.cancel=function(){this.I=!0,uj(this)},s1.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(uf(3),up(17)),uj(this),this.o=2,uU(this)):uM(this,this.Y-t)},(s1=uB.prototype).R=function(){uK(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},s1.T=function(){return uK(this),this.g.concat()},s1.get=function(t,e){return uW(this.h,t)?this.h[t]:e},s1.set=function(t,e){uW(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},s1.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var uH=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function uz(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof uz){this.g=void 0!==e?e:t.g,uQ(this,t.j),this.s=t.s,uY(this,t.i),u$(this,t.m),this.l=t.l,e=t.h;var n=new u7;n.i=e.i,e.g&&(n.g=new uB(e.g),n.h=e.h),uX(this,n),this.o=t.o}else t&&(n=String(t).match(uH))?(this.g=!!e,uQ(this,n[1]||"",!0),this.s=u0(n[2]||""),uY(this,n[3]||"",!0),u$(this,n[4]),this.l=u0(n[5]||"",!0),uX(this,n[6]||"",!0),this.o=u0(n[7]||"")):(this.g=!!e,this.h=new u7(null,this.g))}function uG(t){return new uz(t)}function uQ(t,e,n){t.j=n?u0(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function uY(t,e,n){t.i=n?u0(e,!0):e}function u$(t,e){if(e){if(isNaN(e=Number(e))||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function uX(t,e,n){var r,i;e instanceof u7?(t.h=e,r=t.h,(i=t.g)&&!r.j&&(u9(r),r.i=null,r.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ct(this,e),cn(this,n,t))},r)),r.j=i):(n||(e=u1(e,u5)),t.h=new u7(e,t.g))}function uJ(t,e,n){t.h.set(e,n)}function uZ(t){return uJ(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function u0(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function u1(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,u2),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function u2(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}uz.prototype.toString=function(){var t=[],e=this.j;e&&t.push(u1(e,u4,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(u1(e,u4,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(u1(n,"/"==n.charAt(0)?u6:u3,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",u1(n,u8)),t.join("")};var u4=/[#\/\?@]/g,u3=/[#\?:]/g,u6=/[#\?]/g,u5=/[#\?@]/g,u8=/#/g;function u7(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function u9(t){t.g||(t.g=new uB,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function ct(t,e){u9(t),e=cr(t,e),uW(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,uW((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&uK(t)))}function ce(t,e){return u9(t),e=cr(t,e),uW(t.g.h,e)}function cn(t,e,n){ct(t,e),0<n.length&&(t.i=null,t.g.set(cr(t,e),aa(n)),t.h+=n.length)}function cr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(s1=u7.prototype).add=function(t,e){u9(this),this.i=null,t=cr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},s1.forEach=function(t,e){u9(this),this.g.forEach(function(n,r){ao(n,function(n){t.call(e,n,r,this)},this)},this)},s1.T=function(){u9(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},s1.R=function(t){u9(this);var e=[];if("string"==typeof t)ce(this,t)&&(e=as(e,this.g.get(cr(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=as(e,t[n])}return e},s1.set=function(t,e){return u9(this),this.i=null,ce(this,t=cr(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},s1.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},s1.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var ci=function(t,e){this.h=t,this.g=e};function co(t){this.l=t||cs,t=s3.PerformanceNavigationTiming?0<(t=s3.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(s3.g&&s3.g.Ea&&s3.g.Ea()&&s3.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var cs=10;function ca(t){return!!t.h||!!t.g&&t.g.size>=t.j}function cu(t){return t.h?1:t.g?t.g.size:0}function cc(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ch(t,e){t.g?t.g.add(e):t.h=e}function cl(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function cf(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=sM(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return aa(t.i)}function cd(){}function cp(){this.g=new cd}function cv(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function cg(t){this.l=t.$b||null,this.j=t.ib||!1}function cm(t,e){aX.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=cy,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}co.prototype.cancel=function(){var t,e;if(this.i=cf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=sM(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},cd.prototype.stringify=function(t){return s3.JSON.stringify(t,void 0)},cd.prototype.parse=function(t){return s3.JSON.parse(t,void 0)},an(cg,u_),cg.prototype.g=function(){return new cm(this.l,this.j)},cg.prototype.i=(lH={},function(){return lH}),an(cm,aX);var cy=0;function c_(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function cb(t){t.readyState=4,t.l=null,t.j=null,t.A=null,cw(t)}function cw(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(s1=cm.prototype).open=function(t,e){if(this.readyState!=cy)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,cw(this)},s1.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||s3).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},s1.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,cb(this)),this.readyState=cy},s1.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,cw(this)),this.g&&(this.readyState=3,cw(this),this.g))){if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==s3.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;c_(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))}},s1.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?cb(this):cw(this),3==this.readyState&&c_(this)}},s1.Ua=function(t){this.g&&(this.response=this.responseText=t,cb(this))},s1.Ta=function(t){this.g&&(this.response=t,cb(this))},s1.ha=function(){this.g&&cb(this)},s1.setRequestHeader=function(t,e){this.v.append(t,e)},s1.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},s1.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(cm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var cI=s3.JSON.parse;function cT(t){aX.call(this),this.headers=new uB,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=cE,this.K=this.L=!1}an(cT,aX);var cE="",cS=/^https?$/i,cC=["POST","PUT"];function ck(t){return"content-type"==t.toLowerCase()}function cN(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,cA(t),cx(t)}function cA(t){t.D||(t.D=!0,aJ(t,"complete"),aJ(t,"error"))}function cR(t){if(t.h&&void 0!==s4&&(!t.C[1]||4!=cD(t)||2!=t.ba())){if(t.v&&4==cD(t))ut(t.Fa,0,t);else if(aJ(t,"readystatechange"),4==cD(t)){t.h=!1;try{var e,n,r=t.ba();t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){if(n=0===r){var o=String(t.H).match(uH)[1]||null;if(!o&&s3.self&&s3.self.location){var s=s3.self.location.protocol;o=s.substr(0,s.length-1)}n=!cS.test(o?o.toLowerCase():"")}e=n}if(e)aJ(t,"complete"),aJ(t,"success");else{t.m=6;try{var a=2<cD(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",cA(t)}}finally{cx(t)}}}}function cx(t,e){if(t.g){cP(t);var n=t.g,r=t.C[0]?s6:null;t.g=null,t.C=null,e||aJ(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function cP(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(s3.clearTimeout(t.A),t.A=null)}function cD(t){return t.g?t.g.readyState:0}function cO(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case cE:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function cL(t,e,n){t:{for(i in n){var r,i=!1;break t}i=!0}i||(r="",ap(n,function(t,e){r+=e+":"+t+"\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):uJ(t,e,n))}function cM(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function cF(t){this.za=0,this.l=[],this.h=new us,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=cM("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=cM("baseRetryDelayMs",5e3,t),this.$a=cM("retryDelaySeedMs",1e4,t),this.Ya=cM("forwardChannelMaxRetries",2,t),this.ra=cM("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new co(t&&t.concurrentRequestLimit),this.Ca=new cp,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function cU(t){if(cq(t),3==t.G){var e=t.V++,n=uG(t.F);uJ(n,"SID",t.J),uJ(n,"RID",e),uJ(n,"TYPE","terminate"),cW(t,n),(e=new uC(t,t.h,e,void 0)).K=2,e.v=uZ(uG(n)),n=!1,s3.navigator&&s3.navigator.sendBeacon&&(n=s3.navigator.sendBeacon(e.v.toString(),"")),!n&&s3.Image&&((new Image).src=e.v,n=!0),n||(e.g=c2(e.l,null),e.g.ea(e.v)),e.F=Date.now(),uL(e)}c0(t)}function cj(t){t.g&&(cQ(t),t.g.cancel(),t.g=null)}function cq(t){cj(t),t.u&&(s3.clearTimeout(t.u),t.u=null),c$(t),t.i.cancel(),t.m&&("number"==typeof t.m&&s3.clearTimeout(t.m),t.m=null)}function cV(t,e){t.l.push(new ci(t.Za++,e)),3==t.G&&cB(t)}function cB(t){ca(t.i)||t.m||(t.m=!0,a3(t.Ha,t),t.C=0)}function cK(t,e){n=e?e.m:t.V++;var n,r=uG(t.F);uJ(r,"SID",t.J),uJ(r,"RID",n),uJ(r,"AID",t.U),cW(t,r),t.o&&t.s&&cL(r,t.o,t.s),n=new uC(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=cH(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),ch(t.i,n),ux(n,r,e)}function cW(t,e){t.j&&uV({},function(t,n){uJ(e,n,t)})}function cH(t,e,n){n=Math.min(t.l.length,n);var r=t.j?at(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{!function(t,e,n){var r=n||"";try{uV(t,function(t,n){var i=t;s8(t)&&(i=a0(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function cz(t){t.g||t.u||(t.Y=1,a3(t.Ga,t),t.A=0)}function cG(t){return!t.g&&!t.u&&!(3<=t.A)&&(t.Y++,t.u=ug(at(t.Ga,t),cJ(t,t.A)),t.A++,!0)}function cQ(t){null!=t.B&&(s3.clearTimeout(t.B),t.B=null)}function cY(t){t.g=new uC(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=uG(t.oa);uJ(e,"RID","rpc"),uJ(e,"SID",t.J),uJ(e,"CI",t.N?"0":"1"),uJ(e,"AID",t.U),cW(t,e),uJ(e,"TYPE","xmlhttp"),t.o&&t.s&&cL(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=uZ(uG(e)),n.s=null,n.U=!0,uP(n,t)}function c$(t){null!=t.v&&(s3.clearTimeout(t.v),t.v=null)}function cX(t,e){var n=null;if(t.g==e){c$(t),cQ(t),t.g=null;var r=2}else{if(!cc(t.i,e))return;n=e.D,cl(t.i,e),r=1}if(t.I=e.N,0!=t.G){if(e.i){if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i,o=t.C;aJ(r=uh(),new uv(r,n,e,o)),cB(t)}else cz(t)}else if(3==(o=e.o)||0==o&&0<t.I||!(1==r&&(i=e,!(cu(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.l=i.D.concat(t.l),!0):1!=t.G&&2!=t.G&&!(t.C>=(t.Xa?0:t.Ya))&&(t.m=ug(at(t.Ha,t,i),cJ(t,t.C)),t.C++,!0)))||2==r&&cG(t)))switch(n&&0<n.length&&((e=t.i).i=e.i.concat(n)),o){case 1:cZ(t,5);break;case 4:cZ(t,10);break;case 3:cZ(t,6);break;default:cZ(t,2)}}}function cJ(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function cZ(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=at(t.jb,t);n||(n=new uz("//www.google.com/images/cleardot.gif"),s3.location&&"http"==s3.location.protocol||uQ(n,"https"),uZ(n)),function(t,e){var n=new us;if(s3.Image){var r=new Image;r.onload=ae(cv,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ae(cv,n,r,"TestLoadImage: error",!1,e),r.onabort=ae(cv,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ae(cv,n,r,"TestLoadImage: timeout",!1,e),s3.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else up(2);t.G=0,t.j&&t.j.va(e),c0(t),cq(t)}function c0(t){t.G=0,t.I=-1,t.j&&((0!=cf(t.i).length||0!=t.l.length)&&(t.i.i.length=0,aa(t.l),t.l.length=0),t.j.ua())}function c1(t,e,n){var r=(i=n)instanceof uz?uG(i):new uz(i,void 0);if(""!=r.i)e&&uY(r,e+"."+r.i),u$(r,r.m);else{var i,o,s,a,u,c,h=s3.location;o=h.protocol,s=e?e+"."+h.hostname:h.hostname,a=+h.port,u=n,c=new uz(null,void 0),o&&uQ(c,o),s&&uY(c,s),a&&u$(c,a),u&&(c.l=u),r=c}return t.aa&&ap(t.aa,function(t,e){uJ(r,e,t)}),e=t.D,n=t.sa,e&&n&&uJ(r,e,n),uJ(r,"VER",t.ma),cW(t,r),r}function c2(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new cT(n&&t.Ba&&!t.qa?new cg({ib:!0}):t.qa)).L=t.H,e}function c4(){}function c3(){if(ab&&!(10<=Number(aR)))throw Error("Environmental error: no available transport.")}function c6(t,e){aX.call(this),this.g=new cF(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!au(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!au(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new c7(this)}function c5(t){uT.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function c8(){uE.call(this),this.status=1}function c7(t){this.g=t}(s1=cT.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():l$.g(),this.C=this.u?ub(this.u):ub(l$),this.g.onreadystatechange=at(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){cN(this,t);return}t=n||"";var i,o=new uB(this.headers);r&&uV(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=ck,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.T()),n=s3.FormData&&t instanceof s3.FormData,!(0<=ai(cC,e))||r||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{cP(this),0<this.B&&((this.K=(i=this.g,ab&&(Object.prototype.hasOwnProperty.call(aA,9)?aA[9]:aA[9]=function(){for(var t=0,e=ac(String(lG)).split("."),n=ac("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=al(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||al(0==o[2].length,0==s[2].length)||al(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}(9))&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.g.timeout=this.B,this.g.ontimeout=at(this.pa,this)):this.A=ut(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){cN(this,t)}},s1.pa=function(){void 0!==s4&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,aJ(this,"timeout"),this.abort(8))},s1.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,aJ(this,"complete"),aJ(this,"abort"),cx(this))},s1.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),cx(this,!0)),cT.Z.M.call(this)},s1.Fa=function(){this.s||(this.F||this.v||this.l?cR(this):this.cb())},s1.cb=function(){cR(this)},s1.ba=function(){try{return 2<cD(this)?this.g.status:-1}catch(t){return -1}},s1.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},s1.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),cI(e)}},s1.Da=function(){return this.m},s1.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(s1=cF.prototype).ma=8,s1.G=1,s1.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},s1.Ha=function(t){if(this.m){if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new uC(this,this.h,t,void 0),n=this.s;if(this.P&&(n?am(n=av(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){e:{var o=this.l[i];if("__data__"in o.g&&"string"==typeof(o=o.g.__data__)){o=o.length;break e}o=void 0}if(void 0===o)break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=cH(this,e,r),uJ(i=uG(this.F),"RID",t),uJ(i,"CVER",22),this.D&&uJ(i,"X-HTTP-Session-Id",this.D),cW(this,i),this.o&&n&&cL(i,this.o,n),ch(this.i,e),this.Ra&&uJ(i,"TYPE","init"),this.ja?(uJ(i,"$req",r),uJ(i,"SID","null"),e.$=!0,ux(e,i,null)):ux(e,i,r),this.G=2}}else 3==this.G&&(t?cK(this,t):0==this.l.length||ca(this.i)||cK(this))}},s1.Ga=function(){if(this.u=null,cY(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ug(at(this.bb,this),t)}},s1.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,up(10),cj(this),cY(this))},s1.ab=function(){null!=this.v&&(this.v=null,cj(this),cG(this),up(19))},s1.jb=function(t){t?(this.h.info("Successfully pinged google.com"),up(2)):(this.h.info("Failed to ping google.com"),up(1))},(s1=c4.prototype).xa=function(){},s1.wa=function(){},s1.va=function(){},s1.ua=function(){},s1.Oa=function(){},c3.prototype.g=function(t,e){return new c6(t,e)},an(c6,aX),c6.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),a3(at(t.hb,t,e))),up(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=c1(t,null,t.W),cB(t)},c6.prototype.close=function(){cU(this.g)},c6.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,cV(this.g,e)}else this.v?((e={}).__data__=a0(t),cV(this.g,e)):cV(this.g,t)},c6.prototype.M=function(){this.g.j=null,delete this.j,cU(this.g),delete this.g,c6.Z.M.call(this)},an(c5,uT),an(c8,uE),an(c7,c4),c7.prototype.xa=function(){aJ(this.g,"a")},c7.prototype.wa=function(t){aJ(this.g,new c5(t))},c7.prototype.va=function(t){aJ(this.g,new c8(t))},c7.prototype.ua=function(){aJ(this.g,"b")},c3.prototype.createWebChannel=c3.prototype.g,c6.prototype.send=c6.prototype.u,c6.prototype.open=c6.prototype.m,c6.prototype.close=c6.prototype.close,um.NO_ERROR=0,um.TIMEOUT=8,um.HTTP_ERROR=6,uy.COMPLETE="complete",uw.EventType=uI,uI.OPEN="a",uI.CLOSE="b",uI.ERROR="c",uI.MESSAGE="d",aX.prototype.listen=aX.prototype.N,cT.prototype.listenOnce=cT.prototype.O,cT.prototype.getLastError=cT.prototype.La,cT.prototype.getLastErrorCode=cT.prototype.Da,cT.prototype.getStatus=cT.prototype.ba,cT.prototype.getResponseJson=cT.prototype.Qa,cT.prototype.getResponseText=cT.prototype.ga,cT.prototype.send=cT.prototype.ea;var c9={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},ht=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();ht.o=-1;var he={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},hn=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return t_(e,t),e}(Error),hr=new eg("@firebase/firestore");function hi(){return hr.logLevel}function ho(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hr.logLevel<=sU.DEBUG){var r=e.map(hu);hr.debug.apply(hr,tS(["Firestore (8.7.0): "+t],r))}}function hs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hr.logLevel<=sU.ERROR){var r=e.map(hu);hr.error.apply(hr,tS(["Firestore (8.7.0): "+t],r))}}function ha(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hr.logLevel<=sU.WARN){var r=e.map(hu);hr.warn.apply(hr,tS(["Firestore (8.7.0): "+t],r))}}function hu(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function hc(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.7.0) INTERNAL ASSERTION FAILED: "+t;throw hs(e),Error(e)}var hh=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function hl(t,e){return t<e?-1:t>e?1:0}function hf(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}var hd=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0||e>=1e9)throw new hn(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800||t>=253402300800)throw new hn(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?hl(this.nanoseconds,t.nanoseconds):hl(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),hp=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new hd(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function hv(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function hg(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hm(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var hy=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&hc(),void 0===n?n=t.length-e:n>t.length-e&&hc(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return -1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),h_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0;i<t.length;i++){var o=t[i];if(o.indexOf("//")>=0)throw new hn(he.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");r.push.apply(r,o.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(hy),hb=/^[_a-zA-Z][_a-zA-Z0-9]*$/,hw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return hb.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new hn(he.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new hn(he.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new hn(he.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new hn(he.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(hy),hI=function(){function t(t){this.fields=t,t.sort(hw.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return hf(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),hT=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return hl(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();hT.EMPTY_BYTE_STRING=new hT("");var hE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hS(t){if(t||hc(),"string"==typeof t){var e=0,n=hE.exec(t);if(n||hc(),n[1]){var r=n[1];e=Number(r=(r+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(t).getTime()/1e3),nanos:e}}return{seconds:hC(t.seconds),nanos:hC(t.nanos)}}function hC(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function hk(t){return"string"==typeof t?hT.fromBase64String(t):hT.fromUint8Array(t)}function hN(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function hA(t){var e=hS(t.mapValue.fields.__local_write_time__.timestampValue);return new hd(e.seconds,e.nanos)}function hR(t){return null==t}function hx(t){return 0===t&&1/t==-1/0}function hP(t){return"number"==typeof t&&Number.isInteger(t)&&!hx(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var hD=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(h_.fromString(e))},t.fromName=function(e){return new t(h_.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===h_.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return h_.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new h_(e.slice()))},t}();function hO(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?hN(t)?4:10:hc()}function hL(t,e){var n=hO(t);if(n!==hO(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return hA(t).isEqual(hA(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=hS(t.timestampValue),r=hS(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return hk(t.bytesValue).isEqual(hk(e.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return hC(t.geoPointValue.latitude)===hC(e.geoPointValue.latitude)&&hC(t.geoPointValue.longitude)===hC(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return hC(t.integerValue)===hC(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=hC(t.doubleValue),r=hC(e.doubleValue);return n===r?hx(n)===hx(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return hf(t.arrayValue.values||[],e.arrayValue.values||[],hL);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(hv(n)!==hv(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!hL(n[i],r[i])))return!1;return!0}(t,e);default:return hc()}}function hM(t,e){return void 0!==(t.values||[]).find(function(t){return hL(t,e)})}function hF(t,e){var n,r,i,o,s,a,u,c,h,l=hO(t),f=hO(e);if(l!==f)return hl(l,f);switch(l){case 0:return 0;case 1:return hl(t.booleanValue,e.booleanValue);case 2:return(n=hC(t.integerValue||t.doubleValue))<(r=hC(e.integerValue||e.doubleValue))?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1;case 3:return hU(t.timestampValue,e.timestampValue);case 4:return hU(hA(t),hA(e));case 5:return hl(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,s=hk(i),a=hk(o),s.compareTo(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=hl(n[i],r[i]);if(0!==o)return o}return hl(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return u=t.geoPointValue,c=e.geoPointValue,0!==(h=hl(hC(u.latitude),hC(c.latitude)))?h:hl(hC(u.longitude),hC(c.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=hF(n[i],r[i]);if(o)return o}return hl(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=hl(r[s],o[s]);if(0!==a)return a;var u=hF(n[r[s]],i[o[s]]);if(0!==u)return u}return hl(r.length,o.length)}(t.mapValue,e.mapValue);default:throw hc()}}function hU(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return hl(t,e);var n=hS(t),r=hS(e),i=hl(n.seconds,r.seconds);return 0!==i?i:hl(n.nanos,r.nanos)}function hj(t){var e,n,r;return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?"time("+(r=hS(t.timestampValue)).seconds+","+r.nanos+")":"stringValue"in t?t.stringValue:"bytesValue"in t?hk(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,hD.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=hj(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+hj(t.fields[o])}return e+"}"}(t.mapValue):hc()}function hq(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function hV(t){return!!t&&"integerValue"in t}function hB(t){return!!t&&"arrayValue"in t}function hK(t){return!!t&&"nullValue"in t}function hW(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function hH(t){return!!t&&"mapValue"in t}function hz(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},hS(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return hg(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=hz(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=hz(t.arrayValue.values[r]);return n}return Object.assign({},t)}var hG=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!hH(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=hz(e)},t.prototype.setAll=function(t){var e=this,n=hw.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=hz(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());hH(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return hL(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];hH(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){hg(e,function(e,n){return t[e]=n});for(var r=0;r<n.length;r++){var i=n[r];delete t[i]}},t.prototype.clone=function(){return new t(hz(this.value))},t}(),hQ=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,hp.min(),hG.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,hG.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,hG.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=hG.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=hG.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),hY=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function h$(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new hY(t,e,n,r,i,o,s)}function hX(t){if(null===t.h){var e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:"+t.filters.map(function(t){return t.field.canonicalString()+t.op.toString()+hj(t.value)}).join(",")+"|ob:"+t.orderBy.map(function(t){return t.field.canonicalString()+t.dir}).join(","),hR(t.limit)||(e+="|l:"+t.limit),t.startAt&&(e+="|lb:"+lt(t.startAt)),t.endAt&&(e+="|ub:"+lt(t.endAt)),t.h=e}return t.h}function hJ(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i,o,s=0;s<t.orderBy.length;s++)if(n=t.orderBy[s],r=e.orderBy[s],!(n.dir===r.dir&&n.field.isEqual(r.field)))return!1;if(t.filters.length!==e.filters.length)return!1;for(var a=0;a<t.filters.length;a++)if(i=t.filters[a],o=e.filters[a],i.op!==o.op||!i.field.isEqual(o.field)||!hL(i.value,o.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!lr(t.startAt,e.startAt)&&lr(t.endAt,e.endAt)}function hZ(t){return hD.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var h0=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return t_(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new h1(t,n,r):"array-contains"===n?new h6(t,r):"in"===n?new h5(t,r):"not-in"===n?new h8(t,r):"array-contains-any"===n?new h7(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new h2(t,n):new h4(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(hF(e,this.value)):null!==e&&hO(this.value)===hO(e)&&this.m(hF(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return hc()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),h1=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=hD.fromName(r.referenceValue),i}return t_(e,t),e.prototype.matches=function(t){var e=hD.comparator(t.key,this.key);return this.m(e)},e}(h0),h2=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=h3("in",n),r}return t_(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(h0),h4=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=h3("not-in",n),r}return t_(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(h0);function h3(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return hD.fromName(t.referenceValue)})}var h6=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return t_(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return hB(e)&&hM(e.arrayValue,this.value)},e}(h0),h5=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return t_(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&hM(this.value.arrayValue,e)},e}(h0),h8=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return t_(e,t),e.prototype.matches=function(t){if(hM(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!hM(this.value.arrayValue,e)},e}(h0),h7=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return t_(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!hB(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return hM(e.value.arrayValue,t)})},e}(h0),h9=function(t,e){this.position=t,this.before=e};function lt(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return hj(t)}).join(",")}var le=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ln(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?hD.comparator(hD.fromName(s.referenceValue),n.key):hF(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function lr(t,e){if(null===t)return null===e;if(null===e||t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!hL(t.position[n],e.position[n]))return!1;return!0}var li=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function lo(t){return new li(t)}function ls(t){return!hR(t.limit)&&"F"===t.limitType}function la(t){return!hR(t.limit)&&"L"===t.limitType}function lu(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function lc(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function lh(t){return null!==t.collectionGroup}function ll(t){if(null===t.p){t.p=[];var e=lc(t),n=lu(t);if(null!==e&&null===n)e.isKeyField()||t.p.push(new le(e)),t.p.push(new le(hw.keyField(),"asc"));else{for(var r=!1,i=0,o=t.explicitOrderBy;i<o.length;i++){var s=o[i];t.p.push(s),s.field.isKeyField()&&(r=!0)}if(!r){var a=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new le(hw.keyField(),a))}}}return t.p}function lf(t){if(!t.T){if("F"===t.limitType)t.T=h$(t.path,t.collectionGroup,ll(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var e=[],n=0,r=ll(t);n<r.length;n++){var i=r[n],o="desc"===i.dir?"asc":"desc";e.push(new le(i.field,o))}var s=t.endAt?new h9(t.endAt.position,!t.endAt.before):null,a=t.startAt?new h9(t.startAt.position,!t.startAt.before):null;t.T=h$(t.path,t.collectionGroup,e,t.filters,t.limit,s,a)}}return t.T}function ld(t,e,n){return new li(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function lp(t,e){return hJ(lf(t),lf(e))&&t.limitType===e.limitType}function lv(t){return hX(lf(t))+"|lt:"+t.limitType}function lg(t){var e,n;return"Query(target="+(n=(e=lf(t)).path.canonicalString(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=", filters: ["+e.filters.map(function(t){return t.field.canonicalString()+" "+t.op+" "+hj(t.value)}).join(", ")+"]"),hR(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.canonicalString()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+lt(e.startAt)),e.endAt&&(n+=", endAt: "+lt(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")"}function lm(t,e){var n;return e.isFoundDocument()&&(n=e.key.path,null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):hD.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n))&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&!(t.startAt&&!ln(t.startAt,ll(t),e))&&(!t.endAt||!ln(t.endAt,ll(t),e))}function ly(t){return function(e,n){for(var r=!1,i=0,o=ll(t);i<o.length;i++){var s=o[i],a=function(t,e,n){var r,i,o,s=t.field.isKeyField()?hD.comparator(e.key,n.key):(r=t.field,i=e.data.field(r),o=n.data.field(r),null!==i&&null!==o?hF(i,o):hc());switch(t.dir){case"asc":return s;case"desc":return -1*s;default:return hc()}}(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function l_(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hx(e)?"-0":e}}function lb(t){return{integerValue:""+t}}function lw(t,e){return hP(e)?lb(e):l_(t,e)}var lI=function(){this._=void 0};function lT(t,e){return t instanceof lA?hV(e)||e&&"doubleValue"in e?e:{integerValue:0}:null}var lE=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e}(lI),lS=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return t_(e,t),e}(lI);function lC(t,e){for(var n=lx(e),r=function(t){n.some(function(e){return hL(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var lk=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return t_(e,t),e}(lI);function lN(t,e){for(var n=lx(e),r=function(t){n=n.filter(function(e){return!hL(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var lA=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return t_(e,t),e}(lI);function lR(t){return hC(t.integerValue||t.doubleValue)}function lx(t){return hB(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var lP=function(t,e){this.field=t,this.transform=e},lD=function(t,e){this.version=t,this.transformResults=e},lO=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function lL(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var lM=function(){};function lF(t,e,n){t instanceof lq?function(t,e,n){if(lL(t.precondition,e)){var r=t.value.clone(),i=lW(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(lj(e),r).setHasLocalMutations()}}(t,e,n):t instanceof lV?function(t,e,n){if(lL(t.precondition,e)){var r=lW(t.fieldTransforms,n,e),i=e.data;i.setAll(lB(t)),i.setAll(r),e.convertToFoundDocument(lj(e),i).setHasLocalMutations()}}(t,e,n):lL(t.precondition,e)&&e.convertToNoDocument(hp.min())}function lU(t,e){var n,r;return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||!(!n||!r)&&hf(n,r,function(t,e){var n,r;return t.field.isEqual(e.field)&&(n=t.transform,r=e.transform,n instanceof lS&&r instanceof lS||n instanceof lk&&r instanceof lk?hf(n.elements,r.elements,hL):n instanceof lA&&r instanceof lA?hL(n.A,r.A):n instanceof lE&&r instanceof lE)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function lj(t){return t.isFoundDocument()?t.version:hp.min()}var lq=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return t_(e,t),e}(lM),lV=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return t_(e,t),e}(lM);function lB(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function lK(t,e,n){var r=new Map;t.length===n.length||hc();for(var i=0;i<n.length;i++){var o,s=t[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,(o=n[i],a instanceof lS?lC(a,u):a instanceof lk?lN(a,u):o))}return r}function lW(t,e,n){for(var r=new Map,i=0;i<t.length;i++){var o=t[i],s=o.transform,a=n.data.field(o.field);r.set(o.field,function(t,e,n){var r,i,o;return t instanceof lE?(r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}},e&&(r.fields.__previous_value__=e),{mapValue:r}):t instanceof lS?lC(t,e):t instanceof lk?lN(t,e):(o=lR(i=lT(t,e))+lR(t.A),hV(i)&&hV(t.A)?lb(o):l_(t.R,o))}(s,a,e))}return r}var lH,lz,lG,lQ,lY,l$,lX,lJ,lZ=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return t_(e,t),e}(lM),l0=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return t_(e,t),e}(lM),l1=function(t){this.count=t};function l2(t){switch(t){case he.OK:return hc();case he.CANCELLED:case he.UNKNOWN:case he.DEADLINE_EXCEEDED:case he.RESOURCE_EXHAUSTED:case he.INTERNAL:case he.UNAVAILABLE:case he.UNAUTHENTICATED:return!1;case he.INVALID_ARGUMENT:case he.NOT_FOUND:case he.ALREADY_EXISTS:case he.PERMISSION_DENIED:case he.FAILED_PRECONDITION:case he.ABORTED:case he.OUT_OF_RANGE:case he.UNIMPLEMENTED:case he.DATA_LOSS:return!0;default:return hc()}}function l4(t){if(void 0===t)return hs("GRPC error has no .code"),he.UNKNOWN;switch(t){case lX.OK:return he.OK;case lX.CANCELLED:return he.CANCELLED;case lX.UNKNOWN:return he.UNKNOWN;case lX.DEADLINE_EXCEEDED:return he.DEADLINE_EXCEEDED;case lX.RESOURCE_EXHAUSTED:return he.RESOURCE_EXHAUSTED;case lX.INTERNAL:return he.INTERNAL;case lX.UNAVAILABLE:return he.UNAVAILABLE;case lX.UNAUTHENTICATED:return he.UNAUTHENTICATED;case lX.INVALID_ARGUMENT:return he.INVALID_ARGUMENT;case lX.NOT_FOUND:return he.NOT_FOUND;case lX.ALREADY_EXISTS:return he.ALREADY_EXISTS;case lX.PERMISSION_DENIED:return he.PERMISSION_DENIED;case lX.FAILED_PRECONDITION:return he.FAILED_PRECONDITION;case lX.ABORTED:return he.ABORTED;case lX.OUT_OF_RANGE:return he.OUT_OF_RANGE;case lX.UNIMPLEMENTED:return he.UNIMPLEMENTED;case lX.DATA_LOSS:return he.DATA_LOSS;default:return hc()}}(lJ=lX||(lX={}))[lJ.OK=0]="OK",lJ[lJ.CANCELLED=1]="CANCELLED",lJ[lJ.UNKNOWN=2]="UNKNOWN",lJ[lJ.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lJ[lJ.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lJ[lJ.NOT_FOUND=5]="NOT_FOUND",lJ[lJ.ALREADY_EXISTS=6]="ALREADY_EXISTS",lJ[lJ.PERMISSION_DENIED=7]="PERMISSION_DENIED",lJ[lJ.UNAUTHENTICATED=16]="UNAUTHENTICATED",lJ[lJ.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lJ[lJ.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lJ[lJ.ABORTED=10]="ABORTED",lJ[lJ.OUT_OF_RANGE=11]="OUT_OF_RANGE",lJ[lJ.UNIMPLEMENTED=12]="UNIMPLEMENTED",lJ[lJ.INTERNAL=13]="INTERNAL",lJ[lJ.UNAVAILABLE=14]="UNAVAILABLE",lJ[lJ.DATA_LOSS=15]="DATA_LOSS";var l3=function(){function t(t,e){this.comparator=t,this.root=e||l5.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,l5.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,l5.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return -1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new l6(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new l6(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new l6(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new l6(this.root,t,this.comparator,!0)},t}(),l6=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),l5=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(0>n(e,i.key))i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){return Math.pow(2,this.check())<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw hc();var t=this.left.check();if(t!==this.right.check())throw hc();return t+(this.isRed()?0:1)},t}();l5.EMPTY=null,l5.RED=!0,l5.BLACK=!1,l5.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw hc()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw hc()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw hc()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw hc()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw hc()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new l5(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var l8=function(){function t(t){this.comparator=t,this.data=new l3(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new l7(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new l7(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t)||this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),l7=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),l9=new l3(hD.comparator),ft=new l3(hD.comparator),fe=new l3(hD.comparator),fn=new l8(hD.comparator);function fr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=fn,r=0;r<t.length;r++){var i=t[r];n=n.add(i)}return n}var fi=new l8(hl),fo=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,fs.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(hp.min(),r,fi,l9,fr())},t}(),fs=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(hT.EMPTY_BYTE_STRING,n,fr(),fr(),fr())},t}(),fa=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},fu=function(t,e){this.targetId=t,this.V=e},fc=function(t,e,n,r){void 0===n&&(n=hT.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},fh=function(){function t(){this.S=0,this.D=fd(),this.C=hT.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=fr(),e=fr(),n=fr();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:hc()}}),new fs(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=fd()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),fl=function(){function t(t){this.W=t,this.G=new Map,this.H=l9,this.J=ff(),this.Y=new l8(hl)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:hc()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(hZ(i)){if(0===n){var o=new hD(i.path);this.tt(e,o,hQ.newNoDocument(o,hp.min()))}else 1===n||hc()}else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&hZ(o.target)){var s=new hD(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,hQ.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=fr();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new fo(t,n,this.Y,this.H,r);return this.H=l9,this.J=ff(),this.Y=new l8(hl),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new fh,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new l8(hl),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||ho("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new fh),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function ff(){return new l3(hD.comparator)}function fd(){return new l3(hD.comparator)}var fp={asc:"ASCENDING",desc:"DESCENDING"},fv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fg=function(t,e){this.databaseId=t,this.I=e};function fm(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function fy(t,e){return t.I?e.toBase64():e.toUint8Array()}function f_(t){var e;return t||hc(),hp.fromTimestamp((e=hS(t),new hd(e.seconds,e.nanos)))}function fb(t,e){return new h_(["projects",t.projectId,"databases",t.database]).child("documents").child(e).canonicalString()}function fw(t){var e=h_.fromString(t);return fj(e)||hc(),e}function fI(t,e){return fb(t.databaseId,e.path)}function fT(t,e){var n=fw(e);if(n.get(1)!==t.databaseId.projectId)throw new hn(he.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new hn(he.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new hD(fk(n))}function fE(t,e){return fb(t.databaseId,e)}function fS(t){var e=fw(t);return 4===e.length?h_.emptyPath():fk(e)}function fC(t){return new h_(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fk(t){return t.length>4&&"documents"===t.get(4)||hc(),t.popFirst(5)}function fN(t,e,n){return{name:fI(t,e),fields:n.value.mapValue.fields}}function fA(t,e,n){var r=fT(t,e.name),i=f_(e.updateTime),o=new hG({mapValue:{fields:e.fields}}),s=hQ.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function fR(t,e){var n,r,i,o;if(e instanceof lq)n={update:fN(t,e.key,e.value)};else if(e instanceof lZ)n={delete:fI(t,e.key)};else if(e instanceof lV)n={update:fN(t,e.key,e.data),updateMask:(i=e.fieldMask,o=[],i.fields.forEach(function(t){return o.push(t.canonicalString())}),{fieldPaths:o})};else{if(!(e instanceof l0))return hc();n={verify:fI(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof lE)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof lS)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof lk)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof lA)return{fieldPath:e.field.canonicalString(),increment:n.A};throw hc()}(0,t)})),e.precondition.isNone||(n.currentDocument=void 0!==(r=e.precondition).updateTime?{updateTime:fm(t,r.updateTime.toTimestamp())}:void 0!==r.exists?{exists:r.exists}:hc()),n}function fx(t,e){var n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?lO.updateTime(f_(s.updateTime)):void 0!==s.exists?lO.exists(s.exists):lO.none():lO.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;if("setToServerValue"in e)"REQUEST_TIME"===e.setToServerValue||hc(),n=new lE;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new lS(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new lk(i)}else"increment"in e?n=new lA(t,e.increment):hc();var o=hw.fromServerFormat(e.fieldPath);return new lP(o,n)}(t,e)}):[];if(e.update){e.update.name;var i=fT(t,e.update.name),o=new hG({mapValue:{fields:e.update.fields}});if(e.updateMask){var s,a,u=(a=e.updateMask.fieldPaths||[],new hI(a.map(function(t){return hw.fromServerFormat(t)})));return new lV(i,o,u,n,r)}return new lq(i,o,n,r)}if(e.delete){var c=fT(t,e.delete);return new lZ(c,n)}if(e.verify){var h=fT(t,e.verify);return new l0(h,n)}return hc()}function fP(t,e){return{documents:[fE(t,e.path)]}}function fD(t,e){var n,r={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(r.parent=fE(t,i),r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r.parent=fE(t,i.popLast()),r.structuredQuery.from=[{collectionId:i.lastSegment()}]);var o=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(hW(t.value))return{unaryFilter:{field:fF(t.field),op:"IS_NAN"}};if(hK(t.value))return{unaryFilter:{field:fF(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(hW(t.value))return{unaryFilter:{field:fF(t.field),op:"IS_NOT_NAN"}};if(hK(t.value))return{unaryFilter:{field:fF(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fF(t.field),op:fv[t.op],value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);o&&(r.structuredQuery.where=o);var s=function(t){if(0!==t.length)return t.map(function(t){return{field:fF(t.field),direction:fp[t.dir]}})}(e.orderBy);s&&(r.structuredQuery.orderBy=s);var a=(n=e.limit,t.I||hR(n)?n:{value:n});return null!==a&&(r.structuredQuery.limit=a),e.startAt&&(r.structuredQuery.startAt=fL(e.startAt)),e.endAt&&(r.structuredQuery.endAt=fL(e.endAt)),r}function fO(t){var e,n,r,i,o,s,a,u,c,h=fS(t.parent),l=t.structuredQuery,f=l.from?l.from.length:0,d=null;if(f>0){1===f||hc();var p=l.from[0];p.allDescendants?d=p.collectionId:h=h.child(p.collectionId)}var v=[];l.where&&(v=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=fU(t.unaryFilter.field);return h0.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=fU(t.unaryFilter.field);return h0.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=fU(t.unaryFilter.field);return h0.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=fU(t.unaryFilter.field);return h0.create(i,"!=",{nullValue:"NULL_VALUE"});default:return hc()}}(e)]:void 0!==e.fieldFilter?[h0.create(fU(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return hc()}}(e.fieldFilter.op),e.fieldFilter.value)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t(e)}).reduce(function(t,e){return t.concat(e)}):hc():[]}(l.where));var g=[];l.orderBy&&(g=l.orderBy.map(function(t){return new le(fU(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}));var m=null;l.limit&&(m=hR(n="object"==typeof(e=l.limit)?e.value:e)?null:n);var y=null;l.startAt&&(y=fM(l.startAt));var _=null;return l.endAt&&(_=fM(l.endAt)),r=h,i=d,o=g,s=v,a=m,u=y,c=_,new li(r,i,o,s,a,"F",u,c)}function fL(t){return{before:t.before,values:t.position}}function fM(t){var e=!!t.before,n=t.values||[];return new h9(n,e)}function fF(t){return{fieldPath:t.canonicalString()}}function fU(t){return hw.fromServerFormat(t.fieldPath)}function fj(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function fq(t){for(var e,n,r="",i=0;i<t.length;i++)r.length>0&&(r+="\x01\x01"),r=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\x00":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(i),r);return r+"\x01\x01"}function fV(t){var e=t.length;if(e>=2||hc(),2===e)return"\x01"===t.charAt(0)&&"\x01"===t.charAt(1)||hc(),h_.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&hc(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s)+"\x00";break;case"\x11":i+=t.substring(o,s+1);break;default:hc()}o=s+2}return new h_(r)}var fB=function(t,e){this.seconds=t,this.nanoseconds=e},fK=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};fK.store="owner",fK.key="owner";var fW=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};fW.store="mutationQueues",fW.keyPath="userId";var fH=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};fH.store="mutations",fH.keyPath="batchId",fH.userMutationsIndex="userMutationsIndex",fH.userMutationsKeyPath=["userId","batchId"];var fz=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,fq(e)]},t.key=function(t,e,n){return[t,fq(e),n]},t}();fz.store="documentMutations",fz.PLACEHOLDER=new fz;var fG=function(t,e){this.path=t,this.readTime=e},fQ=function(t,e){this.path=t,this.version=e},fY=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};fY.store="remoteDocuments",fY.readTimeIndex="readTimeIndex",fY.readTimeIndexPath="readTime",fY.collectionReadTimeIndex="collectionReadTimeIndex",fY.collectionReadTimeIndexPath=["parentPath","readTime"];var f$=function(t){this.byteSize=t};f$.store="remoteDocumentGlobal",f$.key="remoteDocumentGlobalKey";var fX=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};fX.store="targets",fX.keyPath="targetId",fX.queryTargetsIndexName="queryTargetsIndex",fX.queryTargetsKeyPath=["canonicalId","targetId"];var fJ=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};fJ.store="targetDocuments",fJ.keyPath=["targetId","path"],fJ.documentTargetsIndex="documentTargetsIndex",fJ.documentTargetsKeyPath=["path","targetId"];var fZ=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};fZ.key="targetGlobalKey",fZ.store="targetGlobal";var f0=function(t,e){this.collectionId=t,this.parent=e};f0.store="collectionParents",f0.keyPath=["collectionId","parent"];var f1=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};f1.store="clientMetadata",f1.keyPath="clientId";var f2=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};f2.store="bundles",f2.keyPath="bundleId";var f4=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};f4.store="namedQueries",f4.keyPath="name";var f3=tS(tS([],tS(tS([],tS(tS([],tS(tS([],[fW.store,fH.store,fz.store,fY.store,fX.store,fK.store,fZ.store,fJ.store]),[f1.store])),[f$.store])),[f0.store])),[f2.store,f4.store]),f6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",f5=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),f8=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},f7=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&hc(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0;i<e.length;i++)r(e[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),f9=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new f8,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new dn(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=du(e.target.error);n.ft.reject(new dn(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(t){throw new dn(n,t)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(ho("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new di(e)},t}(),dt=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(tF())&&hs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return ho("SimpleDb","Removing database:",t),ds(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=tF(),n=t._t(e),r=t.Et(e);return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||0<n&&n<10||0<r&&r<4.5)},t.gt=function(){return void 0!==ex&&"YES"===({}).Tt},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(e?e[1].split("_").slice(0,2).join("."):"-1")},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i);return Number(e?e[1].split(".").slice(0,2).join("."):"-1")},t.prototype.At=function(t){return tw(this,void 0,void 0,function(){var e,n=this;return tI(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(ho("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new dn(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new hn(he.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new dn(t,n))},i.onupgradeneeded=function(t){ho("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next(function(){ho("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return tw(this,void 0,void 0,function(){var i,o,s,a,u;return tI(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return tI(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),s=r(e=f9.open(a.db,t,i?"readonly":"readwrite",n)).catch(function(t){return e.abort(t),f7.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return h="FirebaseError"!==(c=l.sent()).name&&o<3,ho("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),de=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return ds(this.Pt.delete())},t}(),dn=function(t){function e(e,n){var r=this;return(r=t.call(this,he.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return t_(e,t),e}(hn);function dr(t){return"IndexedDbTransactionError"===t.name}var di=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(ho("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(ho("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ds(n)},t.prototype.add=function(t){return ho("SimpleDb","ADD",this.store.name,t,t),ds(this.store.add(t))},t.prototype.get=function(t){var e=this;return ds(this.store.get(t)).next(function(n){return void 0===n&&(n=null),ho("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return ho("SimpleDb","DELETE",this.store.name,t),ds(this.store.delete(t))},t.prototype.count=function(){return ho("SimpleDb","COUNT",this.store.name),ds(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){ho("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){e?n=t:(n={},e=t);var n,r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new f7(function(n,r){e.onerror=function(t){r(du(t.target.error))},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new f7(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new de(i),s=e(i.primaryKey,i.value,o);if(s instanceof f7){var a=s.catch(function(t){return o.done(),f7.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return f7.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ds(t){return new f7(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){n(du(t.target.error))}})}var da=!1;function du(t){var e=dt._t(tF());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new hn("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return da||(da=!0,setTimeout(function(){throw r},0)),r}}return t}var dc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return t_(e,t),e}(f5);function dh(t,e){return dt.It(t.Mt,e)}var dl=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&function(t,e,n){var r,i;t instanceof lq?(r=t.value.clone(),i=lK(t.fieldTransforms,e,n.transformResults),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()):t instanceof lV?function(t,e,n){if(lL(t.precondition,e)){var r=lK(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(lB(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e,n=0,r=this.baseMutations;n<r.length;n++)(e=r[n]).key.isEqual(t.key)&&lF(e,t,this.localWriteTime);for(var i=0,o=this.mutations;i<o.length;i++)(e=o[i]).key.isEqual(t.key)&&lF(e,t,this.localWriteTime)},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key);e.applyToLocalView(r),r.isValidDocument()||r.convertToNoDocument(hp.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},fr())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&hf(this.mutations,t.mutations,function(t,e){return lU(t,e)})&&hf(this.baseMutations,t.baseMutations,function(t,e){return lU(t,e)})},t}(),df=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){e.mutations.length===r.length||hc();for(var i=fe,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),dd=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=hp.min()),void 0===o&&(o=hp.min()),void 0===s&&(s=hT.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),dp=function(t){this.Lt=t};function dv(t,e){if(e.document)return fA(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=hD.fromSegments(e.noDocument.path),r=db(e.noDocument.readTime),i=hQ.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=hD.fromSegments(e.unknownDocument.path);return r=db(e.unknownDocument.version),hQ.newUnknownDocument(o,r)}return hc()}function dg(t,e,n){var r=dm(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o,s={name:fI(o=t.Lt,e.key),fields:e.data.value.mapValue.fields,updateTime:fm(o,e.version.toTimestamp())},a=e.hasCommittedMutations;return new fY(null,null,s,a,r,i)}if(e.isNoDocument()){var u=e.key.path.toArray(),c=d_(e.version);return a=e.hasCommittedMutations,new fY(null,new fG(u,c),null,a,r,i)}if(e.isUnknownDocument()){var h=e.key.path.toArray(),l=d_(e.version);return new fY(new fQ(h,l),null,null,!0,r,i)}return hc()}function dm(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function dy(t){var e=new hd(t[0],t[1]);return hp.fromTimestamp(e)}function d_(t){var e=t.toTimestamp();return new fB(e.seconds,e.nanoseconds)}function db(t){var e=new hd(t.seconds,t.nanoseconds);return hp.fromTimestamp(e)}function dw(t,e){for(var n=(e.baseMutations||[]).map(function(e){return fx(t.Lt,e)}),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map(function(e){return fx(t.Lt,e)}),a=hd.fromMillis(e.localWriteTimeMs);return new dl(e.batchId,a,n,s)}function dI(t){var e,n,r=db(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?db(t.lastLimboFreeSnapshotVersion):hp.min();return void 0!==t.query.documents?(1===(n=t.query).documents.length||hc(),e=lf(lo(fS(n.documents[0])))):e=lf(fO(t.query)),new dd(e,t.targetId,0,t.lastListenSequenceNumber,r,i,hT.fromBase64String(t.resumeToken))}function dT(t,e){var n,r=d_(e.snapshotVersion),i=d_(e.lastLimboFreeSnapshotVersion);n=hZ(e.target)?fP(t.Lt,e.target):fD(t.Lt,e.target);var o=e.resumeToken.toBase64();return new fX(e.targetId,hX(e.target),r,o,e.sequenceNumber,i,n)}function dE(t){var e=fO({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ld(e,e.limit,"L"):e}var dS=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return dC(t).get(e).next(function(t){if(t)return{id:t.bundleId,createTime:db(t.createTime),version:t.version}})},t.prototype.saveBundleMetadata=function(t,e){return dC(t).put({bundleId:e.id,createTime:d_(f_(e.createTime)),version:e.version})},t.prototype.getNamedQuery=function(t,e){return dk(t).get(e).next(function(t){if(t)return{name:t.name,query:dE(t.bundledQuery),readTime:db(t.readTime)}})},t.prototype.saveNamedQuery=function(t,e){return dk(t).put({name:e.name,readTime:d_(f_(e.readTime)),bundledQuery:e.bundledQuery})},t}();function dC(t){return dh(t,f2.store)}function dk(t){return dh(t,f4.store)}var dN=function(){function t(){this.Bt=new dA}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),f7.resolve()},t.prototype.getCollectionParents=function(t,e){return f7.resolve(this.Bt.getEntries(e))},t}(),dA=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new l8(h_.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new l8(h_.comparator)).toArray()},t}(),dR=function(){function t(){this.qt=new dA}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:fq(i)};return dx(t).put(o)}return f7.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[e+"\x00",""],!1,!0);return dx(t).Nt(r).next(function(t){for(var r=0;r<t.length;r++){var i=t[r];if(i.collectionId!==e)break;n.push(fV(i.parent))}return n})},t}();function dx(t){return dh(t,f0.store)}var dP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dD=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function dO(t,e,n){var r=t.store(fH.store),i=t.store(fz.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){1===a||hc()}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=fz.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return f7.waitFor(o).next(function(){return c})}function dL(t){var e;if(!t)return 0;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw hc();e=t.noDocument}return JSON.stringify(e).length}dD.DEFAULT_COLLECTION_PERCENTILE=10,dD.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dD.DEFAULT=new dD(41943040,dD.DEFAULT_COLLECTION_PERCENTILE,dD.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dD.DISABLED=new dD(-1,0,0);var dM=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return""!==e.uid||hc(),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return dU(t).$t({index:fH.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=dj(t),s=dU(t);return s.add({}).next(function(a){"number"==typeof a||hc();for(var u,c,h,l,f=new dl(a,e,n,r),d=(u=i.R,c=i.userId,h=f.baseMutations.map(function(t){return fR(u.Lt,t)}),l=f.mutations.map(function(t){return fR(u.Lt,t)}),new fH(c,f.batchId,f.localWriteTime.toMillis(),h,l)),p=[],v=new l8(function(t,e){return hl(t.canonicalString(),e.canonicalString())}),g=0;g<r.length;g++){var m=r[g],y=fz.key(i.userId,m.key.path,a);v=v.add(m.key.path.popLast()),p.push(s.put(d)),p.push(o.put(y,fz.PLACEHOLDER))}return v.forEach(function(e){p.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Kt[a]=f.keys()}),f7.waitFor(p).next(function(){return f})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return dU(t).get(e).next(function(t){return t?(t.userId===n.userId||hc(),dw(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?f7.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return dU(t).$t({index:fH.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(e.batchId>=r||hc(),o=dw(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return dU(t).$t({index:fH.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return dU(t).Nt(fH.userMutationsIndex,n).next(function(t){return t.map(function(t){return dw(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=fz.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return dj(t).$t({range:i},function(r,i,s){var a=r[0],u=r[1],c=r[2],h=fV(u);if(a===n.userId&&e.path.isEqual(h))return dU(t).get(c).next(function(t){if(!t)throw hc();t.userId===n.userId||hc(),o.push(dw(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new l8(hl),i=[];return e.forEach(function(e){var o=fz.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=dj(t).$t({range:s},function(t,i,o){var s=t[0],a=t[1],u=t[2],c=fV(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()});i.push(a)}),f7.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=fz.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new l8(hl);return dj(t).$t({range:s},function(t,e,o){var s=t[0],u=t[1],c=t[2],h=fV(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(dU(t).get(e).next(function(t){if(null===t)throw hc();t.userId===n.userId||hc(),r.push(dw(n.R,t))}))}),f7.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return dO(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),f7.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return f7.resolve();var r=IDBKeyRange.lowerBound(fz.prefixForUser(e.userId)),i=[];return dj(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=fV(t[1]);i.push(o)}else r.done()}).next(function(){0===i.length||hc()})})},t.prototype.containsKey=function(t,e){return dF(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return dq(t).get(this.userId).next(function(t){return t||new fW(e.userId,-1,"")})},t}();function dF(t,e,n){var r=fz.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return dj(t).$t({range:o,kt:!0},function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()}).next(function(){return s})}function dU(t){return dh(t,fH.store)}function dj(t){return dh(t,fz.store)}function dq(t){return dh(t,fW.store)}var dV=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),dB=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new dV(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return hp.fromTimestamp(new hd(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return dK(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return e.targetCount>0||hc(),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return dK(t).$t(function(s,a){var u=dI(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return f7.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return dK(t).$t(function(t,n){e(dI(n))})},t.prototype.Xt=function(t){return dW(t).get(fZ.key).next(function(t){return null!==t||hc(),t})},t.prototype.Zt=function(t,e){return dW(t).put(fZ.key,e)},t.prototype.te=function(t,e){return dK(t).put(dT(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=hX(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return dK(t).$t({range:r,index:fX.queryTargetsIndexName},function(t,n,r){var o=dI(n);hJ(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=dH(t);return e.forEach(function(e){var s=fq(e.path);i.push(o.put(new fJ(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),f7.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=dH(t);return f7.forEach(e,function(e){var o=fq(e.path);return f7.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=dH(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=dH(t),i=fr();return r.$t({range:n,kt:!0},function(t,e,n){var r=fV(t[1]),o=new hD(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=fq(e.path),r=IDBKeyRange.bound([n],[n+"\x00"],!1,!0),i=0;return dH(t).$t({index:fJ.documentTargetsIndex,kt:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return dK(t).get(e).next(function(t){return t?dI(t):null})},t}();function dK(t){return dh(t,fX.store)}function dW(t){return dh(t,fZ.store)}function dH(t){return dh(t,fJ.store)}function dz(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){if(t.code!==he.FAILED_PRECONDITION||t.message!==f6)throw t;return ho("LocalStore","Unexpectedly lost primary lease"),[2]})})}function dG(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=hl(n,i);return 0===s?hl(r,o):s}var dQ=function(){function t(t){this.ne=t,this.buffer=new l8(dG),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();0>dG(e,n)&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),dY=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;ho("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return tw(e,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return dr(e=n.sent())?(ho("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,dz(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),d$=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return f7.resolve(ht.o);var r=new dQ(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return -1===this.params.cacheSizeCollectionThreshold?(ho("LruGarbageCollector","Garbage collection skipped; disabled"),f7.resolve(dP)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(ho("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),dP):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(ho("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),hi()<=sU.DEBUG&&ho("LruGarbageCollector","LRU Garbage Collection\n	Counted targets in "+(o-h)+"ms\n	Determined least recently used "+r+" in "+(s-o)+"ms\n	Removed "+i+" targets in "+(a-s)+"ms\n	Removed "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),f7.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),dX=function(){function t(t,e){this.db=t,this.garbageCollector=new d$(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return dJ(t,n)},t.prototype.removeReference=function(t,e,n){return dJ(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return dJ(t,e)},t.prototype._e=function(t,e){var n;return n=!1,dq(t).Ot(function(r){return dF(t,r,e).next(function(t){return t&&(n=!0),f7.resolve(!t)})}).next(function(){return n})},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),dH(t).delete([0,fq(s.path)])})});i.push(u)}}).next(function(){return f7.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return dJ(t,e)},t.prototype.we=function(t,e){var n,r=dH(t),i=ht.o;return r.$t({index:fJ.documentTargetsIndex},function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==ht.o&&e(new hD(fV(n)),i),i=a,n=s):i=ht.o}).next(function(){i!==ht.o&&e(new hD(fV(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function dJ(t,e){var n;return dH(t).put((n=t.currentSequenceNumber,new fJ(0,fq(e.path),n)))}var dZ=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0;r<n.length;r++){var i=n[r],o=i[0],s=i[1];if(this.equalsFn(o,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){hg(this.inner,function(e,n){for(var r=0;r<n.length;r++){var i=n[r];t(i[0],i[1])}})},t.prototype.isEmpty=function(){return hm(this.inner)},t}(),d0=function(){function t(){this.changes=new dZ(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:hp.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:hQ.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?f7.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),d1=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return d3(t).put(d6(e),n)},t.prototype.removeEntry=function(t,e){var n=d3(t),r=d6(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return d3(t).get(d6(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return d3(t).get(d6(e)).next(function(t){return{document:n.ye(e,t),size:dL(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=l9;return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=l9,i=new l3(hD.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,dL(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return f7.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return d3(t).$t({range:r},function(t,e,r){for(var s=hD.fromSegments(t);o&&0>hD.comparator(o,s);)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=l9,o=e.path.length+1,s={};if(n.isEqual(hp.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=dm(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=fY.collectionReadTimeIndex}return d3(t).$t(s,function(t,n,s){if(t.length===o){var a=dv(r.R,n);e.path.isPrefixOf(a.key.path)?lm(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new d2(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return d4(t).get(f$.key).next(function(t){return t||hc(),t})},t.prototype.me=function(t,e){return d4(t).put(f$.key,e)},t.prototype.ye=function(t,e){if(e){var n=dv(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(hp.min()))return n}return hQ.newInvalidDocument(t)},t}(),d2=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new dZ(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return t_(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new l8(function(t,e){return hl(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=dg(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast()),r+=dL(u)-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var c=dg(e.Ie.R,hQ.newNoDocument(o,hp.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,c))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),f7.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(d0);function d4(t){return dh(t,f$.store)}function d3(t){return dh(t,fY.store)}function d6(t){return t.path.toArray()}var d5=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;n<r&&n>=0&&r<=11||hc();var o=new f9("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(fK.store)}(t),t.createObjectStore(fW.store,{keyPath:fW.keyPath}),t.createObjectStore(fH.store,{keyPath:fH.keyPath,autoIncrement:!0}).createIndex(fH.userMutationsIndex,fH.userMutationsKeyPath,{unique:!0}),t.createObjectStore(fz.store),d8(t),function(t){t.createObjectStore(fY.store)}(t));var s=f7.resolve();return n<3&&r>=3&&(0!==n&&(t.deleteObjectStore(fJ.store),t.deleteObjectStore(fX.store),t.deleteObjectStore(fZ.store),d8(t)),s=s.next(function(){var t,e;return t=o.store(fZ.store),e=new fZ(0,0,hp.min().toTimestamp(),0),t.put(fZ.key,e)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return o.store(fH.store).Nt().next(function(e){t.deleteObjectStore(fH.store),t.createObjectStore(fH.store,{keyPath:fH.keyPath,autoIncrement:!0}).createIndex(fH.userMutationsIndex,fH.userMutationsKeyPath,{unique:!0});var n=o.store(fH.store),r=e.map(function(t){return n.put(t)});return f7.waitFor(r)})})),s=s.next(function(){!function(t){t.createObjectStore(f1.store,{keyPath:f1.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(f$.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){var n;t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(n=e.objectStore(fY.store)).createIndex(fY.readTimeIndex,fY.readTimeIndexPath,{unique:!1}),n.createIndex(fY.collectionReadTimeIndex,fY.collectionReadTimeIndexPath,{unique:!1})})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){(function(t){t.createObjectStore(f2.store,{keyPath:f2.keyPath})})(t),function(t){t.createObjectStore(f4.store,{keyPath:f4.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(fY.store).$t(function(t,n){e+=dL(n)}).next(function(){var n=new f$(e);return t.store(f$.store).put(f$.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(fW.store),r=t.store(fH.store);return n.Nt().next(function(n){return f7.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(fH.userMutationsIndex,i).next(function(r){return f7.forEach(r,function(r){r.userId===n.userId||hc();var i=dw(e.R,r);return dO(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(fJ.store),n=t.store(fY.store);return t.store(fZ.store).get(fZ.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new h_(n),s=[0,fq(o)];r.push(e.get(s).next(function(n){return n?f7.resolve():e.put(new fJ(0,fq(o),t.highestListenSequenceNumber))}))}).next(function(){return f7.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(f0.store,{keyPath:f0.keyPath});var n=e.store(f0.store),r=new dA,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:fq(i)})}};return e.store(fY.store).$t({kt:!0},function(t,e){return i(new h_(t).popLast())}).next(function(){return e.store(fz.store).$t({kt:!0},function(t,e){t[0];var n=t[1];return t[2],i(fV(n).popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(fX.store);return n.$t(function(t,r){var i=dI(r),o=dT(e.R,i);return n.put(o)})},t}();function d8(t){t.createObjectStore(fJ.store,{keyPath:fJ.keyPath}).createIndex(fJ.documentTargetsIndex,fJ.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(fX.store,{keyPath:fX.keyPath}).createIndex(fX.queryTargetsIndexName,fX.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(fZ.store)}var d7="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",d9=function(){function t(e,n,r,i,o,s,a,u,c,h){var l,f;if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new hn(he.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new dX(this,i),this.Le=n+"main",this.R=new dp(u),this.Be=new dt(this.Le,11,new d5(this.R)),this.qe=new dB(this.referenceDelegate,this.R),this.Ut=new dR,this.Ue=(l=this.R,f=this.Ut,new d1(l,f)),this.Ke=new dS,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&hs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new hn(he.FAILED_PRECONDITION,d7);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new ht(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return tw(e,void 0,void 0,function(){return tI(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return tw(e,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return tw(e,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return pe(e).put(new f1(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(dr(e))return ho("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return ho("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return pt(t).get(fK.key).next(function(t){return f7.resolve(e.tn(t))})},t.prototype.en=function(t){return pe(t).delete(this.clientId)},t.prototype.nn=function(){return tw(this,void 0,void 0,function(){var t,e,n,r,i=this;return tI(this,function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=dh(t,f1.store);return e.Nt().next(function(t){var n=i.rn(t,18e5),r=t.filter(function(t){return -1===n.indexOf(t)});return f7.forEach(r,function(t){return e.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?f7.resolve(!0):pt(t).get(fK.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new hn(he.FAILED_PRECONDITION,d7);return!1}}return!(!e.networkEnabled||!e.inForeground)||pe(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&ho("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return tw(this,void 0,void 0,function(){var t=this;return tI(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[fK.store,f1.store],function(e){var n=new dc(e,ht.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return pe(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return dM.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r,i=this;return ho("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",f3,function(o){return r=new dc(o,i.Ne?i.Ne.next():ht.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw hs("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new hn(he.FAILED_PRECONDITION,f6);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return pt(t).get(fK.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new hn(he.FAILED_PRECONDITION,d7)})},t.prototype.Ze=function(t){var e=new fK(this.clientId,this.allowTabSynchronization,Date.now());return pt(t).put(fK.key,e)},t.yt=function(){return dt.yt()},t.prototype.Xe=function(t){var e=this,n=pt(t);return n.get(fK.key).next(function(t){return e.tn(t)?(ho("IndexedDbPersistence","Releasing primary lease."),n.delete(fK.key)):f7.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(hs("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return ho("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return hs("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){hs("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function pt(t){return dh(t,fK.store)}function pe(t){return dh(t,f1.store)}function pn(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var pr=function(t,e){this.progress=t,this.wn=e},pi=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0;e<n.length;e++)n[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0;r<e.length;r++)e[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return hD.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length?this.Tn(t,e.path):lh(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new hD(e)).next(function(t){var e=ft;return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=ft;return this.Ut.getCollectionParents(t,i).next(function(s){return f7.forEach(s,function(s){var a,u=(a=s.child(i),new li(a,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return r.An(t,u,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return i=e,o.Rn(t,i,r).next(function(t){r=t;for(var e=0;e<i.length;e++)for(var n=i[e],o=0,s=n.mutations;o<s.length;o++){var a=s[o],u=a.key,c=r.get(u);null==c&&(c=hQ.newInvalidDocument(u),r=r.insert(u,c)),lF(a,c,n.localWriteTime),c.isFoundDocument()||(r=r.remove(u))}})}).next(function(){return r.forEach(function(t,n){lm(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=fr(),i=0;i<e.length;i++)for(var o=0,s=e[i].mutations;o<s.length;o++){var a=s[o];a instanceof lV&&null===n.get(a.key)&&(r=r.add(a.key))}var u=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(u=u.insert(t,e))}),u})},t}(),po=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=fr(),i=fr(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ps=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())||n.isEqual(hp.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(ls(e)||la(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(hi()<=sU.DEBUG&&ho("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),lg(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new l8(ly(t));return e.forEach(function(e,r){lm(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return hi()<=sU.DEBUG&&ho("QueryEngine","Using full collection scan to execute query:",lg(e)),this.Sn.getDocumentsMatchingQuery(t,e,hp.min())},t}(),pa=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new l3(hl),this.kn=new dZ(function(t){return hX(t)},hJ),this.$n=hp.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new pi(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function pu(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o;return tI(this,function(s){switch(s.label){case 0:return r=(n=t)._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new pi(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=fr(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var d=0;d<e.length;d++){var p=e[d];r.push(p.batchId);for(var v=0,g=p.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function pc(t){return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.qe.getLastRemoteSnapshotVersion(e)})}function ph(t,e,n,r,i){var o=fr();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=l9;return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(hp.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):ho("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function pl(t,e){return t.persistence.runTransaction("Allocate target","readwrite",function(n){var r;return t.qe.getTargetData(n,e).next(function(i){return i?(r=i,f7.resolve(r)):t.qe.allocateTargetId(n).next(function(i){return r=new dd(e,i,0,n.currentSequenceNumber),t.qe.addTargetData(n,r).next(function(){return r})})})}).then(function(n){var r=t.Fn.get(n.targetId);return(null===r||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Fn=t.Fn.insert(n.targetId,n),t.kn.set(e,n.targetId)),n})}function pf(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o,s;return tI(this,function(a){switch(a.label){case 0:i=(r=t).Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!dr(s=a.sent()))throw s;return ho("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function pd(t,e,n){var r=hp.min(),i=fr();return t.persistence.runTransaction("Execute query","readonly",function(o){var s,a;return(s=lf(e),void 0!==(a=t.kn.get(s))?f7.resolve(t.Fn.get(a)):t.qe.getTargetData(o,s)).next(function(e){if(e)return r=e.lastLimboFreeSnapshotVersion,t.qe.getMatchingKeysForTargetId(o,e.targetId).next(function(t){i=t})}).next(function(){return t.xn.getDocumentsMatchingQuery(o,e,n?r:hp.min(),n?i:fr())}).next(function(t){return{documents:t,Bn:i}})})}function pp(t,e){var n=t.qe,r=t.Fn.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",function(t){return n.lt(t,e).next(function(t){return t?t.target:null})})}function pv(t){return t.persistence.runTransaction("Get new document changes","readonly",function(e){var n,r,i,o,s,a;return n=t.On,r=t.$n,i=l9,o=dm(r),s=d3(e),a=IDBKeyRange.lowerBound(o,!0),s.$t({index:fY.readTimeIndex,range:a},function(t,e){var r=dv(n.R,e);i=i.insert(r.key,r),o=e.readTime}).next(function(){return{wn:i,readTime:dy(o)}})}).then(function(e){var n=e.wn,r=e.readTime;return t.$n=r,n})}var pg=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return f7.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){return this.Qn.set(e.id,{id:e.id,version:e.version,createTime:f_(e.createTime)}),f7.resolve()},t.prototype.getNamedQuery=function(t,e){return f7.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,{name:e.name,query:dE(e.bundledQuery),readTime:f_(e.readTime)}),f7.resolve()},t}(),pm=function(){function t(){this.Wn=new l8(py.Gn),this.zn=new l8(py.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new py(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new py(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new hD(new h_([])),r=new py(n,t),i=new py(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new hD(new h_([])),n=new py(e,t),r=new py(e,t+1),i=fr();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new py(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),py=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return hD.comparator(t.key,e.key)||hl(t.ns,e.ns)},t.Hn=function(t,e){return hl(t.ns,e.ns)||hD.comparator(t.key,e.key)},t}(),p_=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new l8(py.Gn)}return t.prototype.checkEmpty=function(t){return f7.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new dl(i,e,n,r);this._n.push(o);for(var s=0;s<r.length;s++){var a=r[s];this.rs=this.rs.add(new py(a.key,i)),this.Ut.addToCollectionParentIndex(t,a.key.path.popLast())}return f7.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return f7.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return f7.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return f7.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return f7.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new py(e,0),i=new py(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),f7.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new l8(hl);return e.forEach(function(t){var e=new py(t,0),i=new py(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),f7.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;hD.isDocumentKey(i)||(i=i.child(""));var o=new py(new hD(i),0),s=new l8(hl);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),f7.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;0===this.hs(e.batchId,"removed")||hc(),this._n.shift();var r=this.rs;return f7.forEach(e.mutations,function(i){var o=new py(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new py(e,0),r=this.rs.firstAfterOrEqual(n);return f7.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,f7.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),pb=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new l3(hD.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return f7.resolve(n?n.document.clone():hQ.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=l9;return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():hQ.newInvalidDocument(t))}),f7.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=l9,i=new hD(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;0>=h.compareTo(n)||lm(e,c)&&(r=r.insert(c.key,c.clone()))}return f7.resolve(r)},t.prototype.fs=function(t,e){return f7.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new pw(this)},t.prototype.getSize=function(t){return f7.resolve(this.size)},t}(),pw=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return t_(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),f7.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(d0),pI=function(){function t(t){this.persistence=t,this.ds=new dZ(function(t){return hX(t)},hJ),this.lastRemoteSnapshotVersion=hp.min(),this.highestTargetId=0,this.ws=0,this._s=new pm,this.targetCount=0,this.ys=dV.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),f7.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return f7.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return f7.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),f7.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),f7.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new dV(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,f7.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),f7.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,f7.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),f7.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return f7.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return f7.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),f7.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),f7.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),f7.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return f7.resolve(n)},t.prototype.containsKey=function(t,e){return f7.resolve(this._s.containsKey(e))},t}(),pT=function(){function t(t,e){var n,r=this;this.gs={},this.Ne=new ht(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new pI(this),this.Ut=new dN,this.Ue=(n=this.Ut,new pb(n,function(t){return r.referenceDelegate.ps(t)})),this.R=new dp(e),this.Ke=new pg(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new p_(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;ho("MemoryPersistence","Starting transaction:",t);var i=new pE(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return f7.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),pE=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return t_(e,t),e}(f5),pS=function(){function t(t){this.persistence=t,this.As=new pm,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw hc()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),f7.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),f7.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),f7.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return f7.forEach(this.vs,function(r){var i=hD.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return f7.or([function(){return f7.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),pC=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function pk(t,e){return"firestore_clients_"+t+"_"+e}function pN(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function pA(t,e){return"firestore_targets_"+t+"_"+e}pC.UNAUTHENTICATED=new pC(null),pC.GOOGLE_CREDENTIALS=new pC("google-credentials-uid"),pC.FIRST_PARTY=new pC("first-party-uid");var pR=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new hn(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(hs("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),px=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new hn(i.error.code,i.error.message)),o?new t(e,i.state,r):(hs("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),pP=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=fi,s=0;i&&s<r.activeTargetIds.length;++s)i=hP(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(hs("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),pD=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(hs("SharedClientState","Failed to parse online state: "+e),null)},t}(),pO=function(){function t(){this.activeTargetIds=fi}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})},t}(),pL=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new l3(hl),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=pk(this.persistenceKey,this.Ns),this.Ms="firestore_sequence_number_"+this.persistenceKey,this.ks=this.ks.insert(this.Ns,new pO),this.Ls=RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us="firestore_online_state_"+this.persistenceKey,this.Ks="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return tw(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return tI(this,function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(pk(this.persistenceKey,r)))&&(o=pP.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.Fs(h);return this.$s=[],this.window.addEventListener("pagehide",function(){return l.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(pA(this.persistenceKey,t));if(n){var r=px.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(pA(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return ho("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){ho("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){ho("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this;if(t.storageArea===this.storage){if(ho("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Os)return void hs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return tw(e,void 0,void 0,function(){var e,n,r,i,o,s;return tI(this,function(a){if(this.started){if(null!==t.key){if(this.Ls.test(t.key)){if(null==t.newValue)return e=this.ti(t.key),[2,this.ei(e,null)];if(n=this.ni(t.key,t.newValue))return[2,this.ei(n.clientId,n)]}else if(this.Bs.test(t.key)){if(null!==t.newValue&&(r=this.si(t.key,t.newValue)))return[2,this.ii(r)]}else if(this.qs.test(t.key)){if(null!==t.newValue&&(i=this.ri(t.key,t.newValue)))return[2,this.oi(i)]}else if(t.key===this.Us){if(null!==t.newValue&&(o=this.js(t.newValue)))return[2,this.Ws(o)]}else if(t.key===this.Ms)(s=function(t){var e=ht.o;if(null!=t)try{var n=JSON.parse(t);"number"==typeof n||hc(),e=n}catch(t){hs("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==ht.o&&this.sequenceNumberHandler(s);else if(t.key===this.Ks)return[2,this.syncEngine.ci()]}}else this.$s.push(t);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new pR(this.currentUser,t,e,n),i=pN(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=pN(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=pA(this.persistenceKey,t),i=new px(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return pP.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return pR.Vs(new pC(i),r,e)},t.prototype.ri=function(t,e){var n=Number(this.qs.exec(t)[1]);return px.Vs(n,e)},t.prototype.js=function(t){return pD.Vs(t)},t.prototype.ii=function(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(ho("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=fi;return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),pM=function(){function t(){this.li=new pO,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new pO,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),pF=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),pU=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){ho("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){ho("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),pj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},pq=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),pV=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return t_(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new cT;s.listenOnce(uy.COMPLETE,function(){try{switch(s.getLastErrorCode()){case um.NO_ERROR:var e=s.getResponseJson();ho("Connection","XHR received:",JSON.stringify(e)),i(e);break;case um.TIMEOUT:ho("Connection",'RPC "'+t+'" timed out'),o(new hn(he.DEADLINE_EXCEEDED,"Request time out"));break;case um.HTTP_ERROR:var n=s.getStatus();if(ho("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a,u=(a=r.status.toLowerCase().replace(/_/g,"-"),Object.values(he).indexOf(a)>=0?a:he.UNKNOWN);o(new hn(u,r.message))}else o(new hn(he.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new hn(he.UNAVAILABLE,"Connection failed."));break;default:hc()}}finally{ho("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new c3,o=uh(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new cg({})),this.Fi(s.initMessageHeaders,e),tU()||tq()||tF().indexOf("Electron/")>=0||(n=tF()).indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0||tF().indexOf("MSAppHost/")>=0||tj()||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");ho("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,h=!1,l=new pq({Ei:function(t){h?ho("Connection","Not sending because WebChannel is closed:",t):(c||(ho("Connection","Opening WebChannel transport."),u.open(),c=!0),ho("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,uw.EventType.OPEN,function(){h||ho("Connection","WebChannel transport opened.")}),f(u,uw.EventType.CLOSE,function(){h||(h=!0,ho("Connection","WebChannel transport closed"),l.Vi())}),f(u,uw.EventType.ERROR,function(t){h||(h=!0,ha("Connection","WebChannel transport errored:",t),l.Vi(new hn(he.UNAVAILABLE,"The operation could not be completed")))}),f(u,uw.EventType.MESSAGE,function(t){var e;if(!h){var n=t.data[0];n||hc();var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){ho("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=lX[t];if(void 0!==e)return l4(e)}(i),s=r.message;void 0===o&&(o=he.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),h=!0,l.Vi(new hn(o,s)),u.close()}else ho("Connection","WebChannel received:",n),l.Si(n)}}),f(o,uu.STAT_EVENT,function(t){t.stat===c9.PROXY?ho("Connection","Detected buffering proxy"):t.stat===c9.NOPROXY&&ho("Connection","Detected no buffering proxy")}),setTimeout(function(){l.Pi()},0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);ho("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return ho("RestConnection","Received: ",t),t},function(e){throw ha("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.7.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=pj[t];return this.Di+"/v1/"+e+":"+n},t}());function pB(){return"undefined"!=typeof window?window:null}function pK(){return"undefined"!=typeof document?document:null}function pW(t){return new fg(t,!0)}var pH=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&ho("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),pz=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new pH(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return tw(this,void 0,void 0,function(){return tI(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===he.RESOURCE_EXHAUSTED?(hs(e.toString()),hs("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===he.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new hn(he.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return tw(t,void 0,void 0,function(){return tI(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return ho("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(ho("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),pG=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return t_(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r,i,o,s,a="NO_CHANGE"===(r=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:hc(),u=e.targetChange.targetIds||[],c=(i=e.targetChange.resumeToken,t.I?(void 0===i||"string"==typeof i||hc(),hT.fromBase64String(i||"")):(void 0===i||i instanceof Uint8Array||hc(),hT.fromUint8Array(i||new Uint8Array))),h=(l=e.targetChange.cause)&&(s=void 0===(o=l).code?he.UNKNOWN:l4(o.code),new hn(s,o.message||""));n=new fc(a,u,c,h||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime,u=fT(t,a.document.name),c=f_(a.document.updateTime);var l=new hG({mapValue:{fields:a.document.fields}}),f=(h=hQ.newFoundDocument(u,c,l),a.targetIds||[]),d=a.removedTargetIds||[];n=new fa(f,d,h.key,h)}else if("documentDelete"in e)e.documentDelete,(a=e.documentDelete).document,u=fT(t,a.document),c=a.readTime?f_(a.readTime):hp.min(),l=hQ.newNoDocument(u,c),h=a.removedTargetIds||[],n=new fa([],h,l.key,l);else if("documentRemove"in e)e.documentRemove,(a=e.documentRemove).document,u=fT(t,a.document),c=a.removedTargetIds||[],n=new fa([],c,u,null);else{if(!("filter"in e))return hc();e.filter;var p=e.filter;p.targetId,a=p.count||0,u=new l1(a),c=p.targetId,n=new fu(c,u)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return hp.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?hp.min():e.readTime?f_(e.readTime):hp.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e,n,r,i,o={};o.database=fC(this.R),o.addTarget=(e=this.R,(n=hZ(r=t.target)?{documents:fP(e,r)}:{query:fD(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=fy(e,t.resumeToken):t.snapshotVersion.compareTo(hp.min())>0&&(n.readTime=fm(e,t.snapshotVersion.toTimestamp())),n);var s=(this.R,null==(i=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return hc()}}(0,t.purpose))?null:{"goog-listen-tags":i});s&&(o.labels=s),this.cr(o)},e.prototype.yr=function(t){var e={};e.database=fC(this.R),e.removeTarget=t,this.cr(e)},e}(pz),pQ=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return t_(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(t.streamToken||hc(),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e,n,r=(e=t.writeResults,n=t.commitTime,e&&e.length>0?(void 0!==n||hc(),e.map(function(t){var e;return(e=t.updateTime?f_(t.updateTime):f_(n)).isEqual(hp.min())&&(e=f_(n)),new lD(e,t.transformResults||[])})):[]),i=f_(t.commitTime);return this.listener.Tr(i,r)}return t.writeResults&&0!==t.writeResults.length&&hc(),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=fC(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return fR(e.R,t)})};this.cr(n)},e}(pz),pY=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return t_(e,t),e.prototype.br=function(){if(this.Rr)throw new hn(he.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===he.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new hn(he.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===he.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new hn(he.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),p$=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(hs(e),this.Vr=!1):ho("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),pX=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return tw(o,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:return p5(this)?(ho("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return(e=t).Or.add(4),[4,pZ(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,pJ(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new p$(n,r)};function pJ(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:if(!p5(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function pZ(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function p0(t,e){t.$r.has(e.targetId)||(t.$r.set(e.targetId,e),p6(t)?p3(t):vh(t).er()&&p2(t,e))}function p1(t,e){var n=vh(t);t.$r.delete(e),n.er()&&p4(t,e),0===t.$r.size&&(n.er()?n.ir():p5(t)&&t.Br.set("Unknown"))}function p2(t,e){t.qr.U(e.targetId),vh(t).mr(e)}function p4(t,e){t.qr.U(e),vh(t).yr(e)}function p3(t){t.qr=new fl({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),vh(t).start(),t.Br.Sr()}function p6(t){return p5(t)&&!vh(t).tr()&&t.$r.size>0}function p5(t){return 0===t.Or.size}function p8(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){return t.$r.forEach(function(e,n){p2(t,e)}),[2]})})}function p7(t,e){return tw(this,void 0,void 0,function(){return tI(this,function(n){return t.qr=void 0,p6(t)?(t.Br.Nr(e),p3(t)):t.Br.set("Unknown"),[2]})})}function p9(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o;return tI(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof fc&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o;return tI(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:case 4:return s.sent(),[3,5];case 3:return r=s.sent(),ho("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,vt(t,r)];case 5:return[3,13];case 6:if(e instanceof fa?t.qr.X(e):e instanceof fu?t.qr.rt(e):t.qr.et(e),n.isEqual(hp.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,pc(t.localStore)];case 8:var a;return i=s.sent(),n.compareTo(i)>=0?[4,((a=t.qr.ut(n)).targetChanges.forEach(function(e,r){if(e.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(e.resumeToken,n))}}),a.targetMismatches.forEach(function(e){var n=t.$r.get(e);n&&(t.$r.set(e,n.withResumeToken(hT.EMPTY_BYTE_STRING,n.snapshotVersion)),p4(t,e),p2(t,new dd(n.target,e,1,n.sequenceNumber)))}),t.remoteSyncer.applyRemoteEvent(a))]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return ho("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,vt(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function vt(t,e,n){return tw(this,void 0,void 0,function(){var r=this;return tI(this,function(i){switch(i.label){case 0:if(!dr(e))throw e;return t.Or.add(1),[4,pZ(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return pc(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return tw(r,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:return ho("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,pJ(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function ve(t,e){return e().catch(function(n){return vt(t,n,e)})}function vn(t){return tw(this,void 0,void 0,function(){var e,n,r,i;return tI(this,function(o){var s,a,u;switch(o.label){case 0:n=vl(e=t),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,o.label=1;case 1:if(!(p5(s=e)&&s.kr.length<10))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,(a=e.localStore,u=r,a.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===u&&(u=-1),a._n.getNextMutationBatchAfterBatchId(t,u)}))];case 3:return null===(i=o.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=vl(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return[4,vt(e,o.sent())];case 5:return o.sent(),[3,6];case 6:return[3,1];case 7:return vr(e)&&vi(e),[2]}})})}function vr(t){return p5(t)&&!vl(t).tr()&&t.kr.length>0}function vi(t){vl(t).start()}function vo(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){return vl(t).Ar(),[2]})})}function vs(t){return tw(this,void 0,void 0,function(){var e,n,r,i;return tI(this,function(o){for(e=vl(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]})})}function va(t,e,n){return tw(this,void 0,void 0,function(){var r,i;return tI(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=df.from(r,e,n),[4,ve(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,vn(t)];case 2:return o.sent(),[2]}})})}function vu(t,e){return tw(this,void 0,void 0,function(){return tI(this,function(n){switch(n.label){case 0:return e&&vl(t).pr?[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){switch(i.label){case 0:return l2(r=e.code)&&r!==he.ABORTED?(n=t.kr.shift(),vl(t).sr(),[4,ve(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,vn(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return vr(t)&&vi(t),[2]}})})}function vc(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:return n=t,e?(n.Or.delete(2),[4,pJ(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,pZ(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function vh(t){var e,n,r,i=this;return t.Ur||(t.Ur=(e=t.datastore,n=t.asyncQueue,r={Ii:p8.bind(null,t),Ri:p7.bind(null,t),_r:p9.bind(null,t)},e.br(),new pG(n,e.Hi,e.credentials,e.R,r)),t.Mr.push(function(e){return tw(i,void 0,void 0,function(){return tI(this,function(n){switch(n.label){case 0:return e?(t.Ur.sr(),p6(t)?p3(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:n.sent(),t.qr=void 0,n.label=3;case 3:return[2]}})})})),t.Ur}function vl(t){var e,n,r,i=this;return t.Kr||(t.Kr=(e=t.datastore,n=t.asyncQueue,r={Ii:vo.bind(null,t),Ri:vu.bind(null,t),Ir:vs.bind(null,t),Tr:va.bind(null,t)},e.br(),new pQ(n,e.Hi,e.credentials,e.R,r)),t.Mr.push(function(e){return tw(i,void 0,void 0,function(){return tI(this,function(n){switch(n.label){case 0:return e?(t.Kr.sr(),[4,vn(t)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:n.sent(),t.kr.length>0&&(ho("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),n.label=4;case 4:return[2]}})})})),t.Kr}var vf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new f8,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new hn(he.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function vd(t,e){if(hs("AsyncQueue",e+": "+t),dr(t))return new hn(he.UNAVAILABLE,e+": "+t);throw t}var vp=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||hD.comparator(e.key,n.key)}:function(t,e){return hD.comparator(t.key,e.key)},this.keyedMap=ft,this.sortedSet=new l3(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t)||this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),vv=function(){function t(){this.Qr=new l3(hD.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):hc():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),vg=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,vp.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&lp(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),vm=function(){this.Wr=void 0,this.listeners=[]},vy=function(){this.queries=new dZ(function(t){return lv(t)},lp),this.onlineState="Unknown",this.Gr=new Set};function v_(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o,s,a;return tI(this,function(u){switch(u.label){case 0:if(n=t,r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new vm),!i)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=u.sent(),[3,4];case 3:return a=vd(u.sent(),"Initialization of query '"+lg(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&vT(n),[2]}})})}function vb(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o,s;return tI(this,function(a){return n=t,r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function vw(t,e){for(var n=!1,r=0;r<e.length;r++){var i=e[r],o=i.query,s=t.queries.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].Hr(i)&&(n=!0);s.Wr=i}}n&&vT(t)}function vI(t,e,n){var r=t.queries.get(e);if(r)for(var i=0,o=r.listeners;i<o.length;i++)o[i].onError(n);t.queries.delete(e)}function vT(t){t.Gr.forEach(function(t){t.next()})}var vE=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new vg(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=vg.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),vS=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),vC=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return fT(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?fA(this.R,t.document,!1):hQ.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return f_(t)},t}(),vk=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=vN(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new vC(this.R),r=0;r<t.length;r++){var i=t[r];if(i.metadata.queries)for(var o=n.qn(i.metadata.name),s=0,a=i.metadata.queries;s<a.length;s++){var u=a[s],c=(e.get(u)||fr()).add(o);e.set(u,c)}}return e},t.prototype.complete=function(){return tw(this,void 0,void 0,function(){var t,e,n,r,i;return tI(this,function(o){switch(o.label){case 0:return[4,function(t,e,n,r){return tw(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return tI(this,function(p){switch(p.label){case 0:for(i=t,o=fr(),s=l9,a=fe,u=0,c=n;u<c.length;u++)h=c[u],l=e.qn(h.metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Kn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,pl(i,lf(lo(h_.fromString("__bundle__/docs/"+r))))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return ph(t,f,s,hp.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}(this.localStore,new vC(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,function(t,e,n){return void 0===n&&(n=fr()),tw(this,void 0,void 0,function(){var r,i;return tI(this,function(o){switch(o.label){case 0:return[4,pl(t,lf(dE(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=t).persistence.runTransaction("Save named query","readwrite",function(t){var o=f_(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var s=r.withResumeToken(hT.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Ke.saveNamedQuery(t,e)})})]}})})}(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new pr(Object.assign({},this.progress),t))]}})})},t}();function vN(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var vA=function(t){this.key=t},vR=function(t){this.key=t},vx=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=fr(),this.mutatedKeys=fr(),this.lo=ly(t),this.fo=new vp(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new vv,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=ls(this.query)&&i.size===this.query.limit?i.last():null,c=la(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=lm(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&0>n.lo(l,c))&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),ls(this.query)||la(this.query))for(;s.size>this.query.limit;){var h=ls(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){var n,i,o;return n=t.type,i=e.type,(o=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return hc()}})(n)-o(i)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new vg(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new vv,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=fr(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new vR(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new vA(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=fr();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return vg.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),vP=function(t,e,n){this.query=t,this.targetId=e,this.view=n},vD=function(t){this.key=t,this.bo=!1},vO=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new dZ(function(t){return lv(t)},lp),this.Vo=new Map,this.So=new Set,this.Do=new l3(hD.comparator),this.Co=new Map,this.No=new pm,this.xo={},this.Fo=new Map,this.ko=dV.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function vL(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o,s,a;return tI(this,function(u){switch(u.label){case 0:return(o=(n=v8(t)).Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,pl(n.localStore,lf(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),[4,vM(n,e,r=s.targetId,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&p0(n.remoteStore,s),u.label=4;case 4:return[2,i]}})})}function vM(t,e,n,r){return tw(this,void 0,void 0,function(){var i,o,s,a,u,c;return tI(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return tw(this,void 0,void 0,function(){var i,o,s;return tI(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,pd(t.localStore,e.query,!1).then(function(t){var n=t.documents;return e.view._o(n,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(vY(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,pd(t.localStore,e,!0)];case 1:return i=h.sent(),s=(o=new vx(e,i.Bn))._o(i.documents),a=fs.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),vY(t,n,u.To),c=new vP(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function vF(t,e){return tw(this,void 0,void 0,function(){var n,r,i;return tI(this,function(o){switch(o.label){case 0:return r=(n=t).Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!lp(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,pf(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),p1(n.remoteStore,r.targetId),vG(n,r.targetId)}).catch(dz)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return vG(n,r.targetId),[4,pf(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function vU(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o;return tI(this,function(s){var a,u,c,h,l,f,d;switch(s.label){case 0:r=v7(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,(a=r.localStore,c=hd.now(),h=e.reduce(function(t,e){return t.add(e.key)},fr()),a.persistence.runTransaction("Locally write mutations","readwrite",function(t){return a.Mn.pn(t,h).next(function(n){u=n;for(var r=[],i=0;i<e.length;i++){var o=e[i],s=function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=lT(o.transform,s||null);null!=a&&(null==n&&(n=hG.empty()),n.set(o.field,a))}return n||null}(o,u.get(o.key));null!=s&&r.push(new lV(o.key,s,function t(e){var n=[];return hg(e.fields,function(e,r){var i=new hw([e]);if(hH(r)){var o=t(r.mapValue).fields;if(0===o.length)n.push(i);else for(var s=0;s<o.length;s++){var a=o[s];n.push(i.child(a))}}else n.push(i)}),new hI(n)}(s.value.mapValue),lO.exists(!0)))}return a._n.addMutationBatch(t,c,r,e)})}).then(function(t){return t.applyToLocalDocumentSet(u),{batchId:t.batchId,changes:u}}))];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),l=r,f=i.batchId,(d=l.xo[l.currentUser.toKey()])||(d=new l3(hl)),d=d.insert(f,n),l.xo[l.currentUser.toKey()]=d,[4,vX(r,i.changes)];case 3:return s.sent(),[4,vn(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=vd(s.sent(),"Failed to persist write"),n.reject(o),[3,6];case 6:return[2]}})})}function vj(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){var o,s,a;switch(i.label){case 0:n=t,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,(o=n.localStore,s=e.snapshotVersion,a=o.Fn,o.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var n=o.On.newChangeBuffer({trackRemovals:!0});a=o.Fn;var r=[];e.targetChanges.forEach(function(e,n){var i=a.get(n);if(i){r.push(o.qe.removeMatchingKeys(t,e.removedDocuments,n).next(function(){return o.qe.addMatchingKeys(t,e.addedDocuments,n)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=i.withResumeToken(u,s).withSequenceNumber(t.currentSequenceNumber);a=a.insert(n,c),c.resumeToken.approximateByteSize()>0||hc(),(0===i.resumeToken.approximateByteSize()||c.snapshotVersion.toMicroseconds()-i.snapshotVersion.toMicroseconds()>=3e8||e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size>0)&&r.push(o.qe.updateTargetData(t,c))}}});var i=l9;if(e.documentUpdates.forEach(function(n,i){e.resolvedLimboDocuments.has(n)&&r.push(o.persistence.referenceDelegate.updateLimboDocument(t,n))}),r.push(ph(t,n,e.documentUpdates,s,void 0).next(function(t){i=t})),!s.isEqual(hp.min())){var u=o.qe.getLastRemoteSnapshotVersion(t).next(function(e){return o.qe.setTargetsMetadata(t,t.currentSequenceNumber,s)});r.push(u)}return f7.waitFor(r).next(function(){return n.apply(t)}).next(function(){return o.Mn.En(t,i)}).next(function(){return i})}).then(function(t){return o.Fn=a,t}))];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1||hc(),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?r.bo||hc():t.removedDocuments.size>0&&(r.bo||hc(),r.bo=!1))}),[4,vX(n,r,e)];case 3:case 5:return i.sent(),[3,6];case 4:return[4,dz(i.sent())];case 6:return[2]}})})}function vq(t,e,n){if(t.isPrimaryClient&&0===n||!t.isPrimaryClient&&1===n){var r,i,o=[];t.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&o.push(r.snapshot)}),(r=t.eventManager).onlineState=e,i=!1,r.queries.forEach(function(t,n){for(var r=0,o=n.listeners;r<o.length;r++)o[r].zr(e)&&(i=!0)}),i&&vT(r),o.length&&t.vo._r(o),t.onlineState=e,t.isPrimaryClient&&t.sharedClientState.setOnlineState(e)}}function vV(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o,s,a;return tI(this,function(u){switch(u.label){case 0:return(r=t).sharedClientState.updateQueryState(e,"rejected",n),(o=(i=r.Co.get(e))&&i.key)?(s=(s=new l3(hD.comparator)).insert(o,hQ.newNoDocument(o,hp.min())),a=fr().add(o),[4,vj(r,new fo(hp.min(),new Map,new l8(hl),s,a))]):[3,2];case 1:return u.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),v$(r),[3,4];case 2:return[4,pf(r.localStore,e,!1).then(function(){return vG(r,e,n)}).catch(dz)];case 3:u.sent(),u.label=4;case 4:return[2]}})})}function vB(t,e){return tw(this,void 0,void 0,function(){var n,r,i;return tI(this,function(o){var s;switch(o.label){case 0:n=t,r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,(s=n.localStore).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var n,r,i,o=e.batch.keys(),a=s.On.newChangeBuffer({trackRemovals:!0});return(r=(n=e.batch).keys(),i=f7.resolve(),r.forEach(function(r){i=i.next(function(){return a.getEntry(t,r)}).next(function(t){var i=e.docVersions.get(r);null!==i||hc(),0>t.version.compareTo(i)&&(n.applyToRemoteDocument(t,e),t.isValidDocument()&&a.addEntry(t,e.commitVersion))})}),i.next(function(){return s._n.removeMutationBatch(t,n)})).next(function(){return a.apply(t)}).next(function(){return s._n.performConsistencyCheck(t)}).next(function(){return s.Mn.pn(t,o)})})];case 2:return i=o.sent(),vz(n,r,null),vH(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,vX(n,i)];case 3:case 5:return o.sent(),[3,6];case 4:return[4,dz(o.sent())];case 6:return[2]}})})}function vK(t,e,n){return tw(this,void 0,void 0,function(){var r,i;return tI(this,function(o){var s;switch(o.label){case 0:r=t,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,(s=r.localStore).persistence.runTransaction("Reject batch","readwrite-primary",function(t){var n;return s._n.lookupMutationBatch(t,e).next(function(e){return null!==e||hc(),n=e.keys(),s._n.removeMutationBatch(t,e)}).next(function(){return s._n.performConsistencyCheck(t)}).next(function(){return s.Mn.pn(t,n)})})];case 2:return i=o.sent(),vz(r,e,n),vH(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,vX(r,i)];case 3:case 5:return o.sent(),[3,6];case 4:return[4,dz(o.sent())];case 6:return[2]}})})}function vW(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o;return tI(this,function(s){var a;switch(s.label){case 0:p5((n=t).remoteStore)||ho("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,(a=n.localStore).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return a._n.getHighestUnacknowledgedBatchId(t)})];case 2:return -1===(r=s.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=vd(s.sent(),"Initialization of waitForPendingWrites() operation failed"),e.reject(o),[3,4];case 4:return[2]}})})}function vH(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function vz(t,e,n){var r=t.xo[t.currentUser.toKey()];if(r){var i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),t.xo[t.currentUser.toKey()]=r}}function vG(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||vQ(t,e)})}function vQ(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(p1(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),v$(t))}function vY(t,e,n){for(var r=0;r<n.length;r++){var i=n[r];i instanceof vA?(t.No.addReference(i.key,e),function(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(ho("SyncEngine","New document in limbo: "+n),t.So.add(r),v$(t))}(t,i)):i instanceof vR?(ho("SyncEngine","Document no longer in limbo: "+i.key),t.No.removeReference(i.key,e),t.No.containsKey(i.key)||vQ(t,i.key)):hc()}}function v$(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new hD(h_.fromString(e)),r=t.ko.next();t.Co.set(r,new vD(n)),t.Do=t.Do.insert(n,r),p0(t.remoteStore,new dd(lf(lo(n.path)),r,2,ht.o))}}function vX(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o,s;return tI(this,function(a){switch(a.label){case 0:return i=[],o=[],s=[],(r=t).Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=po.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h;return tI(this,function(l){switch(l.label){case 0:n=t,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return f7.forEach(e,function(e){return f7.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return f7.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return l.sent(),[3,4];case 3:if(!dr(r=l.sent()))throw r;return ho("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(c=(u=n.Fn.get(a)).snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(a,h));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function vJ(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){var o;switch(i.label){case 0:return(n=t).currentUser.isEqual(e)?[3,3]:(ho("SyncEngine","User change. New user:",e.toKey()),[4,pu(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,(o=n).Fo.forEach(function(t){t.forEach(function(t){t.reject(new hn(he.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.Fo.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,vX(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function vZ(t,e){var n=t.Co.get(e);if(n&&n.bo)return fr().add(n.key);var r=fr(),i=t.Vo.get(e);if(!i)return r;for(var o=0;o<i.length;o++){var s=i[o],a=t.Po.get(s);r=r.unionWith(a.view.wo)}return r}function v0(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){return[2,pv((e=t).localStore).then(function(t){return vX(e,t)})]})})}function v1(t,e,n,r){return tw(this,void 0,void 0,function(){var i,o;return tI(this,function(s){switch(s.label){case 0:var a,u;return[4,(u=(a=(i=t).localStore)._n,a.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return u.jt(t,e).next(function(e){return e?a.Mn.pn(t,e):f7.resolve(null)})}))];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,vn(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(vz(i,e,r||null),vH(i,e),function(t,e){t._n.Gt(e)}(i.localStore,e)):hc(),s.label=4;case 4:return[4,vX(i,o)];case 5:return s.sent(),[3,7];case 6:ho("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function v2(t,e,n){return tw(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p,v;return tI(this,function(g){switch(g.label){case 0:n=t,r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,pl(n.localStore,lf(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],d=n.Po.get(f),[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i;return tI(this,function(o){switch(o.label){case 0:return[4,pd((n=t).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&vY(n,e.targetId,i.To),i)]}})})}(n,d)]):[3,6];case 4:(p=g.sent()).snapshot&&i.push(p.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,pp(n.localStore,a)];case 8:return v=g.sent(),[4,pl(n.localStore,v)];case 9:return u=g.sent(),[4,vM(n,v4(v),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function v4(t){var e,n,r,i,o,s,a;return e=t.path,n=t.collectionGroup,r=t.orderBy,i=t.filters,o=t.limit,s=t.startAt,a=t.endAt,new li(e,n,r,i,o,"F",s,a)}function v3(t){return t.localStore.persistence.fn()}function v6(t,e,n,r){return tw(this,void 0,void 0,function(){var i;return tI(this,function(o){switch(o.label){case 0:return(i=t).$o?(ho("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,pv(i.localStore)];case 3:return[4,vX(i,o.sent(),fo.createSynthesizedRemoteEventForCurrentChange(e,"current"===n))];case 4:return o.sent(),[3,8];case 5:return[4,pf(i.localStore,e,!0)];case 6:return o.sent(),vG(i,e,r),[3,8];case 7:hc(),o.label=8;case 8:return[2]}})})}function v5(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return tI(this,function(f){switch(f.label){case 0:if(!(r=v8(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(ho("SyncEngine","Adding an already active target "+s),[3,5]):[4,pp(r.localStore,s)]):[3,6];case 2:return a=f.sent(),[4,pl(r.localStore,a)];case 3:return u=f.sent(),[4,vM(r,v4(a),u.targetId,!1)];case 4:f.sent(),p0(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return tI(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,pf(r.localStore,t,!1).then(function(){p1(r.remoteStore,t),vG(r,t)}).catch(dz)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function v8(t){return t.remoteStore.remoteSyncer.applyRemoteEvent=vj.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=vZ.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=vV.bind(null,t),t.vo._r=vw.bind(null,t.eventManager),t.vo.Mo=vI.bind(null,t.eventManager),t}function v7(t){return t.remoteStore.remoteSyncer.applySuccessfulWrite=vB.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=vK.bind(null,t),t}function v9(t,e,n){(function(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o,s,a,u;return tI(this,function(c){var h,l,f,d,p,v;switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,(h=t.localStore,f=f_((l=r).createTime),h.persistence.runTransaction("hasNewerBundle","readonly",function(t){return h.Ke.getBundleMetadata(t,l.id)}).then(function(t){return!!t&&t.createTime.compareTo(f)>=0}))];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n._completeWith({taskState:"Success",documentsLoaded:(d=r).totalDocuments,bytesLoaded:d.totalBytes,totalDocuments:d.totalDocuments,totalBytes:d.totalBytes}))];case 4:return n._updateProgress(vN(r)),i=new vk(r,t.localStore,e.R),[4,e.Lo()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(s=c.sent())&&n._updateProgress(s),[4,e.Lo()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return[4,vX(t,(a=c.sent()).wn,void 0)];case 12:return c.sent(),[4,(p=t.localStore,v=r,p.persistence.runTransaction("Save bundle","readwrite",function(t){return p.Ke.saveBundleMetadata(t,v)}))];case 13:return c.sent(),n._completeWith(a.progress),[3,15];case 14:return ha("SyncEngine","Loading bundle failed with "+(u=c.sent())),n._failWith(u),[3,15];case 15:return[2]}})})})(t,e,n).then(function(){t.sharedClientState.notifyBundleLoaded()})}var gt=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:return this.R=pW(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){var e,n,r,i;return e=this.persistence,n=new ps,r=t.initialUser,i=this.R,new pa(e,n,r,i)},t.prototype.qo=function(t){return new pT(pS.bs,this.R)},t.prototype.Bo=function(t){return new pM},t.prototype.terminate=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),ge=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return t_(e,t),e.prototype.initialize=function(e){return tw(this,void 0,void 0,function(){return tI(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){return[2,(e=t).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){var e,n;return e=d3(t),n=hp.min(),e.$t({index:fY.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=dy(e.readTime)),r.done()}).next(function(){return n})}).then(function(t){e.$n=t})]})})}(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,v7(this.Qo.syncEngine)];case 4:return n.sent(),[4,vn(this.Qo.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Ko=function(t){var e,n,r,i;return e=this.persistence,n=new ps,r=t.initialUser,i=this.R,new pa(e,n,r,i)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new dY(e,t.asyncQueue)},e.prototype.qo=function(t){var e=pn(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?dD.withCacheSize(this.cacheSizeBytes):dD.DEFAULT;return new d9(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,pB(),pK(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new pM},e}(gt),gn=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return t_(e,t),e.prototype.initialize=function(e){return tw(this,void 0,void 0,function(){var n,r=this;return tI(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof pL?(this.sharedClientState.syncEngine={ui:v1.bind(null,n),ai:v6.bind(null,n),hi:v5.bind(null,n),fn:v3.bind(null,n),ci:v0.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return tw(r,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:return[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return tI(this,function(h){var l;switch(h.label){case 0:return v8(n=t),v7(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,v2(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,vc(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],p0(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then(function(){return vG(n,e),pf(n.localStore,e,!0)}),p1(n.remoteStore,e)}),[4,c]);case 4:return h.sent(),[4,v2(n,u)];case 5:return h.sent(),(l=n).Co.forEach(function(t,e){p1(l.remoteStore,e)}),l.No.ts(),l.Co=new Map,l.Do=new l3(hD.comparator),n.$o=!1,[4,vc(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}})})}(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=pB();if(!pL.yt(e))throw new hn(he.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=pn(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new pL(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(ge),gr=function(){function t(){}return t.prototype.initialize=function(t,e){return tw(this,void 0,void 0,function(){var n=this;return tI(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return vq(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=vJ.bind(null,this.syncEngine),[4,vc(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new vy},t.prototype.createDatastore=function(t){var e,n,r=pW(t.databaseInfo.databaseId),i=(n=t.databaseInfo,new pV(n));return e=t.credentials,new pY(e,i,r)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=pU.yt()?new pU:new pF,new pX(e,n,r,function(t){return vq(o.syncEngine,t,0)},i)},t.prototype.createSyncEngine=function(t,e){var n,r,i,o,s,a,u;return n=this.localStore,r=this.remoteStore,i=this.eventManager,o=this.sharedClientState,s=t.initialUser,a=t.maxConcurrentLimboResolutions,u=new vO(n,r,i,o,s,a),e&&(u.$o=!0),u},t.prototype.terminate=function(){return function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return e=t,ho("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,pZ(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}();function gi(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return tw(this,void 0,void 0,function(){var r;return tI(this,function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]})})},cancel:function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){return[2]})})},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var go=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),gs=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new f8,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return tw(this,void 0,void 0,function(){var t,e,n,r;return tI(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(isNaN(n=Number(e=this.zo.decode(t)))&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new vS(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return 123===t})},t.prototype.Jo=function(){return tw(this,void 0,void 0,function(){var t,e;return tI(this,function(n){switch(n.label){case 0:return 0>this.Zo()?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return tw(this,void 0,void 0,function(){var t,e;return tI(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})},t}(),ga=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return tw(this,void 0,void 0,function(){var e,n=this;return tI(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new hn(he.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o,s,a;return tI(this,function(u){switch(u.label){case 0:return r=fC((n=t).R)+"/documents",i={documents:e.map(function(t){return fI(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e,r,i,o,a,u,c=(e=n.R,"found"in t?(t.found||hc(),t.found.name,t.found.updateTime,r=fT(e,t.found.name),i=f_(t.found.updateTime),o=new hG({mapValue:{fields:t.found.fields}}),hQ.newFoundDocument(r,i,o)):"missing"in t?(t.missing||hc(),t.readTime||hc(),a=fT(e,t.missing),u=f_(t.readTime),hQ.newNoDocument(a,u)):hc());s.set(c.key.toString(),c)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());e||hc(),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new lZ(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return tw(this,void 0,void 0,function(){var t,e=this;return tI(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=hD.fromPath(n);e.mutations.push(new l0(r,e.precondition(r)))}),[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i;return tI(this,function(o){switch(o.label){case 0:return r=fC((n=t).R)+"/documents",i={writes:e.map(function(t){return fR(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw hc();e=hp.min()}var e,n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new hn(he.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?lO.updateTime(e):lO.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(hp.min()))throw new hn(he.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return lO.updateTime(e)}return lO.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),gu=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new pH(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return tw(t,void 0,void 0,function(){var t,e,n=this;return tI(this,function(r){return t=new ga(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!hR(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!l2(e)}return!1},t}(),gc=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=pC.UNAUTHENTICATED,this.clientId=hh.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return tw(r,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:return ho("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new hn(he.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new f8;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return tw(t,void 0,void 0,function(){var t;return tI(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:n.sent(),n.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=vd(n.sent(),"Failed to shutdown persistence"),e.reject(t),[3,6];case 6:return[2]}})})}),e.promise},t}();function gh(t,e){return tw(this,void 0,void 0,function(){var n,r,i=this;return tI(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),ho("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return tw(i,void 0,void 0,function(){return tI(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,pu(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function gl(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,gf(t)];case 1:return n=i.sent(),ho("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){switch(i.label){case 0:return(n=t).asyncQueue.verifyOperationInProgress(),ho("RemoteStore","RemoteStore received new credentials"),r=p5(n),n.Or.add(3),[4,pZ(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,pJ(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function gf(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(ho("FirestoreClient","Using default OfflineComponentProvider"),[4,gh(t,new gt)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function gd(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(ho("FirestoreClient","Using default OnlineComponentProvider"),[4,gl(t,new gr)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function gp(t){return gf(t).then(function(t){return t.persistence})}function gv(t){return gf(t).then(function(t){return t.localStore})}function gg(t){return gd(t).then(function(t){return t.remoteStore})}function gm(t){return gd(t).then(function(t){return t.syncEngine})}function gy(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:return[4,gd(t)];case 1:return[2,((n=(e=r.sent()).eventManager).onListen=vL.bind(null,e.syncEngine),n.onUnlisten=vF.bind(null,e.syncEngine),n)]}})})}function g_(t,e,n){var r=this;void 0===n&&(n={});var i=new f8;return t.asyncQueue.enqueueAndForget(function(){return tw(r,void 0,void 0,function(){var r;return tI(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new go({next:function(o){e.enqueueAndForget(function(){return vb(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new hn(he.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new hn(he.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new vE(lo(n.path),o,{includeMetadataChanges:!0,so:!0});return v_(t,s)},[4,gy(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function gb(t,e,n){var r=this;void 0===n&&(n={});var i=new f8;return t.asyncQueue.enqueueAndForget(function(){return tw(r,void 0,void 0,function(){var r;return tI(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new go({next:function(n){e.enqueueAndForget(function(){return vb(t,s)}),n.fromCache&&"server"===r.source?i.reject(new hn(he.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new vE(n,o,{includeMetadataChanges:!0,so:!0});return v_(t,s)},[4,gy(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var gw=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},gI=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),gT=new Map,gE=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},gS=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(pC.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),gC=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),gk=function(){function t(t){var e=this;this.currentUser=pC.UNAUTHENTICATED,this.oc=new f8,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){ho("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(ho("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(ho("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?("string"==typeof n.accessToken||hc(),new gE(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return tw(n,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return null===t||"string"==typeof t||hc(),new pC(t)},t}(),gN=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=pC.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),gA=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new gN(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(pC.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function gR(t,e,n){if(!n)throw new hn(he.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function gx(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new hn(he.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function gP(t,e,n,r){if(!0===e&&!0===r)throw new hn(he.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function gD(t){if(!hD.isDocumentKey(t))throw new hn(he.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function gO(t){if(hD.isDocumentKey(t))throw new hn(he.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function gL(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":hc()}function gM(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new hn(he.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=gL(t);throw new hn(he.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function gF(t,e){if(e<=0)throw new hn(he.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var gU=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new hn(he.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new hn(he.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,gP("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),gj=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gU({}),this._settingsFrozen=!1,t instanceof gI?(this._databaseId=t,this._credentials=new gS):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new hn(he.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gI(t.options.projectId)}(t),this._credentials=new gk(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new hn(he.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new hn(he.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gU(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new gS;switch(t.type){case"gapi":var e=t.client;return"object"==typeof e&&null!==e&&e.auth&&e.auth.getAuthHeaderValueForFirstParty||hc(),new gA(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new hn(he.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){var t;return(t=gT.get(this))&&(ho("ComponentProvider","Removing Datastore"),gT.delete(this),t.terminate()),Promise.resolve()},t}(),gq=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new gB(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),gV=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),gB=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,lo(r))||this)._path=r,i.type="collection",i}return t_(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new gq(this.firestore,null,new hD(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(gV);function gK(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=eo(t),gR("collection","path",e),t instanceof gj)return gO(n=h_.fromString.apply(h_,tS([e],r))),new gB(t,null,n);if(!(t instanceof gq||t instanceof gB))throw new hn(he.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return gO(n=h_.fromString.apply(h_,tS([t.path],r)).child(h_.fromString(e))),new gB(t.firestore,null,n)}function gW(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=eo(t),1==arguments.length&&(e=hh.u()),gR("doc","path",e),t instanceof gj)return gD(n=h_.fromString.apply(h_,tS([e],r))),new gq(t,null,new hD(n));if(!(t instanceof gq||t instanceof gB))throw new hn(he.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return gD(n=t._path.child(h_.fromString.apply(h_,tS([e],r)))),new gq(t.firestore,t instanceof gB?t.converter:null,new hD(n))}function gH(t,e){return t=eo(t),e=eo(e),(t instanceof gq||t instanceof gB)&&(e instanceof gq||e instanceof gB)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function gz(t,e){return t=eo(t),e=eo(e),t instanceof gV&&e instanceof gV&&t.firestore===e.firestore&&lp(t._query,e._query)&&t.converter===e.converter}var gG=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new pH(this,"async_queue_retry"),this.Tc=function(){var e=pK();e&&ho("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=pK();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=pK();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(t){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return tw(this,void 0,void 0,function(){var t,e=this;return tI(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!dr(t=n.sent()))throw t;return ho("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){var n;throw e.yc=t,e.gc=!1,hs("INTERNAL UNHANDLED ERROR: ",(n=t.message||"",t.stack&&(n=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),n)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=vf.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&hc()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function gQ(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)}var gY=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new f8,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),g$=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new gG,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return t_(e,t),e.prototype._terminate=function(){return this._firestoreClient||gJ(this),this._firestoreClient.terminate()},e}(gj);function gX(t){return t._firestoreClient||gJ(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function gJ(t){var e,n,r,i,o=t._freezeSettings(),s=(e=t._databaseId,n=(null===(i=t._app)||void 0===i?void 0:i.options.appId)||"",r=t._persistenceKey,new gw(e,n,r,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,o.useFetchStreams));t._firestoreClient=new gc(t._credentials,t._queue,s)}function gZ(t,e,n){var r=this,i=new f8;return t.asyncQueue.enqueue(function(){return tw(r,void 0,void 0,function(){var r;return tI(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,gh(t,n)];case 1:return o.sent(),[4,gl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:var s;if(!("FirebaseError"===(s=r=o.sent()).name?s.code===he.FAILED_PRECONDITION||s.code===he.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&s instanceof DOMException)||22===s.code||20===s.code||11===s.code))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function g0(t){if(t._initialized||t._terminated)throw new hn(he.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var g1=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new hn(he.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hw(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),g2=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(hT.fromBase64String(e))}catch(t){throw new hn(he.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},t.fromUint8Array=function(e){return new t(hT.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),g4=function(t){this._methodName=t},g3=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new hn(he.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new hn(he.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return hl(this._lat,t._lat)||hl(this._long,t._long)},t}(),g6=/^__.*__$/,g5=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new lV(t,this.data,this.fieldMask,e,this.fieldTransforms):new lq(t,this.data,e,this.fieldTransforms)},t}(),g8=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new lV(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function g7(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw hc()}}var g9=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return m_(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(g7(this.Cc)&&g6.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),mt=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||pW(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new g9({Cc:t,methodName:e,Bc:n,path:hw.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function me(t){var e=t._freezeSettings(),n=pW(t._databaseId);return new mt(t._databaseId,!!e.ignoreUndefinedProperties,n)}function mn(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);mv("Data must be an object, but it was:",s,r);var a,u,c=md(r,s);if(o.merge)a=new hI(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=mg(e,f[l],n);if(!s.contains(d))throw new hn(he.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");mb(h,d)||h.push(d)}a=new hI(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new g5(new hG(c),a,u)}var mr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw 1===t.Cc?t.Mc(this._methodName+"() can only appear at the top level of your update data"):t.Mc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(g4);function mi(t,e,n){return new g9({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype._toFieldTransform=function(t){return new lP(t.path,new lE)},e.prototype.isEqual=function(t){return t instanceof e},e}(g4),ms=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return t_(e,t),e.prototype._toFieldTransform=function(t){var e=mi(this,t,!0),n=this.Uc.map(function(t){return mf(t,e)}),r=new lS(n);return new lP(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(g4),ma=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return t_(e,t),e.prototype._toFieldTransform=function(t){var e=mi(this,t,!0),n=this.Uc.map(function(t){return mf(t,e)}),r=new lk(n);return new lP(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(g4),mu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return t_(e,t),e.prototype._toFieldTransform=function(t){var e=new lA(t.R,lw(t.R,this.Kc));return new lP(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(g4);function mc(t,e,n,r){var i=t.qc(1,e,n);mv("Data must be an object, but it was:",i,r);var o=[],s=hG.empty();hg(r,function(t,r){var a=my(e,t,n);r=eo(r);var u=i.$c(a);if(r instanceof mr)o.push(a);else{var c=mf(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new hI(o);return new g8(s,a,i.fieldTransforms)}function mh(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[mg(e,r,n)],u=[i];if(o.length%2!=0)throw new hn(he.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(mg(e,o[c])),u.push(o[c+1]);for(var h=[],l=hG.empty(),f=a.length-1;f>=0;--f)if(!mb(h,a[f])){var d=a[f],p=u[f];p=eo(p);var v=s.$c(d);if(p instanceof mr)h.push(d);else{var g=mf(p,v);null!=g&&(h.push(d),l.set(d,g))}}var m=new hI(h);return new g8(l,m,s.fieldTransforms)}function ml(t,e,n,r){return void 0===r&&(r=!1),mf(n,t.qc(r?4:3,e))}function mf(t,e){if(mp(t=eo(t)))return mv("Unsupported field value:",e,t),md(t,e);if(t instanceof g4)return function(t,e){if(!g7(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0;i<t.length;i++){var o=mf(t[i],e.Oc(r));null==o&&(o={nullValue:"NULL_VALUE"}),n.push(o),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=eo(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return lw(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=hd.fromDate(t);return{timestampValue:fm(e.R,n)}}if(t instanceof hd)return n=new hd(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:fm(e.R,n)};if(t instanceof g3)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof g2)return{bytesValue:fy(e.R,t._byteString)};if(t instanceof gq){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:fb(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+gL(t))}(t,e)}function md(t,e){var n={};return hm(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):hg(t,function(t,r){var i=mf(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function mp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof hd||t instanceof g3||t instanceof g2||t instanceof gq||t instanceof g4)}function mv(t,e,n){if(!mp(n)||!("object"==typeof n&&null!==n&&(Object.getPrototypeOf(n)===Object.prototype||null===Object.getPrototypeOf(n)))){var r=gL(n);throw"an object"===r?e.Mc(t+" a custom object"):e.Mc(t+" "+r)}}function mg(t,e,n){if((e=eo(e))instanceof g1)return e._internalPath;if("string"==typeof e)return my(t,e);throw m_("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var mm=RegExp("[~\\*/\\[\\]]");function my(t,e,n){if(e.search(mm)>=0)throw m_("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(g1.bind.apply(g1,tS([void 0],e.split(".")))))._internalPath}catch(r){throw m_("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function m_(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new hn(he.INVALID_ARGUMENT,(a+=". ")+t+u)}function mb(t,e){return t.some(function(t){return t.isEqual(e)})}var mw=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new gq(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new mI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(mT("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),mI=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(mw);function mT(t,e){return"string"==typeof e?my(t,e):e instanceof g1?e._internalPath:e._delegate._internalPath}var mE=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),mS=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return t_(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new mC(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(mT("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(mw),mC=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(mS),mk=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new mE(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new mC(n._firestore,n._userDataWriter,r.key,r,new mE(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new hn(he.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new mC(t._firestore,t._userDataWriter,e.doc.key,e.doc,new mE(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new mC(t._firestore,t._userDataWriter,e.doc.key,e.doc,new mE(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return hc()}}(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function mN(t,e){return t instanceof mS&&e instanceof mS?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof mk&&e instanceof mk&&t._firestore===e._firestore&&gz(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function mA(t){if(la(t)&&0===t.explicitOrderBy.length)throw new hn(he.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var mR=function(){};function mx(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)t=e[r]._apply(t);return t}var mP=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.jc=n,i.Wc=r,i.type="where",i}return t_(e,t),e.prototype._apply=function(t){var e,n,r=me(t.firestore),i=function(t,e,n,r,i,o,s){if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new hn(he.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){mj(s,o);for(var a,u=[],c=0;c<s.length;c++){var h=s[c];u.push(mU(r,t,h))}a={arrayValue:{values:u}}}else a=mU(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||mj(s,o),a=ml(n,"where",s,"in"===o||"not-in"===o);var l=h0.create(i,o,a);return function(t,e){if(e.g()){var n=lc(t);if(null!==n&&!n.isEqual(e.field))throw new hn(he.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=lu(t);null!==r&&mq(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new hn(he.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new hn(he.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,r,t.firestore._databaseId,this.Qc,this.jc,this.Wc);return new gV(t.firestore,t.converter,(n=(e=t._query).filters.concat([i]),new li(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)))},e}(mR),mD=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Gc=n,r.type="orderBy",r}return t_(e,t),e.prototype._apply=function(t){var e,n,r=function(t,e,n){if(null!==t.startAt)throw new hn(he.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new hn(he.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new le(e,n);return function(t,e){if(null===lu(t)){var n=lc(t);null!==n&&mq(t,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Gc);return new gV(t.firestore,t.converter,(n=(e=t._query).explicitOrderBy.concat([r]),new li(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)))},e}(mR),mO=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return t_(e,t),e.prototype._apply=function(t){return new gV(t.firestore,t.converter,ld(t._query,this.zc,this.Hc))},e}(mR),mL=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return t_(e,t),e.prototype._apply=function(t){var e,n=mF(t,this.type,this.Jc,this.Yc);return new gV(t.firestore,t.converter,(e=t._query,new li(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,n,e.endAt)))},e}(mR),mM=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return t_(e,t),e.prototype._apply=function(t){var e,n=mF(t,this.type,this.Jc,this.Yc);return new gV(t.firestore,t.converter,(e=t._query,new li(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,n)))},e}(mR);function mF(t,e,n,r){if(n[0]=eo(n[0]),n[0]instanceof mw)return function(t,e,n,r,i){if(!r)throw new hn(he.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=ll(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(hq(e,r.key));else{var c=r.data.field(u.field);if(hN(c))throw new hn(he.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new hn(he.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new h9(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=me(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new hn(he.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new hn(he.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!lh(t)&&-1!==c.indexOf("/"))throw new hn(he.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(h_.fromString(c));if(!hD.isDocumentKey(h))throw new hn(he.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new hD(h);a.push(hq(e,l))}else{var f=ml(n,r,c);a.push(f)}}return new h9(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function mU(t,e,n){if("string"==typeof(n=eo(n))){if(""===n)throw new hn(he.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!lh(e)&&-1!==n.indexOf("/"))throw new hn(he.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(h_.fromString(n));if(!hD.isDocumentKey(r))throw new hn(he.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return hq(t,new hD(r))}if(n instanceof gq)return hq(t,n._key);throw new hn(he.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+gL(n)+".")}function mj(t,e){if(!Array.isArray(t)||0===t.length)throw new hn(he.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new hn(he.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function mq(t,e,n){if(!n.isEqual(e))throw new hn(he.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var mV=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),hO(t)){case 0:return null;case 1:return t.booleanValue;case 2:return hC(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(hk(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw hc()}},t.prototype.convertObject=function(t,e){var n=this,r={};return hg(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new g3(hC(t.latitude),hC(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=function t(e){var n=e.mapValue.fields.__previous_value__;return hN(n)?t(n):n}(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(hA(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=hS(t);return new hd(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=h_.fromString(t);fj(n)||hc();var r=new gI(n.get(1),n.get(3)),i=new hD(n.popFirst(5));return r.isEqual(e)||hs("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function mB(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var mK=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return t_(e,t),e.prototype.convertBytes=function(t){return new g2(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new gq(this.firestore,null,e)},e}(mV),mW=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=me(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=mH(t,this._firestore),i=mB(r.converter,e,n),o=mn(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,lO.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=mH(t,this._firestore);return o="string"==typeof(e=eo(e))||e instanceof g1?mh(this._dataReader,"WriteBatch.update",s._key,e,n,r):mc(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,lO.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=mH(t,this._firestore);return this._mutations=this._mutations.concat(new lZ(e._key,lO.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new hn(he.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function mH(t,e){if((t=eo(t)).firestore!==e)throw new hn(he.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var mz=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return t_(e,t),e.prototype.convertBytes=function(t){return new g2(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new gq(this.firestore,null,e)},e}(mV);function mG(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=gM(t,gq);var o=gM(t.firestore,g$),s=me(o);return mY(o,[("string"==typeof(e=eo(e))||e instanceof g1?mh(s,"updateDoc",t._key,e,n,r):mc(s,"updateDoc",t._key,e)).toMutation(t._key,lO.exists(!0))])}function mQ(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=eo(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[0]||gQ(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(gQ(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof gq)c=gM(t.firestore,g$),h=lo(t._key.path),u={next:function(e){i[a]&&i[a](m$(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=gM(t,gV);c=gM(d.firestore,g$),h=d._query;var p=new mz(c);u={next:function(t){i[a]&&i[a](new mk(c,p,d,t))},error:i[a+1],complete:i[a+2]},mA(t._query)}return function(t,e,n,r){var i=this,o=new go(r),s=new vE(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return tw(i,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return e=v_,[4,gy(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return tw(i,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return e=vb,[4,gy(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(gX(c),h,l,u)}function mY(t,e){return function(t,e){var n=this,r=new f8;return t.asyncQueue.enqueueAndForget(function(){return tw(n,void 0,void 0,function(){var n;return tI(this,function(i){switch(i.label){case 0:return n=vU,[4,gm(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(gX(t),e)}function m$(t,e,n){var r=n.docs.get(e._key),i=new mz(t);return new mS(t,i,e._key,r,new mE(n.hasPendingWrites,n.fromCache),e.converter)}var mX=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return t_(e,t),e.prototype.get=function(e){var n=this,r=mH(e,this._firestore),i=new mz(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new mS(n._firestore,i,r._key,t._document,new mE(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=me(t)}return t.prototype.get=function(t){var e=this,n=mH(t,this._firestore),r=new mK(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return hc();var i=t[0];if(i.isFoundDocument())return new mw(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new mw(e._firestore,r,n._key,null,n.converter);throw hc()})},t.prototype.set=function(t,e,n){var r=mH(t,this._firestore),i=mB(r.converter,e,n),o=mn(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=mH(t,this._firestore);return o="string"==typeof(e=eo(e))||e instanceof g1?mh(this._dataReader,"Transaction.update",s._key,e,n,r):mc(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=mH(t,this._firestore);return this._transaction.delete(e._key),this},t}());function mJ(){if("undefined"==typeof Uint8Array)throw new hn(he.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function mZ(){if("undefined"==typeof atob)throw new hn(he.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var m0=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return mZ(),new t(g2.fromBase64String(e))},t.fromUint8Array=function(e){return mJ(),new t(g2.fromUint8Array(e))},t.prototype.toBase64=function(){return mZ(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return mJ(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),m1=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){var n,r,i,o,s;return n=t._delegate,r={forceOwnership:e},g0(n=gM(n,g$)),i=gX(n),o=n._freezeSettings(),gZ(i,s=new gr,new ge(s,o.cacheSizeBytes,null==r?void 0:r.forceOwnership))},t.prototype.enableMultiTabIndexedDbPersistence=function(t){var e,n,r,i;return g0(e=gM(e=t._delegate,g$)),n=gX(e),r=e._freezeSettings(),gZ(n,i=new gr,new gn(i,r.cacheSizeBytes))},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new hn(he.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new f8;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return tw(e,void 0,void 0,function(){var e;return tI(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return dt.yt()?(e=t+"main",[4,dt.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}})})}(pn(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),m2=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof gI||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||ha("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=gM(t,gj))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&ha("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=tM(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new hn(he.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new gC(new gE(o,new pC(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return tw(e,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:return[4,gp(t)];case 1:return e=r.sent(),[4,gg(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),n.Or.delete(0),pJ(n))]}})})})}(gX(gM(this._delegate,g$)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return tw(e,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:return[4,gp(t)];case 1:return e=r.sent(),[4,gg(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return(e=t).Or.add(0),[4,pZ(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(gX(gM(this._delegate,g$)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&gP("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new f8;return t.asyncQueue.enqueueAndForget(function(){return tw(e,void 0,void 0,function(){var e;return tI(this,function(r){switch(r.label){case 0:return e=vW,[4,gm(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(gX(gM(this._delegate,g$)))},t.prototype.onSnapshotsInSync=function(t){var e;return function(t,e){var n=this,r=new go(e);return t.asyncQueue.enqueueAndForget(function(){return tw(n,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return e=function(t,e){t.Gr.add(e),e.next()},[4,gy(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return tw(n,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return e=function(t,e){t.Gr.delete(e)},[4,gy(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(gX(gM(this._delegate,g$)),gQ(t)?t:{next:t})},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new hn(he.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new ys(this,gK(this._delegate,t))}catch(t){throw m7(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new m8(this,gW(this._delegate,t))}catch(t){throw m7(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new yr(this,function(t,e){if(t=gM(t,gj),gR("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new hn(he.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new gV(t,null,new li(h_.emptyPath(),e))}(this._delegate,t))}catch(t){throw m7(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e,n=this;return function(t,e){var n=this,r=new f8;return t.asyncQueue.enqueueAndForget(function(){return tw(n,void 0,void 0,function(){var n;return tI(this,function(i){switch(i.label){case 0:return[4,gd(t).then(function(t){return t.datastore})];case 1:return n=i.sent(),new gu(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(gX(e=this._delegate),function(r){var i;return i=new mX(e,r),t(new m3(n,i))})},t.prototype.batch=function(){var t=this;return gX(this._delegate),new m6(new mW(this._delegate,function(e){return mY(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new hn(he.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new hn(he.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),m4=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return t_(e,t),e.prototype.convertBytes=function(t){return new m0(new g2(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return m8.tu(e,this.firestore,null)},e}(mV),m3=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new m4(t)}return t.prototype.get=function(t){var e=this,n=gM(t,gq);return this._delegate.get(n).then(function(t){return new ye(e._firestore,new mS(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=gM(t,gq);return n?(gx("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=gM(t,gq);return 2==arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,tS([s,e,n],i)),this},t.prototype.delete=function(t){var e=gM(t,gq);return this._delegate.delete(e),this},t}(),m6=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=gM(t,gq);return n?(gx("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=gM(t,gq);return 2==arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,tS([s,e,n],i)),this},t.prototype.delete=function(t){var e=gM(t,gq);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),m5=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new mC(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new yn(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new m4(e),n),i.set(n,o)),o},t}();m5.nu=new WeakMap;var m8=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new m4(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new hn(he.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new gq(n._delegate,r,new hD(e)))},t.tu=function(e,n,r){return new t(n,new gq(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ys(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new ys(this.firestore,gK(this._delegate,t))}catch(t){throw m7(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=eo(t))instanceof gq&&gH(this._delegate,t)},t.prototype.set=function(t,e){e=gx("DocumentReference.set",e);try{var n,r,i,o;return n=this._delegate,r=e,n=gM(n,gq),i=gM(n.firestore,g$),o=mB(n.converter,t,r),mY(i,[mn(me(i),"setDoc",n._key,o,null!==n.converter,r).toMutation(n._key,lO.none())])}catch(t){throw m7(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1==arguments.length?mG(this._delegate,t):mG.apply(void 0,tS([this._delegate,t,e],n))}catch(t){throw m7(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){var t;return mY(gM((t=this._delegate).firestore,g$),[new lZ(t._key,lO.none())])},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=m9(e),i=yt(e,function(e){return new ye(t.firestore,new mS(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return mQ(this._delegate,r,i)},t.prototype.get=function(t){var e,n,r,i,o,s,a,u,c=this;return("cache"===(null==t?void 0:t.source)?(e=gM(e=this._delegate,gq),r=gX(n=gM(e.firestore,g$)),i=new mz(n),(function(t,e){var n=this,r=new f8;return t.asyncQueue.enqueueAndForget(function(){return tw(n,void 0,void 0,function(){var n;return tI(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return tw(this,void 0,void 0,function(){var r;return tI(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t.persistence.runTransaction("read document","readonly",function(n){return t.Mn.mn(n,e)})];case 1:return(r=i.sent()).isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new hn(he.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=vd(i.sent(),"Failed to get document '"+e+" from cache"),n.reject(r),[3,3];case 3:return[2]}})})},[4,gv(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise})(r,e._key).then(function(t){return new mS(n,i,e._key,t,new mE(null!==t&&t.hasLocalMutations,!0),e.converter)})):"server"===(null==t?void 0:t.source)?(o=gM(o=this._delegate,gq),g_(gX(s=gM(o.firestore,g$)),o._key,{source:"server"}).then(function(t){return m$(s,o,t)})):(a=gM(a=this._delegate,gq),g_(gX(u=gM(a.firestore,g$)),a._key).then(function(t){return m$(u,a,t)}))).then(function(t){return new ye(c.firestore,new mS(c.firestore._delegate,c._userDataWriter,t._key,t._document,t.metadata,c._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(m5.eu(this.firestore,e)):this._delegate.withConverter(null))},t}();function m7(t,e,n){return t.message=t.message.replace(e,n),t}function m9(t){for(var e=0;e<t.length;e++){var n=t[e];if("object"==typeof n&&!gQ(n))return n}return{}}function yt(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=gQ(t[0])?t[0]:gQ(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var ye=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new m8(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return mN(this._delegate,t._delegate)},t}(),yn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t_(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(ye),yr=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new m4(t)}return t.prototype.where=function(e,n,r){try{var i;return new t(this.firestore,mx(this._delegate,(i=mT("where",e),new mP(i,n,r))))}catch(t){throw m7(t,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{var r,i,o;return new t(this.firestore,mx(this._delegate,(r=n,void 0===r&&(r="asc"),i=r,o=mT("orderBy",e),new mD(o,i))))}catch(t){throw m7(t,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,mx(this._delegate,(gF("limit",e),new mO("limit",e,"F"))))}catch(t){throw m7(t,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,mx(this._delegate,(gF("limitToLast",e),new mO("limitToLast",e,"L"))))}catch(t){throw m7(t,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,mx(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mL("startAt",t,!0)}).apply(void 0,e)))}catch(t){throw m7(t,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,mx(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mL("startAfter",t,!1)}).apply(void 0,e)))}catch(t){throw m7(t,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,mx(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mM("endBefore",t,!0)}).apply(void 0,e)))}catch(t){throw m7(t,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,mx(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mM("endAt",t,!1)}).apply(void 0,e)))}catch(t){throw m7(t,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return gz(this._delegate,t._delegate)},t.prototype.get=function(t){var e,n,r,i,o,s,a,u,c,h,l,f,d=this;return("cache"===(null==t?void 0:t.source)?(e=gM(e=this._delegate,gV),r=gX(n=gM(e.firestore,g$)),i=new mz(n),(function(t,e){var n=this,r=new f8;return t.asyncQueue.enqueueAndForget(function(){return tw(n,void 0,void 0,function(){var n;return tI(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o,s;return tI(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,pd(t,e,!0)];case 1:return s=a.sent(),i=(r=new vx(e,s.Bn))._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=vd(a.sent(),"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}})})},[4,gv(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise})(r,e._query).then(function(t){return new mk(n,i,e,t)})):"server"===(null==t?void 0:t.source)?(o=gM(o=this._delegate,gV),a=gX(s=gM(o.firestore,g$)),u=new mz(s),gb(a,o._query,{source:"server"}).then(function(t){return new mk(s,u,o,t)})):(c=gM(c=this._delegate,gV),l=gX(h=gM(c.firestore,g$)),f=new mz(h),mA(c._query),gb(l,c._query).then(function(t){return new mk(h,f,c,t)}))).then(function(t){return new yo(d.firestore,new mk(d.firestore._delegate,d._userDataWriter,d._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=m9(e),i=yt(e,function(e){return new yo(t.firestore,new mk(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return mQ(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(m5.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(),yi=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new yn(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),yo=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new yr(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new yn(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new yi(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new yn(n._firestore,r))})},t.prototype.isEqual=function(t){return mN(this._delegate,t._delegate)},t}(),ys=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return t_(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new m8(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new m8(this.firestore,void 0===t?gW(this._delegate):gW(this._delegate,t))}catch(t){throw m7(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e,n,r,i,o=this;return(n=gM((e=this._delegate).firestore,g$),r=gW(e),i=mB(e.converter,t),mY(n,[mn(me(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,lO.exists(!1))]).then(function(){return r})).then(function(t){return new m8(o.firestore,t)})},e.prototype.isEqual=function(t){return gH(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(m5.eu(this.firestore,t)):this._delegate.withConverter(null))},e}(yr);function ya(t){var e,n,r;return n=gX(e=gM(e=this._delegate,g$)),r=new gY,function(t,e,n,r){var i,o,s=this,a=(i=pW(e),o=function(t,e){if(t instanceof Uint8Array)return gi(t,e);if(t instanceof ArrayBuffer)return gi(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof n?(new TextEncoder).encode(n):n),new gs(o,i));t.asyncQueue.enqueueAndForget(function(){return tw(s,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return e=v9,[4,gm(t)];case 1:return e.apply(void 0,[n.sent(),a,r]),[2]}})})})}(n,e._databaseId,t,r),r}function yu(t){var e,n=this;return(function(t,e){var n=this;return t.asyncQueue.enqueue(function(){return tw(n,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:return n=function(t,e){return t.persistence.runTransaction("Get named query","readonly",function(n){return t.Ke.getNamedQuery(n,e)})},[4,gv(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}})})})})(gX(e=gM(e=this._delegate,g$)),t).then(function(t){return t?new gV(e,null,t.query):null}).then(function(t){return t?new yr(n,t):null})}var yc={Firestore:m2,GeoPoint:g3,Timestamp:hd,Blob:m0,Transaction:m3,WriteBatch:m6,DocumentReference:m8,DocumentSnapshot:ye,Query:yr,QueryDocumentSnapshot:yn,QuerySnapshot:yo,CollectionReference:ys,FieldPath:function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(g1.bind.apply(g1,tS([void 0],t)))}return t.documentId=function(){return new t(hw.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=eo(t))instanceof g1&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),FieldValue:function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new mo("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new mr("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ms("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ma("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=new mu("increment",e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),setLogLevel:function(t){hr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!function(t){(function(t,e){t.INTERNAL.registerComponent(new es("firestore",function(t){return e(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},yc)))})(t,function(t,e){return new m2(t,new g$(t,e),new m1)}),t.registerVersion("@firebase/firestore","2.3.8")}(eR),function(t){t.prototype.loadBundle=ya,t.prototype.namedQuery=yu}(m2);var yh={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},yl=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return t_(e,t),e}(Error),yf=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then(function(t){return n.auth=t},function(){}),this.messaging||e.get().then(function(t){return n.messaging=t},function(){})}return t.prototype.getAuthToken=function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:if(!(t=e.sent()))return[2,void 0];return[2,t.accessToken];case 3:return e.sent(),[2,void 0];case 4:return[2]}})})},t.prototype.getInstanceIdToken=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}})})},t.prototype.getContext=function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){switch(e.label){case 0:return[4,this.getAuthToken()];case 1:return t=e.sent(),[4,this.getInstanceIdToken()];case 2:return[2,{authToken:t,instanceIdToken:e.sent()}]}})})},t}();function yd(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var yp=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t)||!0===t||!1===t||"[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(function(t){return e.encode(t)});if("function"==typeof t||"object"==typeof t)return yd(t,function(t){return e.encode(t)});throw Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw Error("Data cannot be decoded from JSON: "+t);return n;default:throw Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return e.decode(t)}):"function"==typeof t||"object"==typeof t?yd(t,function(t){return e.decode(t)}):t},t}(),yv=function(){function t(t,e,n,r,i,o){var s=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new yp,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(s.deleteService())}},this.contextProvider=new yf(e,n),this.cancelAllRequests=new Promise(function(t){s.deleteService=function(){return t()}});try{var a=new URL(i);this.customDomain=a.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o;return tI(this,function(s){switch(s.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=s.sent())&&(n["X-Firebase-AppCheck"]=r),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=s.sent(),[3,5];case 4:return s.sent(),[2,{status:0,json:null}];case 5:o=null,s.label=6;case 6:return s.trys.push([6,8,,9]),[4,i.json()];case 7:return o=s.sent(),[3,9];case 8:return s.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}})})},t.prototype.getAppCheckToken=function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){switch(e.label){case 0:if(!(t=this.appCheckProvider.getImmediate({optional:!0})))return[3,2];return[4,t.getToken()];case 1:return[2,e.sent().token];case 2:return[2,null]}})})},t.prototype.call=function(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l,f;return tI(this,function(d){switch(d.label){case 0:return r=this._url(t),i={data:e=this.serializer.encode(e)},o={},[4,this.contextProvider.getContext()];case 1:var p,v,g;return(s=d.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),p=n.timeout||7e4,g=new Promise(function(t,e){v=setTimeout(function(){e(new yl("deadline-exceeded","deadline-exceeded"))},p)}),u=(a={timer:v,promise:g}).timer,c=a.promise,[4,Promise.race([yg(u,this.postJSON(r,i,o)),c,yg(u,this.cancelAllRequests)])];case 2:if(!(h=d.sent()))throw new yl("cancelled","Firebase Functions instance was deleted.");if(l=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!yh[a])return new yl("internal","internal");r=yh[a],i=a}var u=s.message;"string"==typeof u&&(i=u),o=s.details,void 0!==o&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new yl(r,i,o)}(h.status,h.json,this.serializer))throw l;if(!h.json)throw new yl("internal","Response is not valid JSON object.");if(void 0===(f=h.json.data)&&(f=h.json.result),void 0===f)throw new yl("internal","Response is missing data field.");return[2,{data:this.serializer.decode(f)}]}})})},t}();function yg(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}})})}!function(t,e){t.INTERNAL.registerComponent(new es("functions",function(t,n){var r=n.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new yv(i,o,a,s,r,e)},"PUBLIC").setServiceProps({Functions:yv}).setMultipleInstances(!0))}(eR,fetch.bind(self)),eR.registerVersion("@firebase/functions","0.6.13");var ym={};!function(t){"use strict";function e(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function n(t,n,r){var i,o=new Promise(function(o,s){e(i=t[n].apply(t,r)).then(o,s)});return o.request=i,o}function r(t,e,n){n.forEach(function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})})}function i(t,e,r,i){i.forEach(function(i){i in r.prototype&&(t.prototype[i]=function(){return n(this[e],i,arguments)})})}function o(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})})}function s(t,e,r,i){i.forEach(function(i){i in r.prototype&&(t.prototype[i]=function(){var t,r,o;return t=this[e],r=arguments,(o=n(t,i,r)).then(function(t){if(t)return new u(t,o.request)})})})}function a(t){this._index=t}function u(t,e){this._cursor=t,this._request=e}function c(t){this._store=t}function h(t){this._tx=t,this.complete=new Promise(function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}})}function l(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new h(n)}function f(t){this._db=t}r(a,"_index",["name","keyPath","multiEntry","unique"]),i(a,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),s(a,"_index",IDBIndex,["openCursor","openKeyCursor"]),r(u,"_cursor",["direction","key","primaryKey","value"]),i(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(u.prototype[t]=function(){var n=this,r=arguments;return Promise.resolve().then(function(){return n._cursor[t].apply(n._cursor,r),e(n._request).then(function(t){if(t)return new u(t,n._request)})})})}),c.prototype.createIndex=function(){return new a(this._store.createIndex.apply(this._store,arguments))},c.prototype.index=function(){return new a(this._store.index.apply(this._store,arguments))},r(c,"_store",["name","keyPath","indexNames","autoIncrement"]),i(c,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),s(c,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(c,"_store",IDBObjectStore,["deleteIndex"]),h.prototype.objectStore=function(){return new c(this._tx.objectStore.apply(this._tx,arguments))},r(h,"_tx",["objectStoreNames","mode"]),o(h,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new c(this._db.createObjectStore.apply(this._db,arguments))},r(l,"_db",["name","version","objectStoreNames"]),o(l,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new h(this._db.transaction.apply(this._db,arguments))},r(f,"_db",["name","version","objectStoreNames"]),o(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[c,a].forEach(function(e){t in e.prototype&&(e.prototype[t.replace("open","iterate")]=function(){var e,n=(e=arguments,Array.prototype.slice.call(e)),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})})}),[a,c].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise(function(i){n.iterateCursor(t,function(t){if(!t||(r.push(t.value),void 0!==e&&r.length==e)){i(r);return}t.continue()})})})}),t.openDb=function(t,e,r){var i=n(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){r&&r(new l(o.result,t.oldVersion,o.transaction))}),i.then(function(t){return new f(t)})},t.deleteDb=function(t){return n(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(ym);var yy="0.4.30",y_="w:"+yy,yb="FIS_v2",yw=((e={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',e["not-registered"]="Firebase Installation is not registered.",e["installation-not-found"]="Firebase Installation not found.",e["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',e["app-offline"]="Could not process request. Application offline.",e["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",e),yI=new tz("installations","Installations",yw);function yT(t){return t instanceof tH&&t.code.includes("request-failed")}function yE(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function yS(t){return{token:t.token,requestStatus:2,expiresIn:Number(t.expiresIn.replace("s","000")),creationTime:Date.now()}}function yC(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:return[4,e.json()];case 1:return n=r.sent().error,[2,yI.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})]}})})}function yk(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function yN(t,e){var n=e.refreshToken,r=yk(t);return r.append("Authorization",yb+" "+n),r}function yA(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return[4,t()];case 1:if((e=n.sent()).status>=500&&e.status<600)return[2,t()];return[2,e]}})})}function yR(t){return new Promise(function(e){setTimeout(e,t)})}var yx=/^[cdef][\w-]{21}$/;function yP(t){return t.appName+"!"+t.appId}var yD=new Map;function yO(t,e){var n,r=yP(t);yL(r,e),(n=yF())&&n.postMessage({key:r,fid:e}),yU()}function yL(t,e){var n,r,i=yD.get(t);if(i)try{for(var o=tT(i),s=o.next();!s.done;s=o.next())(0,s.value)(e)}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var yM=null;function yF(){return!yM&&"BroadcastChannel"in self&&((yM=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){yL(t.data.key,t.data.fid)}),yM}function yU(){0===yD.size&&yM&&(yM.close(),yM=null)}var yj="firebase-installations-store",yq=null;function yV(){return yq||(yq=(0,ym.openDb)("firebase-installations-database",1,function(t){0===t.oldVersion&&t.createObjectStore(yj)})),yq}function yB(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o;return tI(this,function(s){switch(s.label){case 0:return n=yP(t),[4,yV()];case 1:return[4,(i=(r=s.sent().transaction(yj,"readwrite")).objectStore(yj)).get(n)];case 2:return o=s.sent(),[4,i.put(e,n)];case 3:return s.sent(),[4,r.complete];case 4:return s.sent(),o&&o.fid===e.fid||yO(t,e.fid),[2,e]}})})}function yK(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:return e=yP(t),[4,yV()];case 1:return[4,(n=r.sent().transaction(yj,"readwrite")).objectStore(yj).delete(e)];case 2:return r.sent(),[4,n.complete];case 3:return r.sent(),[2]}})})}function yW(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o,s;return tI(this,function(a){switch(a.label){case 0:return n=yP(t),[4,yV()];case 1:return[4,(i=(r=a.sent().transaction(yj,"readwrite")).objectStore(yj)).get(n)];case 2:if(void 0!==(s=e(o=a.sent())))return[3,4];return[4,i.delete(n)];case 3:return a.sent(),[3,6];case 4:return[4,i.put(s,n)];case 5:a.sent(),a.label=6;case 6:return[4,r.complete];case 7:return a.sent(),s&&(!o||o.fid!==s.fid)&&yO(t,s.fid),[2,s]}})})}function yH(t){return tw(this,void 0,void 0,function(){var e,n,r;return tI(this,function(i){switch(i.label){case 0:return[4,yW(t,function(n){var r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(yI.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=function(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,7]),[4,function(t,e){var n=e.fid;return tw(this,void 0,void 0,function(){var e,r,i,o;return tI(this,function(s){switch(s.label){case 0:return e=yE(t),r={method:"POST",headers:yk(t),body:JSON.stringify({fid:n,authVersion:yb,appId:t.appId,sdkVersion:y_})},[4,yA(function(){return fetch(e,r)})];case 1:if(!(i=s.sent()).ok)return[3,3];return[4,i.json()];case 2:return[2,{fid:(o=s.sent()).fid||n,registrationStatus:2,refreshToken:o.refreshToken,authToken:yS(o.authToken)}];case 3:return[4,yC("Create Installation",i)];case 4:throw s.sent()}})})}(t,e)];case 1:return[2,yB(t,r.sent())];case 2:if(!(yT(n=r.sent())&&409===n.customData.serverCode))return[3,4];return[4,yK(t)];case 3:return r.sent(),[3,6];case 4:return[4,yB(t,{fid:e.fid,registrationStatus:0})];case 5:r.sent(),r.label=6;case 6:throw n;case 7:return[2]}})})}(t,n);return{installationEntry:n,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:function(t){return tw(this,void 0,void 0,function(){var e,n,r,i;return tI(this,function(o){switch(o.label){case 0:return[4,yz(t)];case 1:e=o.sent(),o.label=2;case 2:if(1!==e.registrationStatus)return[3,5];return[4,yR(100)];case 3:return o.sent(),[4,yz(t)];case 4:return e=o.sent(),[3,2];case 5:if(0!==e.registrationStatus)return[3,7];return[4,yH(t)];case 6:if(r=(n=o.sent()).installationEntry,i=n.registrationPromise)return[2,i];return[2,r];case 7:return[2,e]}})})}(t)}:{installationEntry:e}}(t,yG(n||{fid:function(){try{var t,e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var n=(t=e,btoa(String.fromCharCode.apply(String,tS([],tE(t)))).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22));return yx.test(n)?n:""}catch(t){return""}}(),registrationStatus:0}));return e=r.registrationPromise,r.installationEntry})];case 1:if(""!==(n=i.sent()).fid)return[3,3];return r={},[4,e];case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}})})}function yz(t){return yW(t,function(t){if(!t)throw yI.create("installation-not-found");return yG(t)})}function yG(t){return 1===t.registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t}function yQ(t,e){return void 0===e&&(e=!1),tw(this,void 0,void 0,function(){var n,r,i;return tI(this,function(o){switch(o.label){case 0:return[4,yW(t.appConfig,function(r){if(!y$(r))throw yI.create("not-registered");var i,o,s,a,u=r.authToken;if(!e&&2===(i=u).requestStatus&&(o=i,!((s=Date.now())<o.creationTime)&&!(o.creationTime+o.expiresIn<s+36e5)))return r;if(1===u.requestStatus)return n=function(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){switch(i.label){case 0:return[4,yY(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:if(1!==n.authToken.requestStatus)return[3,5];return[4,yR(100)];case 3:return i.sent(),[4,yY(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:if(0===(r=n.authToken).requestStatus)return[2,yQ(t,e)];return[2,r]}})})}(t,e),r;if(!navigator.onLine)throw yI.create("app-offline");var c=(a={requestStatus:1,requestTime:Date.now()},tb(tb({},r),{authToken:a}));return n=function(t,e){return tw(this,void 0,void 0,function(){var n,r,i;return tI(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,function(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return tw(this,void 0,void 0,function(){var t,i,o,s,a;return tI(this,function(u){switch(u.label){case 0:var c;return c=e.fid,t=yE(n)+"/"+c+"/authTokens:generate",i=yN(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),s={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:y_}})},[4,yA(function(){return fetch(t,s)})];case 1:if(!(a=u.sent()).ok)return[3,3];return[4,a.json()];case 2:return[2,yS(u.sent())];case 3:return[4,yC("Generate Auth Token",a)];case 4:throw u.sent()}})})}(t,e)];case 1:return n=o.sent(),r=tb(tb({},e),{authToken:n}),[4,yB(t.appConfig,r)];case 2:return o.sent(),[2,n];case 3:if(!(yT(i=o.sent())&&(401===i.customData.serverCode||404===i.customData.serverCode)))return[3,5];return[4,yK(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return r=tb(tb({},e),{authToken:{requestStatus:0}}),[4,yB(t.appConfig,r)];case 6:o.sent(),o.label=7;case 7:throw i;case 8:return[2]}})})}(t,c),c})];case 1:if(r=o.sent(),!n)return[3,3];return[4,n];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}})})}function yY(t){return yW(t,function(t){var e;if(!y$(t))throw yI.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?tb(tb({},t),{authToken:{requestStatus:0}}):t})}function y$(t){return void 0!==t&&2===t.registrationStatus}function yX(t){return yI.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new es("installations",function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){if(!t||!t.options)throw yX("App Configuration");if(!t.name)throw yX("App Name");try{for(var e,n,r=tT(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw yX(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return tw(this,void 0,void 0,function(){var e,n,r;return tI(this,function(i){switch(i.label){case 0:return[4,yH(t.appConfig)];case 1:return n=(e=i.sent()).installationEntry,(r=e.registrationPromise)?r.catch(console.error):yQ(t).catch(console.error),[2,n.fid]}})})}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),tw(this,void 0,void 0,function(){return tI(this,function(n){switch(n.label){case 0:return[4,function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return[4,yH(t)];case 1:if(!(e=n.sent().registrationPromise))return[3,3];return[4,e];case 2:n.sent(),n.label=3;case 3:return[2]}})})}(t.appConfig)];case 1:return n.sent(),[4,yQ(t,e)];case 2:return[2,n.sent().token]}})})}(n,t)},delete:function(){return function(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:return[4,yW(e=t.appConfig,function(t){if(!t||0!==t.registrationStatus)return t})];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw yI.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw yI.create("app-offline");case 3:return[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i;return tI(this,function(o){switch(o.label){case 0:var s;return s=e.fid,n=yE(t)+"/"+s,r={method:"DELETE",headers:yN(t,e)},[4,yA(function(){return fetch(n,r)})];case 1:if((i=o.sent()).ok)return[3,3];return[4,yC("Delete Installation",i)];case 2:throw o.sent();case 3:return[2]}})})}(e,n)];case 4:return r.sent(),[4,yK(e)];case 5:r.sent(),r.label=6;case 6:return[2]}})})}(n)},onIdChange:function(t){var e,r,i;return e=n.appConfig,yF(),r=yP(e),(i=yD.get(r))||(i=new Set,yD.set(r,i)),i.add(t),function(){var n,r;n=yP(e),(r=yD.get(n))&&(r.delete(t),0===r.size&&yD.delete(n),yU())}}}},"PUBLIC")),t.registerVersion("@firebase/installations",yy)}(eR);var yJ=((n={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',n["only-available-in-window"]="This method is available in a Window context.",n["only-available-in-sw"]="This method is available in a service worker context.",n["permission-default"]="The notification permission was not granted and dismissed instead.",n["permission-blocked"]="The notification permission was not granted and blocked instead.",n["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",n["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",n["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",n["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",n["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",n["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",n["token-update-no-token"]="FCM returned no token when updating the user to push.",n["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",n["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",n["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",n["invalid-vapid-key"]="The public VAPID key must be a string.",n["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",n),yZ=new tz("messaging","Messaging",yJ),y0="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",y1="FCM_MSG",y2="google.c.a.c_id";function y4(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,tS([],tE(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(r||(r={}));var y3="fcm_token_details_db",y6="fcm_token_object_Store",y5="firebase-messaging-store",y8=null;function y7(){return y8||(y8=(0,ym.openDb)("firebase-messaging-database",1,function(t){0===t.oldVersion&&t.createObjectStore(y5)})),y8}function y9(t){return tw(this,void 0,void 0,function(){var e,n,r;return tI(this,function(i){switch(i.label){case 0:return e=_e(t),[4,y7()];case 1:return[4,i.sent().transaction(y5).objectStore(y5).get(e)];case 2:if(!(n=i.sent()))return[3,3];return[2,n];case 3:return[4,function(t){return tw(this,void 0,void 0,function(){var e,n=this;return tI(this,function(r){switch(r.label){case 0:if(!("databases"in indexedDB))return[3,2];return[4,indexedDB.databases()];case 1:if(!r.sent().map(function(t){return t.name}).includes(y3))return[2,null];r.label=2;case 2:return e=null,[4,(0,ym.openDb)(y3,5,function(r){return tw(n,void 0,void 0,function(){var n,i,o,s;return tI(this,function(a){switch(a.label){case 0:if(r.oldVersion<2||!r.objectStoreNames.contains(y6))return[2];return[4,(n=r.transaction.objectStore(y6)).index("fcmSenderId").get(t)];case 1:return i=a.sent(),[4,n.clear()];case 2:if(a.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(s=o.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:y4(o.vapidKey)}}}else 3===r.oldVersion?e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:y4(o.auth),p256dh:y4(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:y4(o.vapidKey)}}:4===r.oldVersion&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:y4(o.auth),p256dh:y4(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:y4(o.vapidKey)}});return[2]}})})})];case 3:return r.sent().close(),[4,(0,ym.deleteDb)(y3)];case 4:return r.sent(),[4,(0,ym.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,(0,ym.deleteDb)("undefined")];case 6:return r.sent(),[2,!function(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?null:e]}})})}(t.appConfig.senderId)];case 4:if(!(r=i.sent()))return[3,6];return[4,_t(t,r)];case 5:return i.sent(),[2,r];case 6:return[2]}})})}function _t(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){switch(i.label){case 0:return n=_e(t),[4,y7()];case 1:return[4,(r=i.sent().transaction(y5,"readwrite")).objectStore(y5).put(e,n)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2,e]}})})}function _e(t){return t.appConfig.appId}function _n(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o;return tI(this,function(s){switch(s.label){case 0:return[4,_i(t)];case 1:n={method:"DELETE",headers:s.sent()},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(_r(t.appConfig)+"/"+e,n)];case 3:return[4,s.sent().json()];case 4:if((r=s.sent()).error)throw i=r.error.message,yZ.create("token-unsubscribe-failed",{errorInfo:i});return[3,6];case 5:throw o=s.sent(),yZ.create("token-unsubscribe-failed",{errorInfo:o});case 6:return[2]}})})}function _r(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function _i(t){var e=t.appConfig,n=t.installations;return tw(this,void 0,void 0,function(){var t;return tI(this,function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}})})}function _o(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==y0&&(o.web.applicationPubKey=i),o}function _s(t,e,n){return tw(this,void 0,void 0,function(){var r,i,o;return tI(this,function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw yZ.create("permission-blocked");return[4,function(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:if(n=r.sent())return[2,n];return[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(t){for(var e="=".repeat((4-t.length%4)%4),n=atob((t+e).replace(/\-/g,"+").replace(/_/g,"/")),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}(e)})]}})})}(e,n)];case 1:return r=s.sent(),[4,y9(t)];case 2:if(i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:y4(r.getKey("auth")),p256dh:y4(r.getKey("p256dh"))},i)return[3,3];return[2,_u(t,o)];case 3:var a,u,c,h,l,f;if(a=i.subscriptionOptions,c=(u=o).vapidKey===a.vapidKey,h=u.endpoint===a.endpoint,l=u.auth===a.auth,f=u.p256dh===a.p256dh,c&&h&&l&&f)return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,_n(t,i.token)];case 5:return s.sent(),[3,7];case 6:return console.warn(s.sent()),[3,7];case 7:return[2,_u(t,o)];case 8:if(Date.now()>=i.createTime+6048e5)return[2,function(t,e,n){return tw(this,void 0,void 0,function(){var r,i;return tI(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,5]),[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o;return tI(this,function(s){switch(s.label){case 0:return[4,_i(t)];case 1:n={method:"PATCH",headers:s.sent(),body:JSON.stringify(_o(e.subscriptionOptions))},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(_r(t.appConfig)+"/"+e.token,n)];case 3:return[4,s.sent().json()];case 4:return r=s.sent(),[3,6];case 5:throw i=s.sent(),yZ.create("token-update-failed",{errorInfo:i});case 6:if(r.error)throw o=r.error.message,yZ.create("token-update-failed",{errorInfo:o});if(!r.token)throw yZ.create("token-update-no-token");return[2,r.token]}})})}(e,t)];case 1:return r=o.sent(),[4,_t(e,tb(tb({},t),{token:r,createTime:Date.now()}))];case 2:return o.sent(),[2,r];case 3:return i=o.sent(),[4,_a(e,n)];case 4:throw o.sent(),i;case 5:return[2]}})})}({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)];return[2,i.token];case 9:return[2]}})})}function _a(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){switch(i.label){case 0:return[4,y9(t)];case 1:if(!(n=i.sent()))return[3,4];return[4,_n(t,n.token)];case 2:return i.sent(),[4,function(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:return e=_e(t),[4,y7()];case 1:return[4,(n=r.sent().transaction(y5,"readwrite")).objectStore(y5).delete(e)];case 2:return r.sent(),[4,n.complete];case 3:return r.sent(),[2]}})})}(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:if(r=i.sent())return[2,r.unsubscribe()];return[2,!0]}})})}function _u(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:return[4,function(t,e){return tw(this,void 0,void 0,function(){var n,r,i,o;return tI(this,function(s){switch(s.label){case 0:return[4,_i(t)];case 1:n={method:"POST",headers:s.sent(),body:JSON.stringify(_o(e))},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(_r(t.appConfig),n)];case 3:return[4,s.sent().json()];case 4:return r=s.sent(),[3,6];case 5:throw i=s.sent(),yZ.create("token-subscribe-failed",{errorInfo:i});case 6:if(r.error)throw o=r.error.message,yZ.create("token-subscribe-failed",{errorInfo:o});if(!r.token)throw yZ.create("token-subscribe-no-token");return[2,r.token]}})})}(t,e)];case 1:return[4,_t(t,n={token:r.sent(),createTime:Date.now(),subscriptionOptions:e})];case 2:return r.sent(),[2,n.token]}})})}function _c(t){return"object"==typeof t&&!!t&&y2 in t}function _h(t){return new Promise(function(e){setTimeout(e,t)})}var _l=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",function(t){t.waitUntil(e.onPush(t))}),self.addEventListener("pushsubscriptionchange",function(t){t.waitUntil(e.onSubChange(t))}),self.addEventListener("notificationclick",function(t){t.waitUntil(e.onNotificationClick(t))})}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw yZ.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:if(this.vapidKey)return[3,2];return[4,y9(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:y0,r.label=2;case 2:return[2,_s(this.firebaseDependencies,self.registration,this.vapidKey)]}})})},t.prototype.deleteToken=function(){return _a(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw yZ.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw yZ.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw yZ.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw yZ.create("only-available-in-window")},t.prototype.onMessage=function(){throw yZ.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw yZ.create("only-available-in-window")},t.prototype.onPush=function(t){return tw(this,void 0,void 0,function(){var e,n,i,o;return tI(this,function(s){var a,u,c,h,l,f,d,p,v;switch(s.label){case 0:if(!(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t)))return console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2];return[4,_f()];case 1:if((n=s.sent()).some(function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))return[2,function(t,e){var n,i;e.isFirebaseMessaging=!0,e.messageType=r.PUSH_RECEIVED;try{for(var o=tT(t),s=o.next();!s.done;s=o.next())s.value.postMessage(e)}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}(n,e)];if(i=!1,!e.notification)return[3,3];return[4,(f=((c=tb({},(a=e).notification)).data=((u={})[y1]=a,u),h=c).actions,d=Notification.maxActions,f&&d&&f.length>d&&console.warn("This browser only supports "+d+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(l=h.title)&&void 0!==l?l:"",h))];case 2:s.sent(),i=!0,s.label=3;case 3:if(!0===i&&!1===this.isOnBackgroundMessageUsed)return[2];return this.bgMessageHandler&&(function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(v={from:(p=e).from,collapseKey:p.collapse_key},p),p.data&&(v.data=p.data),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(v,p),o=v,"function"==typeof this.bgMessageHandler?this.bgMessageHandler(o):this.bgMessageHandler.next(o)),[4,_h(1e3)];case 4:return s.sent(),[2]}})})},t.prototype.onSubChange=function(t){var e,n;return tw(this,void 0,void 0,function(){var r;return tI(this,function(i){switch(i.label){case 0:if(t.newSubscription)return[3,2];return[4,_a(this.firebaseDependencies,self.registration)];case 1:case 5:return i.sent(),[2];case 2:return[4,y9(this.firebaseDependencies)];case 3:return r=i.sent(),[4,_a(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,_s(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:y0)]}})})},t.prototype.onNotificationClick=function(t){var e,n;return tw(this,void 0,void 0,function(){var i,o,s,a,u;return tI(this,function(c){switch(c.label){case 0:var h,l,f,d;if(!(i=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n[y1])||t.action||(t.stopImmediatePropagation(),t.notification.close(),!(o=(null!==(f=null===(l=(h=i).fcmOptions)||void 0===l?void 0:l.link)&&void 0!==f?f:null===(d=h.notification)||void 0===d?void 0:d.click_action)||(_c(h.data)?self.location.origin:null))||(s=new URL(o,self.location.href),a=new URL(self.location.origin),s.host!==a.host)))return[2];return[4,function(t){return tw(this,void 0,void 0,function(){var e,n,r,i,o,s,a;return tI(this,function(u){switch(u.label){case 0:return[4,_f()];case 1:e=u.sent();try{for(r=(n=tT(e)).next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(t){s={error:t}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}}return[2,null]}})})}(s)];case 1:if(u=c.sent())return[3,4];return[4,self.clients.openWindow(o)];case 2:return u=c.sent(),[4,_h(3e3)];case 3:return c.sent(),[3,6];case 4:return[4,u.focus()];case 5:u=c.sent(),c.label=6;case 6:if(!u)return[2];return i.messageType=r.NOTIFICATION_CLICKED,i.isFirebaseMessaging=!0,[2,u.postMessage(i)]}})})},t}();function _f(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}var _d=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",function(t){return e.messageEventListener(t)})}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(i){switch(i.label){case 0:var o;if(!(e=t.data).isFirebaseMessaging)return[2];if(this.onMessageCallback&&e.messageType===r.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback((o=Object.assign({},e),delete o.messageType,delete o.isFirebaseMessaging,o)):this.onMessageCallback.next(Object.assign({},e))),!(_c(n=e.data)&&"1"===n["google.c.a.e"]))return[3,2];return[4,this.logEvent(e.messageType,n)];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:if("default"!==Notification.permission)return[3,2];return[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw yZ.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,_s(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}})})},t.prototype.updateVapidKey=function(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=y0),[2]})})},t.prototype.updateSwReg=function(t){return tw(this,void 0,void 0,function(){return tI(this,function(e){switch(e.label){case 0:if(!(!t&&!this.swRegistration))return[3,2];return[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw yZ.create("invalid-sw-registration");return this.swRegistration=t,[2]}})})},t.prototype.registerDefaultSw=function(){return tw(this,void 0,void 0,function(){var t,e;return tI(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch(function(){}),[3,3];case 2:throw e=n.sent(),yZ.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}})})},t.prototype.deleteToken=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:if(this.swRegistration)return[3,2];return[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,_a(this.firebaseDependencies,this.swRegistration)]}})})},t.prototype.requestPermission=function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){switch(e.label){case 0:if("granted"===Notification.permission)return[2];return[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];if("denied"===t)throw yZ.create("permission-blocked");throw yZ.create("permission-default")}})})},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw yZ.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw yZ.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw yZ.create("invalid-sw-registration");if(this.swRegistration)throw yZ.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw yZ.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw yZ.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(i){switch(i.label){case 0:return n=function(t){switch(t){case r.NOTIFICATION_CLICKED:return"notification_open";case r.PUSH_RECEIVED:return"notification_foreground";default:throw Error()}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return i.sent().logEvent(n,{message_id:e[y2],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}})})},t}();function _p(t){return yZ.create("missing-app-config-values",{valueName:t})}function _v(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}eR.INTERNAL.registerComponent(new es("messaging",function(t){var e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw _p("App Configuration Object");if(!t.name)throw _p("App Name");var e,n,r=t.options;try{for(var i=tT(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var s=o.value;if(!r[s])throw _p(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),r={app:e,appConfig:n,installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!_v())throw yZ.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new _l(r):new _d(r)},"PUBLIC").setServiceProps({isSupported:_v}));var _g="firebasestorage.googleapis.com",_m="storageBucket",_y=function(t){function e(n,r){var i=t.call(this,__(n),"Firebase Storage: "+r+" ("+__(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return t_(e,t),e.prototype._codeEquals=function(t){return __(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(tH);function __(t){return"storage/"+t}function _b(){return new _y("unknown","An unknown error occurred, please check the error payload for server response.")}function _w(){return new _y("canceled","User canceled the upload/download.")}function _I(){return new _y("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function _T(t){return new _y("invalid-argument",t)}function _E(){return new _y("app-deleted","The Firebase app was deleted.")}function _S(t){return new _y("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function _C(t,e){return new _y("invalid-format","String does not match format '"+t+"': "+e)}function _k(t){throw new _y("internal-error","Internal error: "+t)}var _N={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},_A=function(t,e){this.data=t,this.contentType=e||null};function _R(t,e){switch(t){case _N.RAW:return new _A(_x(e));case _N.BASE64:case _N.BASE64URL:return new _A(_P(t,e));case _N.DATA_URL:var n;return new _A((n=new _D(e)).base64?_P(_N.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw _C(_N.DATA_URL,"Malformed data URL.")}return _x(e)}(n.rest),new _D(e).contentType)}throw _b()}function _x(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):(64512&r)==55296?n<t.length-1&&(64512&t.charCodeAt(n+1))==56320?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):(64512&r)==56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function _P(t,e){switch(t){case _N.BASE64:var n,r,i=-1!==e.indexOf("-"),o=-1!==e.indexOf("_");if(i||o){var s=i?"-":"_";throw _C(t,"Invalid character '"+s+"' found: is it base64url encoded?")}break;case _N.BASE64URL:var a=-1!==e.indexOf("+"),u=-1!==e.indexOf("/");if(a||u){var s=a?"+":"/";throw _C(t,"Invalid character '"+s+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/")}try{n=e,r=atob(n)}catch(e){throw _C(t,"Invalid character found")}for(var c=new Uint8Array(r.length),h=0;h<r.length;h++)c[h]=r.charCodeAt(h);return c}var _D=function(t){this.base64=!1,this.contentType=null;var e,n=t.match(/^data:([^,]+)?,/);if(null===n)throw _C(_N.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var r=n[1]||null;null!=r&&(this.base64=(e=";base64",r.length>=e.length&&r.substring(r.length-e.length)===e),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)},_O={STATE_CHANGED:"state_changed"},_L={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function _M(t){switch(t){case"running":case"pausing":case"canceling":return _L.RUNNING;case"paused":return _L.PAUSED;case"success":return _L.SUCCESS;case"canceled":return _L.CANCELED;default:return _L.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(i||(i={}));var _F=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=i.NO_ERROR,this.sendPromise_=new Promise(function(e){t.xhr_.addEventListener("abort",function(){t.errorCode_=i.ABORT,e()}),t.xhr_.addEventListener("error",function(){t.errorCode_=i.NETWORK_ERROR,e()}),t.xhr_.addEventListener("load",function(){e()})})}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw _k("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw _k("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw _k("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return -1}},t.prototype.getResponseText=function(){if(!this.sent_)throw _k("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),_U=function(){function t(){}return t.prototype.createConnection=function(){return new _F},t}(),_j=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(n){return new t(e,"")}if(""===r.path)return r;throw new _y("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)",o=RegExp("^gs://"+i+"(/(.*))?$","i");function s(t){t.path_=decodeURIComponent(t.path)}for(var a=n.replace(/[.]/g,"\\."),u=RegExp("^https?://"+a+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),c=RegExp("^https?://"+(n===_g?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),h=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:u,indices:{bucket:1,path:3},postModify:s},{regex:c,indices:{bucket:1,path:2},postModify:s}],l=0;l<h.length;l++){var f=h[l],d=f.regex.exec(e);if(d){var p=d[f.indices.bucket],v=d[f.indices.path];v||(v=""),r=new t(p,v),f.postModify(r);break}}if(null==r)throw new _y("invalid-url","Invalid URL '"+e+"'.");return r},t}(),_q=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function _V(t){return"string"==typeof t||t instanceof String}function _B(t){return _K()&&t instanceof Blob}function _K(){return"undefined"!=typeof Blob}function _W(t,e,n,r){if(r<e)throw _T("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw _T("Invalid value for '"+t+"'. Expected "+n+" or less.")}function _H(t,e){var n=e.match(/^(\w+):\/\/.+/),r=null==n?void 0:n[1],i=e;return null==r&&(i="https://"+e),i+"/v0"+t}function _z(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}var _G=function(){function t(t,e,n,r,i,o,s,a,u,c,h){var l=this;this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=s,this.errorCallback_=a,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise(function(t,e){l.resolve_=t,l.reject_=e,l.start_()})}return t.prototype.start_=function(){var t=this;function e(e,n){var r=t.resolve_,i=t.reject_,o=n.connection;if(n.wasSuccessCode)try{var s=t.callback_(o,o.getResponseText());void 0!==s?r(s):r()}catch(t){i(t)}else if(null!==o){var a=_b();a.serverResponse=o.getResponseText(),i(t.errorCallback_?t.errorCallback_(o,a):a)}else if(n.canceled){var a=t.appDelete_?_E():_w();i(a)}else{var a=new _y("retry-limit-exceeded","Max retry time for operation exceeded, please try again.");i(a)}}this.canceled_?e(!1,new _Q(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,i=null,o=!1,s=0,a=!1;function u(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];a||(a=!0,e.apply(null,t))}function c(e){i=setTimeout(function(){i=null,t(h,2===s)},e)}function h(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(!a){if(t||2===s||o){u.call.apply(u,tS([null,t],n));return}r<64&&(r*=2),1===s?(s=2,e=0):e=(r+Math.random())*1e3,c(e)}}var l=!1;function f(t){!l&&(l=!0,a||(null!==i?(t||(s=2),clearTimeout(i),c(0)):t||(s=1)))}return c(0),setTimeout(function(){o=!0,f(!0)},n),f}(function(e,n){if(n){e(!1,new _Q(!1,null,!0));return}var r=t.pool_.createConnection();function o(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}t.pendingConnection_=r,null!==t.progressCallback_&&r.addUploadProgressListener(o),r.send(t.url_,t.method_,t.body_,t.headers_).then(function(){null!==t.progressCallback_&&r.removeUploadProgressListener(o),t.pendingConnection_=null;var n=r.getErrorCode()===i.NO_ERROR,s=r.getStatus();if(!n||t.isRetryStatusCode_(s)){var a=r.getErrorCode()===i.ABORT;e(!1,new _Q(!1,null,a));return}var u=-1!==t.successCodes_.indexOf(s);e(!0,new _Q(u,r))})},e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),_Q=function(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n};function _Y(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(_K())return new Blob(t);throw new _y("unsupported-environment","This browser doesn't seem to support creating Blobs")}var _$=function(){function t(t,e){var n=0,r="";_B(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(_B(this.data_)){var r,i=(r=this.data_).webkitSlice?r.webkitSlice(e,n):r.mozSlice?r.mozSlice(e,n):r.slice?r.slice(e,n):null;return null===i?null:new t(i)}var o=new Uint8Array(this.data_.buffer,e,n-e);return new t(o,!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(_K()){var r=e.map(function(e){return e instanceof t?e.data_:e});return new t(_Y.apply(null,r))}var i=e.map(function(t){return _V(t)?_R(_N.RAW,t).data:t.data_}),o=0;i.forEach(function(t){o+=t.byteLength});var s=new Uint8Array(o),a=0;return i.forEach(function(t){for(var e=0;e<t.length;e++)s[a++]=t[e]}),new t(s,!0)},t.prototype.uploadData=function(){return this.data_},t}();function _X(t){var e,n;try{e=JSON.parse(t)}catch(t){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e}function _J(t){var e=t.lastIndexOf("/",t.length-2);return -1===e?t:t.slice(e+1)}function _Z(t,e){return e}var _0=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||_Z},_1=null;function _2(){if(_1)return _1;var t=[];t.push(new _0("bucket")),t.push(new _0("generation")),t.push(new _0("metageneration")),t.push(new _0("name","fullPath",!0));var e=new _0("name");e.xform=function(t,e){return!_V(e)||e.length<2?e:_J(e)},t.push(e);var n=new _0("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new _0("timeCreated")),t.push(new _0("updated")),t.push(new _0("md5Hash",null,!0)),t.push(new _0("cacheControl",null,!0)),t.push(new _0("contentDisposition",null,!0)),t.push(new _0("contentEncoding",null,!0)),t.push(new _0("contentLanguage",null,!0)),t.push(new _0("contentType",null,!0)),t.push(new _0("metadata","customMetadata",!0)),_1=t}function _4(t,e,n){var r=_X(e);return null===r?null:function(t,e,n){var r={};r.type="file";for(var i=n.length,o=0;o<i;o++){var s=n[o];r[s.local]=s.xform(r,e[s.server])}return Object.defineProperty(r,"ref",{get:function(){var e=r.bucket,n=r.fullPath,i=new _j(e,n);return t._makeStorageReference(i)}}),r}(t,r,n)}function _3(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var _6="prefixes",_5="items",_8=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function _7(t){if(!t)throw _b()}function _9(t,e){return function(n,r){var i=_4(t,r,e);return _7(null!==i),i}}function bt(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=e.getResponseText().includes("Firebase App Check token is invalid")?new _y("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new _y("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(i=t.bucket,r=new _y("quota-exceeded","Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(o=t.path,r=new _y("unauthorized","User does not have permission to access '"+o+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function be(t){var e=bt(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new _y("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function bn(t,e,n){var r=_H(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new _8(r,"GET",_9(t,n),i);return o.errorHandler=be(e),o}function br(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=e&&e.type()||"application/octet-stream"),r}var bi=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function bo(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){_7(!1)}return _7(!!n&&-1!==(e||["active"]).indexOf(n)),n}var bs=function(t,e,n){"function"==typeof t||null!=e||null!=n?(this.next=t,this.error=e,this.complete=n):(this.next=t.next,this.error=t.error,this.complete=t.complete)};function ba(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then(function(){return t.apply(void 0,e)})}}var bu=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=_2(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise(function(t,e){r._resolve=t,r._reject=e,r._start()}),this._promise.then(null,function(){})}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(function(n){var r=n[0],i=n[1];switch(e._state){case"running":t(r,i);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}})},t.prototype._createResumable=function(){var t=this;this._resolveToken(function(e,n){var r,i,o,s,a,u,c,h,l,f,d,p,v,g=(r=t._ref.storage,i=t._ref._location,o=t._mappings,s=t._blob,a=t._metadata,u=i.bucketOnlyServerUrl(),h={name:(c=br(i,s,a)).fullPath},l=_H(u,r.host),f={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":""+s.size(),"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},d=_3(c,o),p=r.maxUploadRetryTime,(v=new _8(l,"POST",function(t){var e;bo(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){_7(!1)}return _7(_V(e)),e},p)).urlParams=h,v.headers=f,v.body=d,v.errorHandler=bt(i),v),m=t._ref.storage._makeRequest(g,e,n);t._request=m,m.getPromise().then(function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()},t._errorHandler)})},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken(function(n,r){var i,o,s,a,u,c=(i=t._ref.storage,o=t._ref._location,s=t._blob,a=i.maxUploadRetryTime,(u=new _8(e,"POST",function(t){var e=bo(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){_7(!1)}n||_7(!1);var r=Number(n);return _7(!isNaN(r)),new bi(r,s.size(),"final"===e)},a)).headers={"X-Goog-Upload-Command":"query"},u.errorHandler=bt(o),u),h=t._ref.storage._makeRequest(c,n,r);t._request=h,h.getPromise().then(function(e){t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()},t._errorHandler)})},t.prototype._continueUpload=function(){var t=this,e=262144*this._chunkMultiplier,n=new bi(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken(function(i,o){try{s=function(t,e,n,r,i,o,s,a){var u=new bi(0,0);if(s?(u.current=s.current,u.total=s.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new _y("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,f=l+h,d={"X-Goog-Upload-Command":h===c?"upload, finalize":"upload","X-Goog-Upload-Offset":""+u.current},p=r.slice(l,f);if(null===p)throw _I();var v=e.maxUploadRetryTime,g=new _8(n,"POST",function(t,n){var i,s=bo(t,["active","final"]),a=u.current+h,c=r.size();return i="final"===s?_9(e,o)(t,n):null,new bi(a,c,"final"===s,i)},v);return g.headers=d,g.body=p.uploadData(),g.progressCallback=a||null,g.errorHandler=bt(t),g}(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){t._error=e,t._transition("error");return}var s,a=t._ref.storage._makeRequest(s,i,o);t._request=a,a.getPromise().then(function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()},t._errorHandler)})},t.prototype._increaseMultiplier=function(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken(function(e,n){var r=bn(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then(function(e){t._request=void 0,t._metadata=e,t._transition("success")},t._metadataErrorHandler)})},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken(function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},a=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();s["Content-Type"]="multipart/related; boundary="+a;var u=br(e,r,i),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+_3(u,n)+"\r\n--"+a+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h=_$.getBlob(c,r,"\r\n--"+a+"--");if(null===h)throw _I();var l={name:u.fullPath},f=_H(o,t.host),d=t.maxUploadRetryTime,p=new _8(f,"POST",_9(t,n),d);return p.urlParams=l,p.headers=s,p.body=h.uploadData(),p.errorHandler=bt(e),p}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then(function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")},t._errorHandler)})},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=_w(),this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=_M(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new bs(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach(function(e){t._notifyObserver(e)})},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(_M(this._state)){case _L.SUCCESS:ba(this._resolve.bind(null,this.snapshot))();break;case _L.CANCELED:case _L.ERROR:ba(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(_M(this._state)){case _L.RUNNING:case _L.PAUSED:t.next&&ba(t.next.bind(t,this.snapshot))();break;case _L.SUCCESS:t.complete&&ba(t.complete.bind(t))();break;case _L.CANCELED:case _L.ERROR:default:t.error&&ba(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),bc=function(){function t(t,e){this._service=t,e instanceof _j?this._location=e:this._location=_j.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new _j(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return _J(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return -1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new _j(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw _S(t)},t}();function bh(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){switch(i.label){case 0:var o,s,a,u,c,h,l,f,d;return null!=e&&"number"==typeof e.maxResults&&_W("options.maxResults",1,1e3,e.maxResults),n=e||{},o=t.storage,s=t._location,a=n.pageToken,u=n.maxResults,c={},s.isRoot?c.prefix="":c.prefix=s.path+"/",c.delimiter="/",a&&(c.pageToken=a),u&&(c.maxResults=u),h=_H(s.bucketOnlyServerUrl(),o.host),l=o.maxOperationRetryTime,(d=new _8(h,"GET",(f=s.bucket,function(t,e){var n,r=null===(n=_X(e))?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[_6])for(var i=0,o=n[_6];i<o.length;i++){var s=o[i].replace(/\/$/,""),a=t._makeStorageReference(new _j(e,s));r.prefixes.push(a)}if(n[_5])for(var u=0,c=n[_5];u<c.length;u++){var h=c[u],a=t._makeStorageReference(new _j(e,h.name));r.items.push(a)}return r}(o,f,n);return _7(null!==r),r}),l)).urlParams=c,d.errorHandler=bt(s),r=d,[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,i.sent().getPromise()]}})})}function bl(t,e){var n,r,i=(n=t._location.path,r=e.split("/").filter(function(t){return t.length>0}).join("/"),0===n.length?r:n+"/"+r),o=new _j(t._location.bucket,i);return new bc(t.storage,o)}function bf(t){return/^[A-Za-z]+:\/\//.test(t)}function bd(t,e){var n=null==e?void 0:e[_m];return null==n?null:_j.makeFromBucketSpec(n,t)}var bp=function(){function t(t,e,n,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=_g,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,null!=i?this._bucket=_j.makeFromBucketSpec(i,this._host):this._bucket=bd(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,null!=this._url?this._bucket=_j.makeFromBucketSpec(this._url,t):this._bucket=bd(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){_W("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){_W("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return tw(this,void 0,void 0,function(){var t,e;return tI(this,function(n){switch(n.label){case 0:if(!(t=this._authProvider.getImmediate({optional:!0})))return[3,2];return[4,t.getToken()];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}})})},t.prototype._getAppCheckToken=function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){switch(e.label){case 0:if(!(t=this._appCheckProvider.getImmediate({optional:!0})))return[3,2];return[4,t.getToken()];case 1:return[2,e.sent().token];case 2:return[2,null]}})})},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach(function(t){return t.cancel()}),this._requests.clear(),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new bc(this,t)},t.prototype._makeRequest=function(t,e,n){var r,i,o,s,a,u,c=this;if(this._deleted)return new _q(_E());var h=(r=this._appId,i=this._pool,o=this._firebaseVersion,s=_z(t.urlParams),a=t.url+s,u=Object.assign({},t.headers),r&&(u["X-Firebase-GMPID"]=r),null!==e&&e.length>0&&(u.Authorization="Firebase "+e),u["X-Firebase-Storage-Version"]="webjs/"+(null!=o?o:"AppManager"),null!==n&&(u["X-Firebase-AppCheck"]=n),new _G(a,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i));return this._requests.add(h),h.getPromise().then(function(){return c._requests.delete(h)},function(){return c._requests.delete(h)}),h},t.prototype.makeRequestWithTokens=function(t){return tw(this,void 0,void 0,function(){var e,n,r;return tI(this,function(i){switch(i.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return n=(e=i.sent())[0],r=e[1],[2,this._makeRequest(t,n,r)]}})})},t}();function bv(t,e){return function(t,e){if(!(e&&bf(e)))return function t(e,n){if(e instanceof bp){if(null==e._bucket)throw new _y("no-default-bucket","No default bucket found. Did you set the '"+_m+"' property when initializing the app?");var r=new bc(e,e._bucket);return null!=n?t(r,n):r}if(void 0===n)return e;if(n.includes(".."))throw _T('`path` param cannot contain ".."');return bl(e,n)}(t,e);if(t instanceof bp)return new bc(t,e);throw _T("To use ref(service, url), the first argument must be a Storage instance.")}(t=eo(t),e)}var bg=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),bm=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new bg(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then(function(e){if(t)return t(new bg(e,n,n._ref))},e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new bg(t,i,i._ref))}:{next:e.next?function(t){return e.next(new bg(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),by=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map(function(e){return new b_(e,t._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map(function(e){return new b_(e,t._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),b_=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){var n=bl(this._delegate,e);return new t(n,this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){var n,r;return this._throwIfRoot("put"),new bm(((r=eo(this._delegate))._throwIfRoot("uploadBytesResumable"),new bu(r,new _$(t),e)),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=_N.RAW),this._throwIfRoot("putString");var r=_R(e,t),i=tb({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new bm(new bu(this._delegate,new _$(r.data,!0),i),this)},t.prototype.listAll=function(){var t,e,n=this;return(t=this._delegate,e={prefixes:[],items:[]},(function t(e,n,r){return tw(this,void 0,void 0,function(){var i,o,s;return tI(this,function(a){switch(a.label){case 0:return[4,bh(e,{pageToken:r})];case 1:if(i=a.sent(),(o=n.prefixes).push.apply(o,i.prefixes),(s=n.items).push.apply(s,i.items),!(null!=i.nextPageToken))return[3,3];return[4,t(e,n,i.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}})})})(t=eo(t),e).then(function(){return e})).then(function(t){return new by(t,n.storage)})},t.prototype.list=function(t){var e,n,r=this;return(e=this._delegate,n=t||void 0,bh(e=eo(e),n)).then(function(t){return new by(t,r.storage)})},t.prototype.getMetadata=function(){return function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=bn(t.storage,t._location,_2()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}})})}(eo(this._delegate))},t.prototype.updateMetadata=function(t){var e;return function(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:var i,o,s,a,u,c,h;return t._throwIfRoot("updateMetadata"),i=t.storage,o=t._location,s=_2(),a=_H(o.fullServerUrl(),i.host),u=_3(e,s),c=i.maxOperationRetryTime,(h=new _8(a,"PATCH",_9(i,s),c)).headers={"Content-Type":"application/json; charset=utf-8"},h.body=u,h.errorHandler=be(o),n=h,[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}})})}(eo(this._delegate),t)},t.prototype.getDownloadURL=function(){return function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:var r,i,o,s,a,u;return t._throwIfRoot("getDownloadURL"),r=t.storage,i=t._location,o=_2(),s=_H(i.fullServerUrl(),r.host),a=r.maxOperationRetryTime,(u=new _8(s,"GET",function(t,e){var n=_4(r,e,o);return _7(null!==n),function(t,e,n){var r=_X(e);if(null===r||!_V(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map(function(e){var r=t.bucket,i=t.fullPath;return _H("/b/"+o(r)+"/o/"+o(i),n)+_z({alt:"media",token:e})})[0]}(n,e,r.host)},a)).errorHandler=be(i),e=u,[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then(function(t){if(null===t)throw new _y("no-download-url","The given file does not have any download URLs.");return t})]}})})}(eo(this._delegate))},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:var r,i,o,s,a;return t._throwIfRoot("deleteObject"),r=t.storage,o=_H((i=t._location).fullServerUrl(),r.host),s=r.maxOperationRetryTime,(a=new _8(o,"DELETE",function(t,e){},s)).successCodes=[200,204],a.errorHandler=be(i),e=a,[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}})})}(eo(this._delegate))},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw _S(t)},t}(),bb=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(bf(t))throw _T("ref() expected a child path but got a URL, use refFromURL instead.");return new b_(bv(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!bf(t))throw _T("refFromURL() expected a full URL but got a child path, use ref() instead.");try{_j.makeFromUrl(t,this._delegate.host)}catch(t){throw _T("refFromUrl() expected a valid full URL but got an invalid one.")}return new b_(bv(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e){this._delegate.host="http://"+t+":"+e},t}();function bw(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new bb(r,new bp(r,i,o,new _U,n,eR.SDK_VERSION))}!function(t){t.INTERNAL.registerComponent(new es("storage",bw,"PUBLIC").setServiceProps({TaskState:_L,TaskEvent:_O,StringFormat:_N,Storage:bp,Reference:b_}).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.5.6")}(eR);var bI="0.4.16",bT="FB-PERF-TRACE-MEASURE",bE="_wt_",bS="_fcp",bC="_fid",bk="@firebase/performance/config",bN="@firebase/performance/configexpire",bA="Performance",bR=((o={})["trace started"]="Trace {$traceName} was started before.",o["trace stopped"]="Trace {$traceName} is not running.",o["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",o["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",o["no window"]="Window is not available.",o["no app id"]="App id is not available.",o["no project id"]="Project id is not available.",o["no api key"]="Api key is not available.",o["invalid cc log"]="Attempted to queue invalid cc event",o["FB not default"]="Performance can only start when Firebase app instance is the default one.",o["RC response not ok"]="RC response is not ok",o["invalid attribute name"]="Attribute name {$attributeName} is invalid.",o["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",o["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",o["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",o),bx=new tz("performance",bA,bR),bP=new eg(bA);bP.logLevel=sU.INFO;var bD=function(){function t(t){if(this.window=t,!t)throw bx.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!tB()||(bP.info("IndexedDB is not supported by current browswer"),!1):(bP.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++)e(r[n])}).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===s&&(s=new t(a)),s},t}();function bO(t,e){var n=t.length-e.length;if(n<0||n>1)throw bx.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var bL=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=bO("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=bO("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw bx.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw bx.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw bx.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===u&&(u=new t),u},t}();!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(h||(h={}));var bM=["firebase_","google_","ga_"],bF=RegExp("^[a-zA-Z]\\w*$");function bU(){switch(bD.getInstance().document.visibilityState){case"visible":return h.VISIBLE;case"hidden":return h.HIDDEN;default:return h.UNKNOWN}}var bj={loggingEnabled:!0};function bq(t){if(!t)return t;var e=bL.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=bj.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=bV(e.tracesSamplingRate),e.logNetworkAfterSampling=bV(e.networkRequestsSamplingRate),t}function bV(t){return Math.random()<=t}var bB=1;function bK(){var t;return bB=2,l=l||(t=bD.getInstance().document,new Promise(function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})).then(function(){var t;return(t=bL.getInstance().installationsService.getId()).then(function(t){c=t}),t}).then(function(t){var e,n;return(e=function(){var t=bD.getInstance().localStorage;if(t){var e=t.getItem(bN);if(e&&Number(e)>Date.now()){var n=t.getItem(bk);if(n)try{return JSON.parse(n)}catch(t){return}}}}())?(bq(e),Promise.resolve()):((n=bL.getInstance().installationsService.getToken()).then(function(t){}),n).then(function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+bL.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+bL.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:bL.getInstance().getAppId(),app_version:bI,sdk_version:"0.0.1"})});return fetch(r).then(function(t){if(t.ok)return t.json();throw bx.create("RC response not ok")})}).catch(function(){bP.info("Could not fetch config, will use default configs")}).then(bq).then(function(t){var e;return e=bD.getInstance().localStorage,void(t&&e&&(e.setItem(bk,JSON.stringify(t)),e.setItem(bN,String(Date.now()+36e5*bL.getInstance().configTimeToLive))))},function(){})}).then(function(){bB=3},function(){bB=3})}var bW=3,bH=[],bz=!1;function bG(t,e){!f&&(f=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t){if(!t.eventTime||!t.message)throw bx.create("invalid cc log");bH=tS(tS([],bH),[t])}({message:b$.apply(void 0,t),eventTime:Date.now()})}),f(t,e)}function bQ(t){var e=bL.getInstance();(e.instrumentationEnabled||!t.isAuto)&&(e.dataCollectionEnabled||t.isAuto)&&bD.getInstance().requiredApisAvailable()&&(t.isAuto&&bU()!==h.VISIBLE||(3===bB?bY(t):bK().then(function(){return bY(t)},function(){return bY(t)})))}function bY(t){if(c){var e=bL.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout(function(){return bG(t,1)},0)}}function b$(t,e){var n,r,i;return 0===e?(n={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},JSON.stringify({application_info:bX(),network_request_metric:n})):(r={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs},0!==Object.keys(t.counters).length&&(r.counters=t.counters),0!==Object.keys(i=t.getAttributes()).length&&(r.custom_attributes=i),JSON.stringify({application_info:bX(),trace_metric:r}))}function bX(){var t;return{google_app_id:bL.getInstance().getAppId(),app_instance_id:c,web_app_info:{sdk_version:bI,page_url:bD.getInstance().getUrl(),service_worker_status:"serviceWorker"in(t=bD.getInstance().navigator)?t.serviceWorker.controller?2:3:1,visibility_state:bU(),effective_connection_type:function(){var t=bD.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0}}var bJ=["_fp",bS,bC],bZ=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=bD.getInstance(),this.randomId=Math.floor(1e6*Math.random()),!this.isAuto&&(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||bT+"-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw bx.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw bx.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),bQ(this)},t.prototype.record=function(t,e,n){if(t<=0)throw bx.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw bx.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=tb({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}bQ(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){var n,r;if(n=this.name,0!==t.length&&!(t.length>100)&&(n&&n.startsWith(bE)&&bJ.indexOf(t)>-1||!t.startsWith("_")))this.counters[t]=((r=Math.floor(e))<e&&bP.info("Metric value should be an Integer, setting the value as : "+r+"."),r);else throw bx.create("invalid custom metric name",{customMetricName:t})},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n=0!==t.length&&!(t.length>40)&&!bM.some(function(e){return t.startsWith(e)})&&!!t.match(bF),r=0!==e.length&&e.length<=100;if(n&&r){this.customAttributes[t]=e;return}if(!n)throw bx.create("invalid attribute name",{attributeName:t});if(!r)throw bx.create("invalid attribute value",{attributeValue:e})},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return tb({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor((e.startTime+this.api.getTimeOrigin())*1e3))},t.createOobTrace=function(e,n,r){var i=bD.getInstance().getUrl();if(i){var o=new t(bE+i,!0),s=Math.floor(1e3*bD.getInstance().getTimeOrigin());if(o.setStartTime(s),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var a=n.find(function(t){return"first-paint"===t.name});a&&a.startTime&&o.putMetric("_fp",Math.floor(1e3*a.startTime));var u=n.find(function(t){return"first-contentful-paint"===t.name});u&&u.startTime&&o.putMetric(bS,Math.floor(1e3*u.startTime)),r&&o.putMetric(bC,Math.floor(1e3*r))}bQ(o)}},t.createUserTimingTrace=function(e){bQ(new t(e,!1,e))},t}();function b0(t){if(t&&void 0!==t.responseStart){var e=bD.getInstance().getTimeOrigin(),n=Math.floor((t.startTime+e)*1e3),r=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,i=Math.floor((t.responseEnd-t.startTime)*1e3);!function(t){var e=bL.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(function(){return bG(t,0)},0)}}({url:t.name&&t.name.split("?")[0],responsePayloadBytes:t.transferSize,startTimeUs:n,timeToResponseInitiatedUs:r,timeToResponseCompletedUs:i})}}function b1(){c&&(setTimeout(function(){return function(){var t=bD.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout(function(){bZ.createOobTrace(e,n),r=void 0},5e3);t.onFirstInputDelay(function(t){r&&(clearTimeout(r),bZ.createOobTrace(e,n,t))})}else bZ.createOobTrace(e,n)}()},0),setTimeout(function(){return function(){for(var t=bD.getInstance(),e=t.getEntriesByType("resource"),n=0;n<e.length;n++)b0(e[n]);t.setupObserver("resource",b0)}()},0),setTimeout(function(){return function(){for(var t=bD.getInstance(),e=t.getEntriesByType("measure"),n=0;n<e.length;n++)b2(e[n]);t.setupObserver("measure",b2)}()},0))}function b2(t){var e=t.name;e.substring(0,bT.length)!==bT&&bZ.createUserTimingTrace(e)}var b4=function(){function t(t){this.app=t,bD.getInstance().requiredApisAvailable()&&tK().then(function(t){t&&(bz||(function t(e){setTimeout(function(){if(0!==bW){var e,n,r,i;if(!bH.length)return t(1e4);n=(e=bH.splice(0,1e3)).map(function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}}),(r={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:bL.getInstance().logSource,log_event:n},(i=bL.getInstance().getFlTransportFullUrl(),fetch(i,{method:"POST",body:JSON.stringify(r)})).then(function(t){return t.ok||bP.info("Call to Firebase backend failed."),t.json()}).then(function(n){var r=Number(n.nextRequestWaitMillis),i=1e4;isNaN(r)||(i=Math.max(r,i));var o=n.logResponseDetails;Array.isArray(o)&&o.length>0&&"RETRY_REQUEST_LATER"===o[0].responseAction&&(bH=tS(tS([],e),bH),bP.info("Retry transport request later.")),bW=3,t(i)})).catch(function(){bH=tS(tS([],e),bH),bW--,bP.info("Tries left: "+bW+"."),t(1e4)})}},e)}(5500),bz=!0),bK().then(b1,b1))}).catch(function(t){bP.info("Environment doesn't support IndexedDB: "+t)})}return t.prototype.trace=function(t){return new bZ(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return bL.getInstance().instrumentationEnabled},set:function(t){bL.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return bL.getInstance().dataCollectionEnabled},set:function(t){bL.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){var e=function(t,e){if("[DEFAULT]"!==t.name)throw bx.create("FB not default");if("undefined"==typeof window)throw bx.create("no window");return a=window,bL.getInstance().firebaseAppInstance=t,bL.getInstance().installationsService=e,new b4(t)};t.INTERNAL.registerComponent(new es("performance",function(t){return e(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())},"PUBLIC")),t.registerVersion("@firebase/performance",bI)}(eR);var b3="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(d||(d={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(p||(p={}));var b6=new eg("@firebase/analytics"),b5=((v={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",v["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",v["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",v["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",v["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",v["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",v["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",v["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',v["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',v),b8=new tz("analytics","Analytics",b5),b7=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}()),b9=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach(function(t){return t()})},t}(),wt={},we=[],wn={},wr="dataLayer",wi="gtag",wo=!1;function ws(t){if(wo)throw b8.create("already-initialized");t.dataLayerName&&(wr=t.dataLayerName),t.gtagName&&(wi=t.gtagName)}var wa="analytics";function wu(){return tw(this,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:if(tj()||!tW()||!tB())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,tK()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}})})}!function(t){t.INTERNAL.registerComponent(new es(wa,function(t){return function(t,e){!function(){var t=[];if(tj()&&t.push("This is a browser extension environment."),tW()||t.push("Cookies are not available."),t.length>0){var e=t.map(function(t,e){return"("+(e+1)+") "+t}).join(" "),n=b8.create("invalid-analytics-context",{errorInfo:e});b6.warn(n.message)}}();var n=t.options.appId;if(!n)throw b8.create("no-app-id");if(!t.options.apiKey){if(t.options.measurementId)b6.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.');else throw b8.create("no-api-key")}if(null!=wt[n])throw b8.create("already-exists",{id:n});if(!wo){r=wr,i=[],Array.isArray(window[r])?i=window[r]:window[r]=i;var r,i,o,s,a,u,c=(o=wr,s=wi,a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[o].push(arguments)},window[s]&&"function"==typeof window[s]&&(a=window[s]),window[s]=(u=a,function(t,e,n){return tw(this,void 0,void 0,function(){var r;return tI(this,function(i){switch(i.label){case 0:if(i.trys.push([0,6,,7]),t!==d.EVENT)return[3,2];return[4,function(t,e,n,r,i){return tw(this,void 0,void 0,function(){var o,s,a,u,c,h,l;return tI(this,function(f){switch(f.label){case 0:if(f.trys.push([0,4,,5]),o=[],!(i&&i.send_to))return[3,2];return Array.isArray(s=i.send_to)||(s=[s]),[4,Promise.all(n)];case 1:for(c=0,a=f.sent(),u=function(t){var n=a.find(function(e){return e.measurementId===t}),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},h=s;c<h.length&&"break"!==u(h[c]);c++);f.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return f.sent(),t(d.EVENT,r,i||{}),[3,5];case 4:return l=f.sent(),b6.error(l),[3,5];case 5:return[2]}})})}(u,wt,we,e,n)];case 1:case 3:return i.sent(),[3,5];case 2:if(t!==d.CONFIG)return[3,4];return[4,function(t,e,n,r,i,o){return tw(this,void 0,void 0,function(){var s,a,u;return tI(this,function(c){switch(c.label){case 0:s=r[i],c.label=1;case 1:if(c.trys.push([1,7,,8]),!s)return[3,3];return[4,e[s]];case 2:return c.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:if(!(a=c.sent().find(function(t){return t.measurementId===i})))return[3,6];return[4,e[a.appId]];case 5:c.sent(),c.label=6;case 6:return[3,8];case 7:return u=c.sent(),b6.error(u),[3,8];case 8:return t(d.CONFIG,i,o),[2]}})})}(u,wt,we,wn,e,n)];case 4:u(d.SET,e),i.label=5;case 5:return[3,7];case 6:return r=i.sent(),b6.error(r),[3,7];case 7:return[2]}})})}),{gtagCore:a,wrappedGtag:window[s]}),h=c.wrappedGtag,l=c.gtagCore;m=h,g=l,wo=!0}return wt[n]=function(t,e,n,r,i,o){return tw(this,void 0,void 0,function(){var s,a,u,c,h,l;return tI(this,function(f){switch(f.label){case 0:return(s=function(t,e,n){return void 0===e&&(e=b7),tw(this,void 0,void 0,function(){var r,i,o,s,a,u,c=this;return tI(this,function(h){if(i=(r=t.options).appId,o=r.apiKey,s=r.measurementId,!i)throw b8.create("no-app-id");if(!o){if(s)return[2,{measurementId:s,appId:i}];throw b8.create("no-api-key")}return a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new b9,setTimeout(function(){return tw(c,void 0,void 0,function(){return tI(this,function(t){return u.abort(),[2]})})},void 0!==n?n:6e4),[2,function t(e,n,r,i){var o=n.throttleEndTimeMillis,s=n.backoffCount;return void 0===i&&(i=b7),tw(this,void 0,void 0,function(){var n,a,u,c,h,l,f;return tI(this,function(d){switch(d.label){case 0:n=e.appId,a=e.measurementId,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,new Promise(function(t,e){var n=setTimeout(t,Math.max(o-Date.now(),0));r.addEventListener(function(){clearTimeout(n),e(b8.create("fetch-throttle",{throttleEndTimeMillis:o}))})})];case 2:return d.sent(),[3,4];case 3:if(u=d.sent(),a)return b6.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+u.message+"]"),[2,{appId:n,measurementId:a}];throw u;case 4:return d.trys.push([4,6,,7]),[4,function(t){var e;return tw(this,void 0,void 0,function(){var n,r,i,o,s,a;return tI(this,function(u){switch(u.label){case 0:var c;return n=t.appId,r={method:"GET",headers:(c=t.apiKey,new Headers({Accept:"application/json","x-goog-api-key":c}))},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(i,r)];case 1:if(!(200!==(o=u.sent()).status&&304!==o.status))return[3,6];s="",u.label=2;case 2:return u.trys.push([2,4,,5]),[4,o.json()];case 3:return(null===(e=(a=u.sent()).error)||void 0===e?void 0:e.message)&&(s=a.error.message),[3,5];case 4:return u.sent(),[3,5];case 5:throw b8.create("config-fetch-failed",{httpStatus:o.status,responseMessage:s});case 6:return[2,o.json()]}})})}(e)];case 5:return c=d.sent(),i.deleteThrottleMetadata(n),[2,c];case 6:if(!function(t){if(!(t instanceof tH)||!t.customData)return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(h=d.sent())){if(i.deleteThrottleMetadata(n),a)return b6.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+h.message+"]"),[2,{appId:n,measurementId:a}];throw h}return l=503===Number(h.customData.httpStatus)?ei(s,i.intervalMillis,30):ei(s,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+l,backoffCount:s+1},i.setThrottleMetadata(n,f),b6.debug("Calling attemptFetch again in "+l+" millis"),[2,t(e,f,r,i)];case 7:return[2]}})})}({appId:i,apiKey:o,measurementId:s},a,u,e)]})})}(t)).then(function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&b6.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(function(t){return b6.error(t)}),e.push(s),[4,Promise.all([s,(function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){switch(e.label){case 0:if(tB())return[3,1];return b6.warn(b8.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1];case 1:return e.trys.push([1,3,,4]),[4,tK()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),b6.warn(b8.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}})})})().then(function(t){return t?r.getId():void 0})])];case 1:if(u=(a=f.sent())[0],c=a[1],!function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(b3))return r}return null}()){var p,v;p=u.measurementId,(v=document.createElement("script")).src=b3+"?l="+o+"&id="+p,v.async=!0,document.head.appendChild(v)}return i("js",new Date),(l={}).origin="firebase",l.update=!0,h=l,null!=c&&(h.firebase_id=c),i(d.CONFIG,u.measurementId,h),[2,u.measurementId]}})})}(t,we,wn,e,g,wr),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return tw(this,void 0,void 0,function(){var o,s;return tI(this,function(a){switch(a.label){case 0:if(!(i&&i.global))return[3,1];return t(d.EVENT,n,r),[2];case 1:return[4,e];case 2:o=a.sent(),s=tb(tb({},r),{send_to:o}),t(d.EVENT,n,s),a.label=3;case 3:return[2]}})})})(m,wt[n],t,e,r).catch(function(t){return b6.error(t)})},setCurrentScreen:function(t,e){(function(t,e,n,r){return tw(this,void 0,void 0,function(){var i;return tI(this,function(o){switch(o.label){case 0:if(!(r&&r.global))return[3,1];return t(d.SET,{screen_name:n}),[2,Promise.resolve()];case 1:return[4,e];case 2:i=o.sent(),t(d.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}})})})(m,wt[n],t,e).catch(function(t){return b6.error(t)})},setUserId:function(t,e){(function(t,e,n,r){return tw(this,void 0,void 0,function(){var i;return tI(this,function(o){switch(o.label){case 0:if(!(r&&r.global))return[3,1];return t(d.SET,{user_id:n}),[2,Promise.resolve()];case 1:return[4,e];case 2:i=o.sent(),t(d.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}})})})(m,wt[n],t,e).catch(function(t){return b6.error(t)})},setUserProperties:function(t,e){(function(t,e,n,r){return tw(this,void 0,void 0,function(){var i,o,s,a,u;return tI(this,function(c){switch(c.label){case 0:if(!(r&&r.global))return[3,1];for(o=0,i={},s=Object.keys(n);o<s.length;o++)i["user_properties."+(a=s[o])]=n[a];return t(d.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(d.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}})})})(m,wt[n],t,e).catch(function(t){return b6.error(t)})},setAnalyticsCollectionEnabled:function(t){(function(t,e){return tw(this,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}})})})(wt[n],t).catch(function(t){return b6.error(t)})},INTERNAL:{delete:function(){return delete wt[n],Promise.resolve()}}}}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())},"PUBLIC").setServiceProps({settings:ws,EventName:p,isSupported:wu})),t.INTERNAL.registerComponent(new es("analytics-internal",function(t){try{return{logEvent:t.getProvider(wa).getImmediate().logEvent}}catch(t){throw b8.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.14")}(eR);var wc=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return tw(this,void 0,void 0,function(){var e,n,r,i,o;return tI(this,function(s){switch(s.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:if(n=(e=s.sent())[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n))return[2,r];return t.eTag=r&&r.eTag,[4,this.client.fetch(t)];case 2:return i=s.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return s.sent(),[2,i]}})})},t}(),wh=((y={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",y["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",y["registration-api-key"]="Undefined API key. Check Firebase app initialization.",y["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",y["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",y["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",y["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",y["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",y["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",y["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',y["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',y["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",y["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",y),wl=new tz("remoteconfig","Remote Config",wh),wf=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return tw(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,c,h,l,f,d,p,v,g;return tI(this,function(m){switch(m.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:var y;n=(e=m.sent())[0],r=e[1],i=(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com")+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,o={method:"POST",headers:{"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},body:JSON.stringify({sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===y&&(y=navigator),y.languages&&y.languages[0]||y.language)})},s=fetch(i,o),a=new Promise(function(e,n){t.signal.addEventListener(function(){var t=Error("The operation was aborted.");t.name="AbortError",n(t)})}),m.label=2;case 2:return m.trys.push([2,5,,6]),[4,Promise.race([s,a])];case 3:return m.sent(),[4,s];case 4:return u=m.sent(),[3,6];case 5:throw c=m.sent(),h="fetch-client-network","AbortError"===c.name&&(h="fetch-timeout"),wl.create(h,{originalErrorMessage:c.message});case 6:if(l=u.status,f=u.headers.get("ETag")||void 0,200!==u.status)return[3,11];v=void 0,m.label=7;case 7:return m.trys.push([7,9,,10]),[4,u.json()];case 8:return v=m.sent(),[3,10];case 9:throw g=m.sent(),wl.create("fetch-client-parse",{originalErrorMessage:g.message});case 10:d=v.entries,p=v.state,m.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===p?l=500:"NO_CHANGE"===p?l=304:("NO_TEMPLATE"===p||"EMPTY_CONFIG"===p)&&(d={}),304!==l&&200!==l)throw wl.create("fetch-status",{httpStatus:l});return[2,{status:l,eTag:f,config:d}]}})})},t}(),wd=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach(function(t){return t()})},t}(),wp=["1","true","t","yes","y","on"],wv=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&wp.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),wg=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=sU.DEBUG;break;case"silent":this._logger.logLevel=sU.SILENT;break;default:this._logger.logLevel=sU.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return tw(this,void 0,void 0,function(){var t,e,n;return tI(this,function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:if(e=(t=r.sent())[0],n=t[1],!e||!e.config||!e.eTag||e.eTag===n)return[2,!1];return[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])];case 2:return r.sent(),[2,!0]}})})},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0})),this._initializePromise},t.prototype.fetch=function(){return tw(this,void 0,void 0,function(){var t,e,n,r=this;return tI(this,function(i){switch(i.label){case 0:t=new wd,setTimeout(function(){return tw(r,void 0,void 0,function(){return tI(this,function(e){return t.abort(),[2]})})},this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:var o;return n=(o=e=i.sent())instanceof tH&&-1!==o.code.indexOf("fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}})})},t.prototype.fetchAndActivate=function(){return tw(this,void 0,void 0,function(){return tI(this,function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}})})},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(tb(tb({},t),e))).reduce(function(t,e){return t[e]=n.getValue(e),t},{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new wv("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new wv("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new wv("static"))},t}();function wm(t,e){var n=t.target.error||void 0;return wl.create(e,{originalErrorMessage:n&&n.message})}"use strict";var wy="app_namespace_store",w_=function(){function t(t,e,n,r){void 0===r&&(r=new Promise(function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(wm(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;0===t.oldVersion&&e.createObjectStore(wy,{keyPath:"compositeKey"})}})),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return tw(this,void 0,void 0,function(){var e,n=this;return tI(this,function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise(function(r,i){var o=e.transaction([wy],"readonly").objectStore(wy),s=n.createCompositeKey(t);try{var a=o.get(s);a.onerror=function(t){i(wm(t,"storage-get"))},a.onsuccess=function(t){var e=t.target.result;e?r(e.value):r(void 0)}}catch(t){i(wl.create("storage-get",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.set=function(t,e){return tw(this,void 0,void 0,function(){var n,r=this;return tI(this,function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise(function(i,o){var s=n.transaction([wy],"readwrite").objectStore(wy),a=r.createCompositeKey(t);try{var u=s.put({compositeKey:a,value:e});u.onerror=function(t){o(wm(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){o(wl.create("storage-set",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.delete=function(t){return tw(this,void 0,void 0,function(){var e,n=this;return tI(this,function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise(function(r,i){var o=e.transaction([wy],"readwrite").objectStore(wy),s=n.createCompositeKey(t);try{var a=o.delete(s);a.onerror=function(t){i(wm(t,"storage-delete"))},a.onsuccess=function(){r()}}catch(t){i(wl.create("storage-delete",{originalErrorMessage:t&&t.message}))}})]}})})},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),wb=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return tw(this,void 0,void 0,function(){var t,e,n,r,i,o;return tI(this,function(s){switch(s.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=s.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=s.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=s.sent())&&(this.activeConfig=o),[2]}})})},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}(),ww=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}})})},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return tw(this,void 0,void 0,function(){var e,i,o;return tI(this,function(s){switch(s.label){case 0:var a;return[4,(a=t.signal,new Promise(function(t,e){var r=setTimeout(t,Math.max(n-Date.now(),0));a.addEventListener(function(){clearTimeout(r),e(wl.create("fetch-throttle",{throttleEndTimeMillis:n}))})}))];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof tH)||!t.customData)return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=s.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+ei(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return s.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}})})},t}(),wI="@firebase/remote-config";!function(t){t.INTERNAL.registerComponent(new es("remoteConfig",function(e,n){var r=n.instanceIdentifier,i=e.getProvider("app").getImmediate(),o=e.getProvider("installations").getImmediate();if("undefined"==typeof window)throw wl.create("registration-window");var s=i.options,a=s.projectId,u=s.apiKey,c=s.appId;if(!a)throw wl.create("registration-project-id");if(!u)throw wl.create("registration-api-key");if(!c)throw wl.create("registration-app-id");r=r||"firebase";var h=new w_(c,i.name,r),l=new wb(h),f=new eg(wI);f.logLevel=sU.ERROR;var d=new wf(o,t.SDK_VERSION,r,a,u,c),p=new ww(d,h),v=new wc(p,h,l,f),g=new wg(i,v,l,h,f);return g.ensureInitialized(),g},"PUBLIC").setMultipleInstances(!0)),t.registerVersion(wI,"0.1.41")}(eR);var wT=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(tm),wE=((_={})["already-activated"]="You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.",_["use-before-activation"]="AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.",_["fetch-network-error"]="Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",_["fetch-parse-error"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",_["fetch-status-error"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",_["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",_["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",_["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",_["recaptcha-error"]="ReCAPTCHA error.",_),wS=new tz("appCheck","AppCheck",wE),wC=new Map,wk={activated:!1,tokenObservers:[]},wN={enabled:!1};function wA(t){return wC.get(t)||wk}function wR(t,e){wC.set(t,e)}function wx(){return self.grecaptcha}function wP(t){if(!wA(t).activated)throw wS.create("use-before-activation",{appName:t.name})}function wD(t,e,n,r){var i=n.render(r,{sitekey:e,size:"invisible"}),o=wA(t);wR(t,tb(tb({},o),{reCAPTCHAState:tb(tb({},o.reCAPTCHAState),{widgetId:i})}))}var wO="https://content-firebaseappcheck.googleapis.com/v1beta",wL={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4},wM=function(){function t(t,e,n,r,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw Error("Proactive refresh lower bound greater than upper bound!")}return t.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})},t.prototype.stop=function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)},t.prototype.isRunning=function(){return!!this.pending},t.prototype.process=function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:this.stop(),n.label=1;case 1:var r;return n.trys.push([1,6,,7]),this.pending=new tL,[4,(r=this.getNextRun(t),new Promise(function(t){setTimeout(t,r)}))];case 2:case 4:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return n.sent(),this.pending=new tL,[4,this.operation()];case 5:return n.sent(),this.process(!0).catch(function(){}),[3,7];case 6:return e=n.sent(),this.retryPolicy(e)?this.process(!1).catch(function(){}):this.stop(),[3,7];case 7:return[2]}})})},t.prototype.getNextRun=function(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e},t}();function wF(t,e){var n=t.url,r=t.body;return tw(this,void 0,void 0,function(){var t,i,o,s,a,u,c,h,l,f;return tI(this,function(d){switch(d.label){case 0:t={"Content-Type":"application/json"},(i=e.getImmediate({optional:!0}))&&(t["X-Firebase-Client"]=i.getPlatformInfoString()),o={method:"POST",body:JSON.stringify(r),headers:t},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,fetch(n,o)];case 2:return s=d.sent(),[3,4];case 3:throw a=d.sent(),wS.create("fetch-network-error",{originalErrorMessage:a.message});case 4:if(200!==s.status)throw wS.create("fetch-status-error",{httpStatus:s.status});d.label=5;case 5:return d.trys.push([5,7,,8]),[4,s.json()];case 6:return u=d.sent(),[3,8];case 7:throw c=d.sent(),wS.create("fetch-parse-error",{originalErrorMessage:c.message});case 8:if(!(h=u.ttl.match(/^([\d.]+)(s)$/))||!h[2]||isNaN(Number(h[1])))throw wS.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: "+u.ttl});return l=1e3*Number(h[1]),f=Date.now(),[2,{token:u.attestationToken,expireTimeMillis:f+l,issuedAtTimeMillis:f}]}})})}function wU(t,e){var n=t.options;return{url:wO+"/projects/"+n.projectId+"/apps/"+n.appId+":exchangeDebugToken?key="+n.apiKey,body:{debug_token:e}}}var wj="firebase-app-check-store",wq="debug-token",wV=null;function wB(){return wV||(wV=new Promise(function(t,e){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(t){var n;e(wS.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(t){var e=t.target.result;0===t.oldVersion&&e.createObjectStore(wj,{keyPath:"compositeKey"})}}catch(t){e(wS.create("storage-open",{originalErrorMessage:t.message}))}}))}function wK(t,e){return tw(this,void 0,void 0,function(){var n,r;return tI(this,function(i){switch(i.label){case 0:return[4,wB()];case 1:return r=(n=i.sent().transaction(wj,"readwrite")).objectStore(wj).put({compositeKey:t,value:e}),[2,new Promise(function(t,e){r.onsuccess=function(e){t()},n.onerror=function(t){var n;e(wS.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}})]}})})}function wW(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:return[4,wB()];case 1:return n=(e=r.sent().transaction(wj,"readonly")).objectStore(wj).get(t),[2,new Promise(function(t,r){n.onsuccess=function(e){var n=e.target.result;n?t(n.value):t(void 0)},e.onerror=function(t){var e;r(wS.create("storage-get",{originalErrorMessage:null===(e=t.target.error)||void 0===e?void 0:e.message}))}})]}})})}function wH(t){return t.options.appId+"-"+t.name}var wz=new eg("@firebase/app-check");function wG(t,e){return tB()?wK(wH(t),e).catch(function(t){wz.warn("Failed to write token to indexeddb. Error: "+t)}):Promise.resolve()}var wQ={error:"UNKNOWN_ERROR"};function wY(t,e,n){return void 0===n&&(n=!1),tw(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l,f,d,p,v,g;return tI(this,function(m){var y,_;switch(m.label){case 0:if(wP(t),i=(r=wA(t)).token,o=void 0,i)return[3,2];return[4,function(t){return tw(this,void 0,void 0,function(){var e,n;return tI(this,function(r){switch(r.label){case 0:if(!tB())return[3,5];e=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,wW(wH(t))];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),wz.warn("Failed to read token from indexeddb. Error: "+n),[3,4];case 4:return[2,e];case 5:return[2,void 0]}})})}(t)];case 1:(s=m.sent())&&wZ(s)&&(i=s,wR(t,tb(tb({},r),{token:i})),wJ(t,{token:i.token})),m.label=2;case 2:if(!n&&i&&wZ(i))return[2,{token:i.token}];if(!wN.enabled)return[3,6];return u=wF,c=wU,h=[t],[4,function(){return tw(this,void 0,void 0,function(){var t;return tI(this,function(e){if((t=wN).enabled&&t.token)return[2,t.token.promise];throw Error("\n            Can't get debug token in production mode.\n        ")})})}()];case 3:return[4,u.apply(void 0,[c.apply(void 0,h.concat([m.sent()])),e])];case 4:return[4,wG(t,a=m.sent())];case 5:return m.sent(),wR(t,tb(tb({},r),{token:a})),[2,{token:a.token}];case 6:if(m.trys.push([6,12,,13]),!r.customProvider)return[3,8];return[4,r.customProvider.getToken()];case 7:return d=null!==(f=tX((l=m.sent()).token))&&f<Date.now()&&f>0?1e3*f:Date.now(),i=tb(tb({},l),{issuedAtTimeMillis:d}),[3,11];case 8:return[4,(function(t){return tw(this,void 0,void 0,function(){var e;return tI(this,function(n){switch(n.label){case 0:return wP(t),[4,wA(t).reCAPTCHAState.initialized.promise];case 1:return e=n.sent(),[2,new Promise(function(n,r){var i=wA(t).reCAPTCHAState;e.ready(function(){n(e.execute(i.widgetId,{action:"fire_app_check"}))})})]}})})})(t).catch(function(t){throw wS.create("recaptcha-error")})];case 9:return p=m.sent(),[4,wF({url:wO+"/projects/"+(y=t.options).projectId+"/apps/"+y.appId+":exchangeRecaptchaToken?key="+y.apiKey,body:{recaptcha_token:p}},e)];case 10:i=m.sent(),m.label=11;case 11:return[3,13];case 12:return v=m.sent(),wz.error(v),o=v,[3,13];case 13:if(i)return[3,14];return _=o,g={token:tx.encodeString(JSON.stringify(wQ),!1),error:_},[3,16];case 14:return g={token:i.token},wR(t,tb(tb({},r),{token:i})),[4,wG(t,i)];case 15:m.sent(),m.label=16;case 16:return wJ(t,g),[2,g]}})})}function w$(t,e,n,r,i){var o=wA(t),s=tb(tb({},o),{tokenObservers:tS(tS([],o.tokenObservers),[{next:r,error:i,type:n}])});if(!s.tokenRefresher){var a=function(t,e){var n=this;return new wM(function(){return tw(n,void 0,void 0,function(){var n;return tI(this,function(r){switch(r.label){case 0:if(wA(t).token)return[3,2];return[4,wY(t,e)];case 1:return n=r.sent(),[3,4];case 2:return[4,wY(t,e,!0)];case 3:n=r.sent(),r.label=4;case 4:if(n.error)throw n.error;return[2]}})})},function(){return!0},function(){var e=wA(t);if(!e.token)return 0;var n=e.token.issuedAtTimeMillis+(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)*.5+3e5;return Math.max(0,(n=Math.min(n,e.token.expireTimeMillis-3e5))-Date.now())},wL.RETRIAL_MIN_WAIT,wL.RETRIAL_MAX_WAIT)}(t,e);s.tokenRefresher=a}if(s.tokenRefresher.isRunning()||!0!==o.isTokenAutoRefreshEnabled||s.tokenRefresher.start(),o.token&&wZ(o.token)){var u=o.token;Promise.resolve().then(function(){return r({token:u.token})}).catch(function(){})}wR(t,s)}function wX(t,e){var n=wA(t),r=n.tokenObservers.filter(function(t){return t.next!==e});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),wR(t,tb(tb({},n),{tokenObservers:r}))}function wJ(t,e){for(var n=wA(t).tokenObservers,r=0;r<n.length;r++){var i=n[r];try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch(t){}}}function wZ(t){return t.expireTimeMillis-Date.now()>0}var w0="app-check-internal";!function(t){t.INTERNAL.registerComponent(new es("appCheck",function(t){var e=t.getProvider("app").getImmediate(),n=t.getProvider("platform-logger");return{app:e,activate:function(t,n){return function(t,e,n){var r,i,o,s,a,u,c,h=wA(t);if(h.activated)throw wS.create("already-activated",{appName:t.name});var l=tb(tb({},h),{activated:!0});"string"==typeof e?l.siteKey=e:l.customProvider=e,l.isTokenAutoRefreshEnabled=void 0===n?t.automaticDataCollectionEnabled:n,wR(t,l),l.siteKey&&(i=l.siteKey,o=wA(t),s=new tL,wR(t,tb(tb({},o),{reCAPTCHAState:{initialized:s}})),a="fire_app_check_"+t.name,(u=document.createElement("div")).id=a,u.style.display="none",document.body.appendChild(u),(c=wx())?c.ready(function(){wD(t,i,c,a),s.resolve(c)}):((r=document.createElement("script")).src="https://www.google.com/recaptcha/api.js",r.onload=function(){var e=wx();if(!e)throw Error("no recaptcha");e.ready(function(){wD(t,i,e,a),s.resolve(e)})},document.head.appendChild(r)),s.promise).catch(function(){})}(e,t,n)},setTokenAutoRefreshEnabled:function(t){var n;(n=wA(e)).tokenRefresher&&(!0===t?n.tokenRefresher.start():n.tokenRefresher.stop()),wR(e,tb(tb({},n),{isTokenAutoRefreshEnabled:t}))},getToken:function(t){return function(t,e,n){return tw(this,void 0,void 0,function(){var r;return tI(this,function(i){switch(i.label){case 0:return[4,wY(t,e,n)];case 1:if((r=i.sent()).error)throw r.error;return[2,{token:r.token}]}})})}(e,n,t)},onTokenChanged:function(t,r,i){var o,s;return o=function(){},s=function(){},o=null!=t.next?t.next.bind(t):t,null!=t.error?s=t.error.bind(t):r&&(s=r),w$(e,n,"EXTERNAL",o,s),function(){return wX(e,o)}},INTERNAL:{delete:function(){for(var t=wA(e).tokenObservers,n=0;n<t.length;n++){var r=t[n];wX(e,r.next)}return Promise.resolve()}}}},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(t,e,n){t.getProvider(w0).initialize()})),t.INTERNAL.registerComponent(new es(w0,function(t){var e=t.getProvider("app").getImmediate(),n=t.getProvider("platform-logger");return{getToken:function(t){return wY(e,n,t)},addTokenListener:function(t){return w$(e,n,"INTERNAL",t)},removeTokenListener:function(t){return wX(e,t)}}},"PUBLIC").setInstantiationMode("EXPLICIT")),t.registerVersion("@firebase/app-check","0.2.0")}(wT.default),function(){var t=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==b)return b;throw Error("Unable to locate global object.")}();if("string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===t.FIREBASE_APPCHECK_DEBUG_TOKEN){wN.enabled=!0;var e=new tL;wN.token=e,"string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN?e.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):e.resolve(function(){return tw(this,void 0,void 0,function(){var t,e;return tI(this,function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,wW(wq)];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:if(t)return[2,t];return wK(wq,e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})).catch(function(t){return wz.warn("Failed to persist debug token to indexeddb. Error: "+t)}),console.log("AppCheck debug token: "+e+". You will need to whitelist it in the Firebase console for it to work"),[2,e]}})})}())}}();"use strict";var w1="8.7.1";eR.registerVersion("firebase",w1,"app"),eR.SDK_VERSION=w1,console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),eR.registerVersion("firebase","8.7.1"),eR.initializeApp({apiKey:"zwQrtyBKPbLPhu7FJROBX60jj6975Eqh3VwGCYuT",databaseURL:"https://dwf-m6-capx-default-rtdb.firebaseio.com",authDomain:"dwf-m6-capx-default-rtdb.firebaseapp.com"});const w2=eR.database(),w4=window.location.href;var w3="";w3=w4.startsWith("http://localhost")?"http://localhost:3152":"https://api-chat-v2.onrender.com";const w6={data:{name:"",email:"",userId:"",chatroomId:"",rtdbChatroomId:"",messages:[]},listeners:[],initChat(t){let e=this.getState(),n=w2.ref("/rooms/"+e.rtdbChatroomId);n.on("value",t=>{let n=t.val();var r=[];for(let t in n.messages)r.push(n.messages[t]);e.messages=r,this.setState(e)}),t()},subscribe(t){this.listeners.push(t)},getState(){return this.data},setNameAndMail(t,e){let n=this.getState();n.name=t,n.email=e,this.setState(n)},setUserId(t){let e=this.getState();e.userId=t,this.setState(e)},setChatroomId(t){let e=this.getState();e.chatroomId=t,this.setState(e)},setRtdbId(t){let e=this.getState();e.rtdbChatroomId=t,this.setState(e)},login(t){let e=this.getState();e.email&&fetch(w3+"/auth",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({email:e.email})}).then(t=>200==t.status?t.json():(console.log("New user, registering..."),this.registerNewUser())).then(e=>{this.setUserId(e.id),t()})},registerNewUser(t){let e=this.getState();return fetch(w3+"/signup",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({nombre:e.name,email:e.email})}).then(t=>t.json())},createRoom(t){let e=this.getState();e.userId&&fetch(w3+"/rooms",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({userId:e.userId})}).then(t=>t.json()).then(e=>{this.setChatroomId(e.id),t()})},connectToRoom(t){let e=this.getState();e.userId&&e.chatroomId&&fetch(w3+"/rooms/"+e.chatroomId+"?userId="+e.userId).then(t=>t.json()).then(e=>{this.setRtdbId(e.rtdbRoomId),t()})},pushMessage(t){let e=this.getState();e.rtdbChatroomId&&fetch(w3+"/messages/"+e.rtdbChatroomId,{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({from:e.name,message:t})})},getMessages(){let t=this.getState();return t.messages},setState(t){for(let e of(this.data=t,this.listeners))e()}};class w5 extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.render()}render(){let t=document.createElement("div"),e=document.createElement("style");t.innerHTML=`
      <div class="container">
        <div class="header"></div>
        <div class="welcome-container">
          <div class="welcome-text-div">
            <h2 class="welcome-title">Bienvenido</h2>
          </div>
          <div class="welcome-input-div">
            <h5 class="welcome-name">Email</h5>
            <input type="text" class="email-input" name="name" id="email" placeholder="example@example.com">

            <h5 class="welcome-name">Nombre</h5>
            <input type="text" class="welcome-input" name="name" id="name" placeholder="Tu nombre aqui">

            <h5 class="welcome-name">Room</h5>
            <select class="welcome-input" id="select">
              <option id="option__nueva-room" value="new-room">Nueva room</option>
              <option id="option__pre-room" value="pre-room">Room existente</option>
            </select>

            <div class="room-id-div">
              <h5 class="welcome-name">Room</h5>
              <input type="text" class="room-input" name="name" id="name" placeholder="Room ID">
            </div>

            <button class="welcome-start-button">Comenzar</button>
          </div>
        </div>
      </div>
      `,e.textContent=`
      .container{
          display: flex;
          flex-direction: column;
      }
      
      .header{
          height: 7vh;
          background-color: #2D2B55;
      }   

      .welcome-container{
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        background-color: #1E1D40;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-around;
        height: 93vh;
        padding: 40px 0;
      }

      .welcome-title{
        color: #3ad900;
        font-size: 34px;
      }
      
      .welcome-name{
        color: #cc00ff;
        font-size: 20px;
      }

      .welcome-input-div{
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 93vh;
        justify-content: space-between;
      }

      .welcome-input,
      .email-input,
      .room-input{
        font-size: 20px;
        width: 30vw;
      }

      .welcome-start-button{
        margin: 20px 0px;
        border: 0px;
        height: 55px;
        width: 30vw; 
        font-size: 25px;
        font-weight: 600;
        background-color: #cc00ff;
      }
      `;let n=t.querySelector(".welcome-start-button"),r=t.querySelector(".welcome-input"),i=t.querySelector(".email-input"),o=t.querySelector(".room-input"),s=t.querySelector("select");n?.addEventListener("click",()=>{let t=r?.value,e=i.value;w6.setNameAndMail(t,e);let n=s?.options[s.selectedIndex].value;if("pre-room"==n){let e=o.value.toUpperCase();w6.login(()=>{console.log(t,"  - Logged in"),w6.setChatroomId(e),w6.connectToRoom(()=>{console.log("Connected to Room - ",e),w6.initChat(()=>{console.log("Starting Chat"),tf.go("/chat")})})})}"new-room"==n&&w6.login(()=>{console.log(t,"  - Logged in"),w6.createRoom(()=>{console.log("Room created"),w6.connectToRoom(()=>{console.log("Random room created, connecting..."),w6.initChat(()=>{console.log("Starting Chat"),tf.go("/chat")})})}),console.log(w6.getState())})}),this.shadow.appendChild(e),this.shadow.appendChild(t)}}customElements.define("home-element",w5);class w8 extends HTMLElement{constructor(){super(),this.messages=[]}connectedCallback(){w6.subscribe(()=>{let t=w6.getState();this.messages=t.messages,this.render()});let t=w6.getMessages();this.messages=t,setTimeout(()=>{this.render()},500)}addListeners(){let t=this.querySelector(".input-msj-form"),e=this.querySelector(".input-text");t?.addEventListener("submit",t=>{t.preventDefault(),w6.pushMessage(e.value)})}render(){let t=w6.getState();this.innerHTML=`
      <div class="chat-root-div">
        <div class="chat-root-div__title-div">
          <h1 class="chat-root-div__tile-h1">CHAT PAGE </h1>  
        </div>

        <div>
          <h1 class="chat-root-div__tile-h1">Id: ${t.chatroomId}</h1>            
        </div>

        <div class="chat-root-div__messages">
          <p>${this.messages.map(t=>`
                  <div class="message-div">
                    <div class="message-from-div">
                      <p class="message-from">${t.from}</p>
                    </div>
                    <div class="message-text-div">
                      <p class="message-text">${t.message}</p>
                    </div>
                  </div>
                  `).join("")}
            </p>
            </div>
            <form class="input-msj-form">
                <input type="text" class="input-text" placeholder="escribe tu mensaje aqui">
                <button class="input-btn">Enviar</button>
            </form>
      </div>
      `,this.addListeners();let e=document.createElement("style");e.textContent=`
      .chat-root-div{
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center; 
        align-items: center;
        background-color: #1E1D40;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        color: #3ad900;
      }

      .chat-root-div__messages{
        width: 60vw;
        height: 80vh;
        background-color: #2D2B55;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        align-items: flex-start;
        padding: 25px 30px;
      }

      .message-div{
        filter: opacity(100%);
        max-width: 10vw;
        max-height: 14vh;
        padding: 8px 4px;
        display: flex; 
        flex-direction: column;
        background-color: #025c4c;
        color: #ccdedb;
        border-radius: 4px;
      }

      .message-from{
        margin: 0;
        font-size: 15px;
        font-weight: 600;
      }

      .message-text{
        margin: 0;
        font-size: 10px;  
      }

      .input-msj-form{
        align-self: center;
        display: flex;
        flex-direction: column;
        height: 10vh;
        align-items: center;
        justify-content: space-evenly;
      }
      
      .input-text{
        width: 70vh;
        height: 35px;
      }
      .input-btn{
        width: 70vh;
        height: 35px;
        border-radius: 4px;
        border: 0px solid;
        font-size: 15px;
        font-weight: 600;
        background-color: #cc00ff;
      }

      .right{
        align-self: flex-end
      }
      `,this.appendChild(e)}}customElements.define("chat-element",w8);const w7=new tf(document.querySelector(".root")),w9=window.location.origin;w9.startsWith("http://localhost")?w7.setRoutes([{path:"/",component:"home-element"},{path:"/chat",component:"chat-element"}]):w7.setRoutes([{path:"/m6-chat/",component:"home-element"},{path:"/m6-chat/chat",component:"chat-element"}]);
//# sourceMappingURL=index.2e731b06.js.map
